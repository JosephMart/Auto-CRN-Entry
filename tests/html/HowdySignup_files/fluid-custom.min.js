/*! infusion - v1.5.0 Tuesday, June 24th, 2014, 12:41:48 PM*/
/*!
 * Fluid Infusion v1.5
 *
 * Infusion is distributed under the Educational Community License 2.0 and new BSD licenses:
 * http://wiki.fluidproject.org/display/fluid/Fluid+Licensing
 *
 * For information on copyright, see the individual Infusion source code files:
 * https://github.com/fluid-project/infusion/
 */
var fluid_1_5=fluid_1_5||{};var fluid=fluid||fluid_1_5;(function(d,i){i.version="Infusion 1.5";i.Error=Error;i.environment={fluid:i};var k=window||{};i.defeatLogging=true;i.activityTracing=false;i.activityTrace=[];var f=/(%\w+)/g;i.renderOneActivity=function(z,t){var y=t===true?[]:["    while "];var x=z.message;var v=f.lastIndex=0;while(true){var u=f.exec(x);if(u){var w=u[1].substring(1);y.push(x.substring(v,u.index));y.push(z.args[w]);v=f.lastIndex}else{break}}if(v<x.length){y.push(x.substring(v))}return y};i.renderActivity=function(u,t){t=t||i.renderOneActivity;return i.transform(u,t)};i.getActivityStack=function(){var t=i.globalThreadLocal();if(!t.activityStack){t.activityStack=[]}return t.activityStack};i.describeActivity=i.getActivityStack;i.logActivity=function(t){t=t||i.describeActivity();var u=i.renderActivity(t).reverse();i.log("Current activity: ");i.each(u,function(v){i.doLog(v)})};i.pushActivity=function(v,w,u){var t={type:v,message:w,args:u,time:new Date().getTime()};if(i.activityTracing){i.activityTrace.push(t)}if(i.passLogLevel(i.logLevel.TRACE)){i.doLog(i.renderOneActivity(t,true))}var x=i.getActivityStack();x.push(t)};i.popActivity=function(u){u=u||1;if(i.activityTracing){i.activityTrace.push({pop:u})}var v=i.getActivityStack();var t=v.length-u;v.length=t<0?0:t};i.FluidError=function(t){this.message=t;this.stack=new Error().stack};i.FluidError.prototype=new Error();i.builtinFail=function(t,u,w){i.log.apply(null,[i.logLevel.FAIL,"ASSERTION FAILED: "].concat(u));i.logActivity(w);var v=u.join("");if(t){throw new i.FluidError(v)}else{v["Assertion failure - check console for details"]()}};var s=[false];i.fail=function(){var u=i.makeArray(arguments);var v=i.makeArray(i.describeActivity());i.popActivity(v.length);var t=s[0];if(typeof(t)==="boolean"){i.builtinFail(t,u,v)}else{if(typeof(t)==="function"){t(u,v)}}};i.pushSoftFailure=function(t){if(typeof(t)==="boolean"||typeof(t)==="function"){s.unshift(t)}else{if(t===-1){s.shift()}}};i.notrycatch=true;i.tryCatch=function(x,t,v){v=v||i.identity;if(i.notrycatch){var u=x();v();return u}else{try{return x()}catch(w){if(t){t(w)}else{throw (w)}}finally{v()}}};i.expect=function(u,t,v){i.transform(i.makeArray(t),function(w){if(typeof v[w]==="undefined"){i.fail(u+" missing required parameter "+w)}})};i.isLogging=function(){return r[0].priority>i.logLevel.IMPORTANT.priority};i.isLogLevel=function(t){return i.isMarker(t)&&t.priority!==undefined};i.passLogLevel=function(t){return t.priority<=r[0].priority};i.setLogging=function(u){var t;if(typeof u==="boolean"){t=i.logLevel[u?"INFO":"IMPORTANT"]}else{if(i.isLogLevel(u)){t=u}else{i.fail("Unrecognised fluid logging level ",u)}}r.unshift(t)};i.setLogLevel=i.setLogging;i.popLogging=function(){return r.length===1?r[0]:r.shift()};i.doLog=function(t){var u=t.join("");if(typeof(console)!=="undefined"){if(console.debug){console.debug.apply(console,t)}else{if(typeof(console.log)==="function"){console.log.apply(console,t)}else{console.log(u)}}}else{if(typeof(YAHOO)!=="undefined"){YAHOO.log(u)}else{if(typeof(opera)!=="undefined"){opera.postError(u)}}}};i.log=function(){var w=i.makeArray(arguments);var t=i.logLevel.INFO;if(i.isLogLevel(w[0])){t=w.shift()}if(i.passLogLevel(t)){var v=i.renderTimestamp(new Date())+":  ";var u=[v].concat(w);i.doLog(u)}};i.identity=function(t){return t};i.isValue=function(t){return t!==undefined&&t!==null};i.isPrimitive=function(t){var u=typeof(t);return !t||u==="string"||u==="boolean"||u==="number"||u==="function"};i.isArrayable=function(t){return t&&(t.jquery||Object.prototype.toString.call(t)==="[object Array]")};i.isPlainObject=function(t){if(!t){return false}var u=Object.prototype.toString.call(t);return u==="[object Array]"||u==="[object Object]"};i.isDOMNode=function(t){return t&&typeof(t.nodeType)==="number"};i.isDOMish=function(t){return i.isDOMNode(t)||t.jquery};i.isComponent=function(t){return t&&t.typeName&&t.id};i.freshContainer=function(t){return i.isArrayable(t)?[]:{}};i.copy=function(t){if(i.isPrimitive(t)){return t}return d.extend(true,i.freshContainer(t),t)};i.makeArray=function(t){var v=[];if(t!==null&&t!==undefined){if(i.isPrimitive(t)||typeof(t.length)!=="number"){v.push(t)}else{for(var u=0;u<t.length;++u){v[u]=t[u]}}}return v};function b(y,x,w,v){var t=y[w];for(var u=0;u<v.length-1;++u){t=v[u+1](t,w)}x[w]=t}i.transform=function(w){var v=i.freshContainer(w);if(i.isArrayable(w)){for(var u=0;u<w.length;++u){b(w,v,u,arguments)}}else{for(var t in w){b(w,v,t,arguments)}}return v};i.each=function(w,v){if(i.isArrayable(w)){for(var u=0;u<w.length;++u){v(w[u],u)}}else{for(var t in w){v(w[t],t)}}};i.make_find=function(u){var t=u?false:undefined;return function(A,z,v){var w;if(i.isArrayable(A)){for(var y=0;y<A.length;++y){w=z(A[y],y);if(w!==t){return u?A[y]:w}}}else{for(var x in A){w=z(A[x],x);if(w!==t){return u?A[x]:w}}}return v}};i.find=i.make_find(false);i.find_if=i.make_find(true);i.accumulate=function(w,v,t){for(var u=0;u<w.length;++u){t=v(w[u],t,u)}return t};i.remove_if=function(w,v,x){if(i.isArrayable(w)){for(var u=0;u<w.length;++u){if(v(w[u],u)){if(x){x.push(w[u])}w.splice(u,1);--u}}}else{for(var t in w){if(v(w[t],t)){if(x){x[t]=w[t]}delete w[t]}}}return x||w};i.generate=function(x,w,v){var u=[];for(var t=0;t<x;++t){u[t]=v?w(t):w}return u};i.iota=function(v,w){w=w||0;var u=[];for(var t=0;t<v;++t){u[u.length]=w++}return u};i.getMembers=function(u,t){return i.transform(u,function(v){return i.get(v,t)})};i.filterKeys=function(v,u,t){return i.remove_if(d.extend({},v),function(x,w){return t^(d.inArray(w,u)===-1)})};i.censorKeys=function(t,u){return i.filterKeys(t,u,true)};i.makeFlatten=function(t){return function(v){var u=[];i.each(v,function(){u.push(arguments[t])});return u}};i.keys=i.makeFlatten(1);i.values=i.makeFlatten(0);i.contains=function(u,t){return u?(i.isArrayable(u)?d.inArray(t,u)!==-1:i.find(u,function(v){if(t===v){return true}})):undefined};i.keyForValue=function(u,t){return i.find(u,function(v,w){if(t===v){return w}})};i.findKeyInObject=i.keyForValue;i.arrayToHash=function(u){var t={};i.each(u,function(v){t[v]=true});return t};i.clear=function(u){if(i.isArrayable(u)){u.length=0}else{for(var t in u){delete u[t]}}};i.compareStringLength=function(t){return t?function(v,u){return v.length-u.length}:function(v,u){return u.length-v.length}};i.logLevelsSpec={FATAL:0,FAIL:5,WARN:10,IMPORTANT:12,INFO:15,TRACE:20};i.logLevel=i.transform(i.logLevelsSpec,function(u,t){return{type:"fluid.marker",value:t,priority:u}});var r=[i.logLevel.IMPORTANT];i.VALUE={type:"fluid.marker",value:"VALUE"};i.NO_VALUE={type:"fluid.marker",value:"NO_VALUE"};i.EXPAND={type:"fluid.marker",value:"EXPAND"};i.EXPAND_NOW={type:"fluid.marker",value:"EXPAND_NOW"};i.isMarker=function(t,u){if(!t||typeof(t)!=="object"||t.type!=="fluid.marker"){return false}if(!u){return true}return t.value===u.value};i.model={};i.model.copyModel=function(u,t){i.clear(u);d.extend(true,u,t)};i.model.parseEL=function(t){return t===""?[]:String(t).split(".")};i.model.composePath=function(t,u){return t===""?u:(u===""?t:t+"."+u)};i.model.composeSegments=function(){return i.makeArray(arguments).join(".")};i.path=i.model.composeSegments;i.composePath=i.model.composePath;i.requireDataBinding=function(){i.fail("Please include DataBinding.js in order to operate complex model accessor configuration")};i.model.setWithStrategy=i.model.getWithStrategy=i.requireDataBinding;i.model.resolvePathSegment=function(t,v,u,w){if(!w&&t.resolvePathSegment){return t.resolvePathSegment(v)}if(u&&t[v]===undefined){return t[v]={}}return t[v]};i.model.pathToSegments=function(v,u){var w=u&&u.parser?u.parser.parse:i.model.parseEL;var t=typeof(v)==="number"||typeof(v)==="string"?w(v):v;return t};i.model.accessImpl=function(A,z,u,w,y,t,B){var v=i.model.pathToSegments(z,w);var C=0;if(y){C=y.length;v=y.concat(v)}var x=u===i.NO_VALUE?0:1;A=B(A,v,C,w,x);if(u===i.NO_VALUE||u===i.VALUE){return t?{root:A,segs:v}:A}else{A[v[v.length-1]]=u}};i.model.accessSimple=function(u,w,x,t,v,y){return i.model.accessImpl(u,w,x,t,v,y,i.model.traverseSimple)};i.model.traverseSimple=function(z,t,B,v,x){var A=v;var u=t.length-x;for(var w=0;w<u;++w){if(!z){return z}var y=t[w];if(v&&v[y]){z=v[y]}else{z=i.model.resolvePathSegment(z,y,x===1,A)}v=null}return z};i.model.setSimple=function(u,w,x,t,v){i.model.accessSimple(u,w,x,t,v,false)};i.model.getSimple=function(u,w,t,v){if(w===null||w===undefined||w.length===0){return u}return i.model.accessSimple(u,w,i.NO_VALUE,t,v,false)};i.decodeAccessorArg=function(t){return(!t||t===i.model.defaultGetConfig||t===i.model.defaultSetConfig)?null:(t.type==="environment"?t.value:undefined)};i.set=function(t,x,y,u,w){var v=i.decodeAccessorArg(u);if(v===undefined){i.model.setWithStrategy(t,x,y,u,w)}else{i.model.setSimple(t,x,y,v,w)}};i.get=function(t,x,u,w){var v=i.decodeAccessorArg(u);return v===undefined?i.model.getWithStrategy(t,x,u,w):i.model.accessImpl(t,x,i.NO_VALUE,v,null,false,i.model.traverseSimple)};i.model.setBeanValue=i.set;i.model.getBeanValue=i.get;i.getGlobalValue=function(u,t){if(u){t=t||i.environment;return i.get(k,u,{type:"environment",value:t})}};i.bind=function(u,v,t){return u[v].apply(u,i.makeArray(t))};i.invokeGlobalFunction=function(u,v,t){var w=i.getGlobalValue(u,t);if(!w){i.fail("Error invoking global function: "+u+" could not be located")}else{return w.apply(null,v||[])}};i.registerGlobalFunction=function(t,v,u){u=u||i.environment;i.set(k,t,v,{type:"environment",value:u})};i.setGlobalValue=i.registerGlobalFunction;i.registerNamespace=function(v,t){t=t||i.environment;var u=i.getGlobalValue(v,t);if(!u){u={};i.setGlobalValue(v,u,t)}return u};i.dumpEl=i.identity;i.renderTimestamp=i.identity;
i.registerNamespace("fluid.event");i.generateUniquePrefix=function(){return(Math.floor(Math.random()*1000000000000)).toString(36)+"-"};var o=i.generateUniquePrefix();i.fluidInstance=o;var g=1;i.allocateGuid=function(){return o+(g++)};i.event.identifyListener=function(t){if(typeof(t)!=="string"&&!t.$$fluid_guid){t.$$fluid_guid=i.allocateGuid()}return t.$$fluid_guid};i.event.impersonateListener=function(u,t){i.event.identifyListener(u);t.$$fluid_guid=u.$$fluid_guid};i.event.mapPriority=function(t,u){return(t===null||t===undefined?u:(t==="last"?Number.MAX_VALUE:(t==="first"?-Number.MAX_VALUE:-t)))};i.priorityComparator=function(u,t){return u.priority-t.priority};i.event.sortListeners=function(t){var u=[];i.each(t,function(v){if(v.length!==undefined){u=u.concat(v)}else{u.push(v)}});return u.sort(i.priorityComparator)};i.event.invokeListener=function(u,t){if(typeof(u)==="string"){u=i.event.resolveListener({globalName:u})}return u.apply(null,t)};i.event.resolveListener=function(t){if(t.globalName){var u=i.getGlobalValue(t.globalName);if(!u){i.fail("Unable to look up name "+t.globalName+" as a global function")}else{t=u}}return t};i.nameComponent=function(t){return t?"component with typename "+t.typeName+" and id "+t.id:"[unknown component]"};i.event.nameEvent=function(u,t){return t+" of "+i.nameComponent(u)};i.makeEventFirer=function(v,y,u,t){var w;function z(F,D,I){if(!F||w.destroyed){return}i.log(i.logLevel.TRACE,"Firing event "+u+" to list of "+F.length+" listeners");for(var E=0;E<F.length;++E){var B=F[E];B.listener=i.event.resolveListener(B.listener);var H=B.listener;if(B.predicate&&!B.predicate(H,D)){continue}var G;var C=(I?I(H):H).apply(null,D);if(y&&C===false||w.destroyed){G=false}if(v){G=C}if(G!==undefined){return G}}}var x=i.event.identifyListener;var A=function(){w.listeners={};w.byId={};w.sortedListeners=[];w.addListener=function(G,E,B,D,H){if(w.destroyed){i.fail("Cannot add listener to destroyed event firer "+w.name)}if(!G){return}if(v){E="unicast"}if(typeof(G)==="string"){G={globalName:G}}var I=x(G);E=E||I;var C={listener:G,predicate:B,namespace:E,softNamespace:H,priority:i.event.mapPriority(D,w.sortedListeners.length)};w.byId[I]=C;if(H){var F=(w.listeners[E]=i.makeArray(w.listeners[E]));F.push(C)}else{w.listeners[E]=C}w.sortedListeners=i.event.sortListeners(w.listeners)};w.addListener.apply(null,arguments)};w={eventId:i.allocateGuid(),ownerId:t,name:u,typeName:"fluid.event.firer",destroy:function(){w.destroyed=true},addListener:function(){A.apply(null,arguments)},removeListener:function(D){if(!w.listeners){return}var C,G;if(typeof(D)==="string"){C=D;var B=w.listeners[D];if(!B){return}D=B.length!==undefined?B:B.listener}if(typeof(D)==="function"){G=x(D);if(!G){i.fail("Cannot remove unregistered listener function ",D," from event "+w.name)}}var F=w.byId[G];var E=F&&F.softNamespace;C=C||(F&&F.namespace)||G;delete w.byId[G];if(E){i.remove_if(w.listeners[C],function(H){return H.listener.$$fluid_guid===G})}else{delete w.listeners[C]}w.sortedListeners=i.event.sortListeners(w.listeners)},fireToListeners:function(C,B,D){return z(C,B,D)},fire:function(){return z(w.sortedListeners,arguments)}};return w};i.event.getEventFirer=i.makeEventFirer;i.fireEvent=function(u,w,t){var v=i.get(u,w);if(v){v.fire.apply(null,i.makeArray(t))}};i.event.addListenerToFirer=function(v,w,u,x){x=x||i.identity;if(i.isArrayable(w)){for(var t=0;t<w.length;++t){i.event.addListenerToFirer(v,w[t],u,x)}}else{if(typeof(w)==="function"||typeof(w)==="string"){x(v).addListener(w,u)}else{if(w&&typeof(w)==="object"){x(v).addListener(w.listener,u||w.namespace,w.predicate,w.priority,w.softNamespace)}}}};i.event.resolveListenerRecord=function(t){return{records:t}};i.expandOptions=function(t){i.fail("fluid.expandOptions could not be loaded - please include FluidIoC.js in order to operate IoC-driven event with descriptor "+t)};i.mergeListeners=function(v,t,u){i.each(u,function(A,x){var z,y;if(x.charAt(0)==="{"){z=i.expandOptions(x,v);if(!z){i.fail("Error in listener record: key "+x+' could not be looked up to an event firer - did you miss out "events." when referring to an event firer?')}}else{var B=x.indexOf(".");if(B!==-1){y=x.substring(B+1);x=x.substring(0,B)}if(!t[x]){i.fail("Listener registered for event "+x+" which is not defined for this component")}z=t[x]}var w=i.event.resolveListenerRecord(A,v,x,y,true);i.event.addListenerToFirer(z,w.records,y,w.adderWrapper)})};i.eventFromRecord=function(t,u,w){var x=t&&(typeof(t)!=="string"||t.charAt(0)==="{");var v;if(x){if(!i.event.resolveEvent){i.fail("fluid.event.resolveEvent could not be loaded - please include FluidIoC.js in order to operate IoC-driven event with descriptor ",t)}else{v=i.event.resolveEvent(w,u,t)}}else{v=i.makeEventFirer(t==="unicast",t==="preventable",i.event.nameEvent(w,u),w.id)}return v};i.instantiateFirers=function(u,t){i.each(t.events,function(v,w){u.events[w]=i.eventFromRecord(v,w,u)})};i.mergeListenerPolicy=function(w,v,u){var t=u.charAt(0)!=="{"&&u.indexOf(".")!==-1;return t?(v||w):i.arrayConcatPolicy(w,v)};i.makeMergeListenersPolicy=function(t){return function(v,u){v=v||{};i.each(u,function(x,w){v[w]=t(v[w],x,w)});return v}};i.unique=function(t){return i.remove_if(t,function(v,u){return !v||u>0&&v===t[u-1]})};i.arrayConcatPolicy=function(u,t){return i.makeArray(u).concat(i.makeArray(t))};i.typeTag=function(t){return t?{typeName:t,id:i.allocateGuid()}:null};i.staticEnvironment=i.typeTag("fluid.staticEnvironment");i.singleThreadLocal=function(u){var t=u();return function(v){return v===undefined?t:t=v}};i.threadLocal=i.singleThreadLocal;i.globalThreadLocal=i.threadLocal(function(){return i.typeTag("fluid.dynamicEnvironment")});var e=1;var j={};var h={};var a=function(t,v,w){var u=true;if(w){u=v.length===1}else{v=i.makeArray(v)}i.each(v,function(E){if(E&&!t.gradeHash[E]){var z=E.charAt(0)==="{";var B=(z?null:(u?i.rawDefaults(E):i.getGradedDefaults(E)))||{};var A=j[E]||(e-1);t.lastTick=Math.max(t.lastTick,A);t.gradeHash[E]=true;t.gradeChain.push(E);t.optionsChain.push(B);var D=i.makeArray(B.gradeNames);for(var C=0;C<D.length;++C){var y=D[C];var x=y==="autoInit";if(!u){if(!t.gradeHash[y]&&!x){t.gradeHash[y]=true;t.gradeChain.push(y)}}else{if(!x){a(t,y)}}}}});return t};i.resolveGradeStructure=function(v,t){var u={lastTick:0,gradeChain:[],gradeHash:{},optionsChain:[]};return a(u,(i.makeArray(t).reverse()||[]).concat([v]),true)};var m={};i.gradeNamesToKey=function(u,t){return u+"|"+t.join("|")};i.hasGrade=function(t,u){return !t||!t.gradeNames?false:i.contains(t.gradeNames,u)};i.resolveGrade=function(z,y,u){var x=i.resolveGradeStructure(y,u);var A=x.optionsChain.reverse();var w={};for(var v=0;v<A.length;++v){if(A[v]&&A[v].mergePolicy){w=d.extend(true,w,A[v].mergePolicy)}}A=[w,{}].concat(A);var t=i.merge.apply(null,A);t.gradeNames=x.gradeChain;if(i.hasGrade(z,"autoInit")){t.gradeNames.push("autoInit")}return{defaults:t,lastTick:x&&x.lastTick}};i.getGradedDefaults=function(z,u){u=i.makeArray(u);var x=i.gradeNamesToKey(z,u);var t=m[x];if(t){var w=0;var A=t.defaults.gradeNames||[];for(var v=0;v<A.length;++v){w=Math.max(w,j[A[v]]||0)}if(w>t.lastTick){i.log("Clearing cache for component "+z+" with gradeNames ",A);t=null}}if(!t){var y=i.rawDefaults(z);if(!y){return y}t=m[x]=i.resolveGrade(y,z,u)}return t.defaults};i.annotateListeners=function(t,u){if(u.listeners){u.listeners=i.transform(u.listeners,function(v){var w=i.makeArray(v);return i.transform(w,function(x){if(!i.isPrimitive(x)){x.componentSource=t}return x})})}};i.rawDefaults=function(u,v){if(v===undefined){return h[u]}else{i.pushActivity("registerDefaults","registering defaults for grade %componentName with options %options",{componentName:u,options:v});var t=i.expandCompact?i.expandCompact(v):i.copy(v);i.annotateListeners(u,t);h[u]=t;j[u]=e++;i.popActivity()}};i.doIndexDefaults=function(z,u,x,y){var A=i.makeArray(y.gradeNames);for(var w=0;w<A.length;++w){if(!i.hasGrade(u,A[w])){return}}var t=typeof(y.indexFunc)==="function"?y.indexFunc:i.getGlobalValue(y.indexFunc);var B=t(u)||[];for(var v=0;v<B.length;++v){(x[B[v]]=x[B[v]]||[]).push(z)}};i.indexDefaults=function(x,w){var t={};for(var v in h){var u=i.getGradedDefaults(v);i.doIndexDefaults(v,u,t,w)}return t};i.defaults=function(t,u){if(u===undefined){return i.getGradedDefaults(t)}else{if(u&&u.options){i.fail("Probable error in options structure for "+t+' with option named "options" - perhaps you meant to write these options at top level in fluid.defaults? - ',u)}i.rawDefaults(t,u);if(i.hasGrade(u,"autoInit")){i.makeComponent(t,i.getGradedDefaults(t))}}};i.makeComponent=function(u,v){if(!v.gradeNames||v.gradeNames.length===0){i.fail("Cannot autoInit component "+u+" which does not have any gradeNames defined")}else{if(!v.initFunction){var t=[];for(var w=0;w<v.gradeNames.length;++w){var A=v.gradeNames[w];var z=i.rawDefaults(A);if(!z&&A!=="autoInit"){t.push(A)}}if(t.length===0){i.fail("Cannot autoInit component "+u+" which does not have an initFunction defined")}else{i.fail("The grade hierarchy of component with typeName "+u+" is incomplete - it inherits from the following grade(s): "+t.join(", ")+" for which the grade definitions are corrupt or missing. Please check the files which might include these  grades and ensure they are readable and have been loaded by this instance of Infusion")}}}var x=function(){return i.initComponent(u,arguments)};var y=i.getGlobalValue(u);if(y){d.extend(x,y)}i.setGlobalValue(u,x)};i.makeComponents=function(t){i.each(t,function(w,v){var u={gradeNames:i.makeArray(w).concat(["autoInit"])};i.defaults(v,u)})};i.model.mergeModel=function(v,u){if(!i.isPrimitive(v)){var t=i.copy(u);d.extend(true,u,v);d.extend(true,u,t)}return u};var l={};i.derefMergePolicy=function(t){return(t?t["*"]:l)||l};i.compileMergePolicy=function(u){var w={},v={};var t={builtins:w,defaultValues:v};if(!u){return t}i.each(u,function(C,A){var x={},B=true;if(typeof(C)==="function"){x.func=C}else{if(typeof(C)==="object"){x=C}else{if(!i.isDefaultValueMergePolicy(C)){var z=C.split(/\s*,\s*/);for(var y=0;
y<z.length;++y){x[z[y]]=true}}else{i.set(v,A,"{that}.options."+C);t.hasDefaults=true;B=false}}}if(B){i.set(w,i.composePath(A,"*"),x)}});return t};i.isDefaultValueMergePolicy=function(t){return typeof(t)==="string"&&(t.indexOf(",")===-1&&!/replace|preserve|nomerge|noexpand/.test(t))};i.mergeOneImpl=function(B,x,y,t,A,z,v){var w=B;var u=i.isPrimitive(B);if(x!==undefined){if(!A.func&&x!==null&&i.isPlainObject(x)&&!i.isDOMish(x)&&x!==i.VALUE&&!A.preserve&&!A.nomerge){if(u){w=B=i.freshContainer(x)}}else{t[y]=undefined;if(A.func){w=A.func.call(null,B,x,v[z-1],v,z)}else{w=i.isValue(B)&&A.preserve?i.model.mergeModel(B,x):x}}}return w};function n(x,u,t,w){for(var v=0;v<t;++v){x=w(x,u[v],v,i.makeArray(u))}return x}function p(v,u,t,z){var y=[];for(var w=0;w<v.length;++w){var x=n(v[w],u,t,z[w]);if(x!==undefined){y.push(x)}}return y}i.fetchMergeChildren=function(z,x,v,u,y,B){var A=i.derefMergePolicy(y);for(var w=u.length-1;w>=0;--w){var t=u[w];if(t!==undefined){i.each(t,function(D,C){if(!z.hasOwnProperty(C)){v[x]=C;B.strategy(z,C,x+1,v,u,y)}});if(A.replace){break}}}return z};i.inEvaluationMarker={__CURRENTLY_IN_EVALUATION__:true};i.destroyedMarker={__COMPONENT_DESTROYED__:true};i.strategyRecursionBailout=50;i.makeMergeStrategy=function(t){var u=function(H,w,G,z,v,J){if(G>i.strategyRecursionBailout){i.fail("Overflow/circularity in options merging, current path is ",z," at depth ",G,' - please protect components from merging using the "nomerge" merge policy')}if(i.isPrimitive(H)){return undefined}if(i.isTracing){i.tracing.pathCount.push(i.path(z.slice(0,G)))}var I;if(H.hasOwnProperty(w)){I=H[w];if(!t.evaluateFully){return I}}else{H[w]=i.inEvaluationMarker}if(v===undefined){z=i.makeArray(z);v=p(t.sources,z,G-1,t.sourceStrategies);J=n(t.mergePolicy,z,G-1,i.concreteTrundler)}var A=i.concreteTrundler(J,w);var K=i.derefMergePolicy(A);var y,E,B;if(K.replace){y=1-v.length;E=0;B=-1}else{y=0;E=v.length-1;B=+1}var x=[];var L;for(var F=y;F<=E;++F){var D=B*F;var C=t.sourceStrategies[D](v[D],w,G,z);if(C!==undefined){x[D]=C;if(I===undefined){if(B===-1){L=H[w]=C;break}else{L=H[w]=i.mergeOneImpl(L,C,F,x,K,G,z,t)}}}}if(I!==undefined){L=I}if(x.length>0){if(!i.isPrimitive(L)){i.fetchMergeChildren(L,G,z,x,A,t)}}if(I===undefined&&x.length===0){delete H[w]}return L};t.strategy=u;return u};i.driveStrategy=function(t,u,w){u=i.makeArray(u);for(var v=0;v<u.length;++v){if(!t){return undefined}t=w(t,u[v],v+1,u)}return t};i.concreteTrundler=function(u,t){return !u?undefined:u[t]};i.merge=function(w){var u=Array.prototype.slice.call(arguments,1);var v=i.compileMergePolicy(w).builtins;var t=i.makeMergeOptions(v,u,{});t.initter();return t.target};i.simpleGingerBlock=function(t,v){var u={target:t,simple:true,strategy:i.concreteTrundler,initter:i.identity,recordType:v,priority:i.mergeRecordTypes[v]};return u};i.makeMergeOptions=function(w,u,v){var t={mergePolicy:w,sources:u};t=d.extend(t,v);t.target=t.target||i.freshContainer(t.sources[0]);t.sourceStrategies=t.sourceStrategies||i.generate(t.sources.length,i.concreteTrundler);t.initter=function(){t.evaluateFully=true;i.fetchMergeChildren(t.target,0,[],t.sources,t.mergePolicy,t)};i.makeMergeStrategy(t);return t};i.transformOptions=function(u,v){i.expect("Options transformation record",["transformer","config"],v);var t=i.getGlobalValue(v.transformer);return t.call(null,u,v.config)};i.findMergeBlocks=function(t,u){return i.remove_if(i.makeArray(t),function(v){return v.recordType!==u})};i.transformOptionsBlocks=function(u,v,t){i.each(t,function(x){var w=i.findMergeBlocks(u,x);i.each(w,function(y){y[y.simple?"target":"source"]=i.transformOptions(y.source,v)})})};i.deliverOptionsStrategy=i.identity;i.computeComponentAccessor=i.identity;i.computeDynamicComponents=i.identity;i.mergeRecordTypes={defaults:0,localOptions:50,defaultValueMerge:100,subcomponentRecord:200,distribution:300,user:500,demands:600};i.destroyValue=function(u,t){if(u){i.model.applyChangeRequest(u,{type:"DELETE",path:t})}};i.mergeComponentOptions=function(A,E,w,x){var y=i.rawDefaults(E);var D=i.getGradedDefaults(E,y&&y.gradeNames?null:x.gradeNames);var B={};var I=[];if(i.expandComponentOptions){I=I.concat(i.expandComponentOptions(B,D,w,A))}else{I=I.concat([i.simpleGingerBlock(D,"defaults"),i.simpleGingerBlock(w,"user")])}var v={};var G=[],u=[];var J={target:v,sourceStrategies:G};var z=function(){I.sort(i.priorityComparator);G.length=0;u.length=0;i.each(I,function(M){G.push(M.strategy);u.push(M.target)})};z();var t=i.makeMergeOptions(B,u,J);t.mergeBlocks=I;t.updateBlocks=z;t.destroyValue=function(N){for(var M=0;M<I.length;++M){i.destroyValue(I[M].target,N)}i.destroyValue(J.target,N)};var C;var L;function F(){L=i.driveStrategy(v,"mergePolicy",t.strategy);L=d.extend({},i.rootMergePolicy,L);C=i.compileMergePolicy(L);d.extend(true,B,C.builtins)}F();if(C.hasDefaults){if(i.generateExpandBlock){I.push(i.generateExpandBlock({options:C.defaultValues,recordType:"defaultValueMerge",priority:i.mergeRecordTypes.defaultValueMerge},A,{}));z()}else{i.fail("Cannot operate mergePolicy ",L," for component ",A," without including FluidIoC.js")}}A.options=v;var K=i.driveStrategy(v,"nickName",t.strategy);A.nickName=K||i.computeNickName(A.typeName);i.driveStrategy(v,"gradeNames",t.strategy);i.deliverOptionsStrategy(A,v,t);var H=i.driveStrategy(v,"transformOptions",t.strategy);if(H){i.transformOptionsBlocks(I,H,["user","subcomponentRecord"]);z()}i.computeComponentAccessor(A);if(!J.target.mergePolicy){F()}return t};i.defaults("fluid.function",{});i.lifecycleFunctions={preInitFunction:true,postInitFunction:true,finalInitFunction:true};i.rootMergePolicy=d.extend({gradeNames:i.arrayConcatPolicy,distributeOptions:i.arrayConcatPolicy,transformOptions:"replace"},i.transform(i.lifecycleFunctions,function(){return i.mergeListenerPolicy}));i.defaults("fluid.littleComponent",{gradeNames:["autoInit"],initFunction:"fluid.initLittleComponent",mergePolicy:i.rootMergePolicy,argumentMap:{options:0}});i.defaults("fluid.eventedComponent",{gradeNames:["fluid.littleComponent","autoInit"],events:{onCreate:null,onAttach:null,onClear:null,onDestroy:null,afterDestroy:null},mergePolicy:{listeners:i.makeMergeListenersPolicy(i.mergeListenerPolicy)}});i.COMPONENT_OPTIONS={type:"fluid.marker",value:"COMPONENT_OPTIONS"};i.emptySubcomponent=function(t){var v=i.typeTag("fluid.emptySubcomponent");v.options=t||{};v.options.gradeNames=[v.typeName];t=i.makeArray(t);for(var u=0;u<t.length;++u){v[t[u]]=i.identity}return v};i.computeNickName=function(u){var t=i.model.parseEL(u);return t[t.length-1]};i.typeFount=function(t){var u=i.initLittleComponent("fluid.typeFount",t);return i.typeTag(u.options.targetTypeName)};i.initLittleComponent=function(v,z,x,t){var A=i.typeTag(v);x=x||{gradeNames:"fluid.littleComponent"};A.destroy=i.makeRootDestroy(A);var u=i.mergeComponentOptions(A,v,z,x);var B=A.options;var w=i.hasGrade(B,"fluid.eventedComponent");if(w){A.events={}}(t||i.identity)(A,B,u.strategy);i.computeDynamicComponents(A,u);for(var y=0;y<u.mergeBlocks.length;++y){u.mergeBlocks[y].initter()}u.initter();delete B.mergePolicy;i.initLifecycleFunctions(A);i.fireEvent(B,"preInitFunction",A);if(w){i.instantiateFirers(A,B);i.mergeListeners(A,A.events,B.listeners)}if(!i.hasGrade(B,"autoInit")){i.clearLifecycleFunctions(B)}return A};i.updateWithDefaultLifecycle=function(v,x,u){var y=u+"."+v.substring(0,v.length-"function".length);var t=i.getGlobalValue(y);if(typeof(t)==="function"){x=i.makeArray(x);var w=i.find(x,function(z){var A=z.listener||z;if(A===t||A===y){return true}});if(!w){x.push(t)}}return x};i.initLifecycleFunctions=function(u){var t=u.options.gradeNames||[];i.each(i.lifecycleFunctions,function(x,w){var y=u.options[w];for(var v=t.length-1;v>=0;--v){if(t[v]!=="autoInit"){y=i.updateWithDefaultLifecycle(w,y,t[v])}}if(y){u.options[w]=i.makeEventFirer(null,null,w,u.id);i.event.addListenerToFirer(u.options[w],y)}})};i.clearLifecycleFunctions=function(t){i.each(i.lifecycleFunctions,function(v,u){delete t[u]});delete t.initFunction};i.diagnoseFailedView=i.identity;i.makeRootDestroy=function(t){return function(){i.fireEvent(t,"events.onClear",[t,"",null]);i.doDestroy(t);i.fireEvent(t,"events.afterDestroy",[t,"",null])}};i.isDestroyed=function(t){return t.destroy===i.destroyedMarker};i.doDestroy=function(w,t,v){i.fireEvent(w,"events.onDestroy",[w,t||"",v]);w.destroy=i.destroyedMarker;for(var u in w.events){if(u!=="afterDestroy"&&typeof(w.events[u].destroy)==="function"){w.events[u].destroy()}}};i.resolveReturnedPath=i.identity;i.initComponent=function(t,x){var v=i.defaults(t);if(!v.gradeNames){i.fail("Cannot initialise component "+t+" which has no gradeName registered")}var u=[t].concat(i.makeArray(x));var w;i.pushActivity("initComponent","constructing component of type %componentName with arguments %initArgs",{componentName:t,initArgs:x});w=i.invokeGlobalFunction(v.initFunction,u);i.diagnoseFailedView(t,w,v,u);i.fireEvent(w.options,"postInitFunction",w);if(i.initDependents){i.initDependents(w)}i.fireEvent(w.options,"finalInitFunction",w);i.clearLifecycleFunctions(w.options);i.fireEvent(w,"events.onCreate",w);i.popActivity();return i.resolveReturnedPath(w.options.returnedPath,w)?i.get(w,w.options.returnedPath):w};i.initSubcomponentImpl=function(w,v,t){var u;if(typeof(v)!=="function"){var x=typeof(v)==="string"?v:v.type;u=x==="fluid.emptySubcomponent"?i.emptySubcomponent(v.options):i.invokeGlobalFunction(x,t)}else{u=v.apply(null,t)}return u};i.initSubcomponents=function(z,w,u){var y=z.options[w];if(!y){return}var t=i.makeArray(y);var A=-1;var x=[];u=i.makeArray(u);for(var v=0;v<u.length;++v){if(u[v]===i.COMPONENT_OPTIONS){A=v}}for(v=0;v<t.length;++v){y=t[v];if(A!==-1){u[A]=y.options}x[v]=i.initSubcomponentImpl(z,y,u)}return x};i.initSubcomponent=function(v,u,t){return i.initSubcomponents(v,u,t)[0]};var q="(?:[\\w\\u00c0-\\uFFFF*_-";i.simpleCSSMatcher={regexp:new RegExp("([#.]?)("+q+"]|\\\\.)+)","g"),charToTag:{"":"tag","#":"id",".":"clazz"}};i.IoCSSMatcher={regexp:new RegExp("([&#]?)("+q+"]|\\.)+)","g"),charToTag:{"":"context","&":"context","#":"id"}};
var c=new RegExp("\\s*(>)?\\s*","g");i.parseSelector=function(D,y){var v=[];D=d.trim(D);var C=y.regexp;C.lastIndex=0;var B=0;while(true){var x=[];var A=true;while(true){var F=C.exec(D);if(!F){break}if(F.index!==B){if(A){i.fail("Error in selector string - cannot match child selector expression starting at "+D.substring(B))}else{break}}var z={};var E=F[2];var u=y.charToTag[F[1]];if(u){z[u]=E}x[x.length]=z;B=C.lastIndex;A=false}c.lastIndex=B;var t={predList:x};var w=c.exec(D);if(!w||w.index!==B){i.fail("Error in selector string - can not match child selector expression at "+D.substring(B))}if(w[1]===">"){t.child=true}v[v.length]=t;if(c.lastIndex>=D.length){break}B=c.lastIndex;C.lastIndex=c.lastIndex}return v};i.stringToRegExp=function(u,t){return new RegExp(u.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),t)};i.stringTemplate=function(x,t){var y=i.keys(t);y=y.sort(i.compareStringLength());for(var v=0;v<y.length;++v){var u=y[v];var w=i.stringToRegExp("%"+u,"g");x=x.replace(w,t[u])}return x};i.defaults("fluid.messageResolver",{gradeNames:["fluid.littleComponent","autoInit"],mergePolicy:{messageBase:"nomerge",parents:"nomerge"},resolveFunc:i.stringTemplate,parseFunc:i.identity,messageBase:{},parents:[]});i.messageResolver.preInit=function(t){t.messageBase=t.options.parseFunc(t.options.messageBase);t.lookup=function(v){var u=i.messageResolver.resolveOne(t.messageBase,v);if(u===undefined){return i.find(t.options.parents,function(w){return w?w.lookup(v):undefined})}else{return{template:u,resolveFunc:t.options.resolveFunc}}};t.resolve=function(u,v){if(!u){return"[No messagecodes provided]"}u=i.makeArray(u);var w=t.lookup(u);return w?w.resolveFunc(w.template,v):"[Message string for key "+u[0]+" not found]"}};i.messageResolver.resolveOne=function(x,t){for(var u=0;u<t.length;++u){var w=t[u];var v=x[w];if(v!==undefined){return v}}};i.messageLocator=function(u,t){var v=i.messageResolver({messageBase:u,resolveFunc:t});return function(w,x){return v.resolve(w,x)}}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(h,f){f.uaMatch=function(j){j=j.toLowerCase();var i=/(chrome)[ \/]([\w.]+)/.exec(j)||/(webkit)[ \/]([\w.]+)/.exec(j)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(j)||/(msie) ([\w.]+)/.exec(j)||j.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(j)||[];return{browser:i[1]||"",version:i[2]||"0"}};var a,d;if(!h.browser){if(!!navigator.userAgent.match(/Trident\/7\./)){d={msie:true,version:11}}else{a=f.uaMatch(navigator.userAgent);d={};if(a.browser){d[a.browser]=true;d.version=a.version}if(d.chrome){d.webkit=true}else{if(d.webkit){d.safari=true}}}h.browser=d}var b="fluid-scoped-data";f.getScopedData=function(k,i){var j=h(k).data(b);return j?j[i]:undefined};f.setScopedData=function(k,i,j){h(k).each(function(){var l=h.data(this,b)||{};l[i]=j;h.data(this,b,l)})};var c=null;h(document).bind("focusin",function(i){c=i.target});f.getLastFocusedElement=function(){return c};var e="enablement";f.enabled=function(j,i){j=h(j);if(i===undefined){return f.getScopedData(j,e)!==false}else{h("*",j).add(j).each(function(){if(f.getScopedData(this,e)!==undefined){f.setScopedData(this,e,i)}else{if(/select|textarea|input/i.test(this.nodeName)){h(this).prop("disabled",!i)}}});f.setScopedData(j,e,i)}};f.initEnablement=function(i){f.setScopedData(i,e,true)};f.resolveEventTarget=function(i){while(i.originalEvent&&i.originalEvent.target){i=i.originalEvent}return i.target};function g(j,i){j=h(j);j.trigger("fluid-"+i);j.triggerHandler(i);j[i]();return j}h.each(["focus","blur"],function(k,j){f[j]=function(i){return g(i,j)}})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(c,b){b.dom=b.dom||{};var a=function(d){if(d.node.firstChild){d.node=d.node.firstChild;d.depth+=1;return d}while(d.node){if(d.node.nextSibling){d.node=d.node.nextSibling;return d}d.node=d.node.parentNode;d.depth-=1}return d};b.dom.iterateDom=function(h,g,f){var e={node:h,depth:0};var d=h;var i;while(e.node!==null&&e.depth>=0&&e.depth<b.dom.iterateDom.DOM_BAIL_DEPTH){i=null;if(e.node.nodeType===1||f){i=g(e.node,e.depth)}if(i){if(i==="delete"){e.node.parentNode.removeChild(e.node);e.node=d}else{if(i==="stop"){return e.node}}}d=e.node;e=a(e)}};b.dom.iterateDom.DOM_BAIL_DEPTH=256;b.dom.isContainer=function(d,e){for(;e;e=e.parentNode){if(d===e){return true}}return false};b.dom.getElementText=function(f){var d=f.childNodes;var g="";for(var e=0;e<d.length;++e){var h=d[e];if(h.nodeType===3){g=g+h.nodeValue}}return g}})(jQuery,fluid_1_5);fluid_1_5=fluid_1_5||{};(function(c,b){var d=/(\\u[\dabcdef]{4}|\\x[\dabcdef]{2})/g;b.unescapeProperties=function(f){f=f.replace(d,function(j){var k=j.substring(2);var i=parseInt(k,16);return String.fromCharCode(i)});var h=0;while(true){var e=f.indexOf("\\",h);if(e===-1){break}if(e===f.length-1){return[f.substring(0,f.length-1),true]}var g=f.charAt(e+1);if(g==="n"){g="\n"}if(g==="r"){g="\r"}if(g==="t"){g="\t"}f=f.substring(0,e)+g+f.substring(e+2);h=e+1}return[f,false]};var a=/[^\\][\s:=]/;b.parseJavaProperties=function(l){var f={};l=l.replace(/\r\n/g,"\n");l=l.replace(/\r/g,"\n");var p=l.split("\n");var m,k,e,o,j;for(var g=0;g<p.length;++g){var n=c.trim(p[g]);if(!n||n.charAt(0)==="#"||n.charAt(0)==="!"){continue}if(!m){e="";var h=n.search(a);if(h===-1){k=n;o=""}else{k=c.trim(n.substring(0,h+1));o=c.trim(n.substring(h+2));if(o.charAt(0)===":"||o.charAt(0)==="="){o=c.trim(o.substring(1))}}k=b.unescapeProperties(k)[0];j=b.unescapeProperties(o)}else{j=b.unescapeProperties(n)}m=j[1];if(!j[1]){f[k]=e+j[0]}else{e+=j[0]}}return f};b.formatMessage=function(g,e){if(!e){return g}if(typeof(e)==="string"){e=[e]}for(var f=0;f<e.length;++f){g=g.replace("{"+f+"}",e[f])}return g}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};var fluid=fluid||fluid_1_5;(function(d,c){c.renderTimestamp=function(f){var g=function(i,j){if(!j){j=2}var h=(i===undefined?"":i.toString());return"00000".substring(5-j+h.length)+h};return g(f.getHours())+":"+g(f.getMinutes())+":"+g(f.getSeconds())+"."+g(f.getMilliseconds(),3)};c.isTracing=false;c.registerNamespace("fluid.tracing");c.tracing.pathCount=[];c.tracing.summarisePathCount=function(f){f=f||c.tracing.pathCount;var j={};for(var h=0;h<f.length;++h){var k=f[h];if(!j[k]){j[k]=1}else{++j[k]}}var g=[];c.each(j,function(i,l){g.push({path:l,count:i})});g.sort(function(l,i){return i.count-l.count});return g};c.tracing.condensePathCount=function(h,f){h=c.makeArray(h);var i={};c.each(h,function(j){i[j]=0});var g=[];c.each(f,function(j){var k=j.path;if(!c.find(h,function(l){if(k.indexOf(l)===0){i[l]+=j.count;return true}})){g.push(j)}});c.each(i,function(j,k){g.unshift({path:k,count:j})});return g};c.detectStackStyle=function(g){var f="other";var h={offset:0};if(g["arguments"]){f="chrome"}else{if(typeof window!=="undefined"&&window.opera&&g.stacktrace){f="opera10"}else{if(g.stack){f="firefox";h.offset=g.stack.indexOf("Trace exception")===-1?1:0}else{if(typeof window!=="undefined"&&window.opera&&!("stacktrace" in g)){f="opera"}}}}h.style=f;return h};c.obtainException=function(){try{throw new Error("Trace exception")}catch(f){return f}};var e=c.detectStackStyle(c.obtainException());c.registerNamespace("fluid.exceptionDecoders");c.decodeStack=function(){if(e.style!=="firefox"){return null}var f=c.obtainException();return c.exceptionDecoders[e.style](f)};c.exceptionDecoders.firefox=function(g){var f=g.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^\(/gm,"{anonymous}(").split("\n");return c.transform(f,function(h){var i=h.indexOf("@");return i===-1?[h]:[h.substring(i+1),h.substring(0,i)]})};c.getCallerInfo=function(g){g=(g||3)-e.offset;var f=c.decodeStack();return f?f[g][0]:null};function a(j,h){var g="";for(var f=0;f<h;++f){g+=j}return g}function b(m,l,h){var f=l+h.indentChars;if(m===null){return"null"}else{if(c.isPrimitive(m)){return JSON.stringify(m)}else{var g=[];var k;if(c.isArrayable(m)){if(m.length===0){return"[]"}for(k=0;k<m.length;++k){g[k]=b(m[k],f,h)}return"[\n"+f+g.join(",\n"+f)+"\n"+l+"]"}else{k=0;c.each(m,function(j,i){g[k++]=JSON.stringify(i)+": "+b(j,f,h)});return"{\n"+f+g.join(",\n"+f)+"\n"+l+"}"}}}}c.prettyPrintJSON=function(g,f){f=d.extend({indent:4},f);f.indentChars=a(" ",f.indent);return b(g,"",f)};c.dumpEl=function(g){var h;if(!g){return"null"}if(g.nodeType===3||g.nodeType===8){return"[data: "+g.data+"]"}if(g.nodeType===9){return"[document: location "+g.location+"]"}if(!g.nodeType&&c.isArrayable(g)){h="[";for(var f=0;f<g.length;++f){h+=c.dumpEl(g[f]);if(f<g.length-1){h+=", "}}return h+"]"}g=d(g);h=g.get(0).tagName;if(g.id){h+="#"+g.id}if(g.attr("class")){h+="."+g.attr("class")}return h}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(f,g){g.visitComponentChildren=function(s,r,w,v,p){var q=g.getInstantiator(s);for(var o in s){var t=q.composePath(v,o);var u=s[o];if(!g.isComponent(u)||(w.visited&&w.visited[u.id])){continue}if(w.visited){w.visited[u.id]=true}if(r(u,o,t,v,p)){return true}if(!w.flat){g.visitComponentChildren(u,r,w,t)}}};g.getMemberNames=function(r,p){var q=r.idToPath(p[p.length-1].id);var o=g.model.parseEL(q);o.unshift.apply(o,g.generate(p.length-o.length,""));return o};var l=function(v,r,t,o){o=o||{visited:{},flat:true,instantiator:v};var q=g.getMemberNames(v,r);for(var p=r.length-1;p>=0;--p){var s=r[p],u;if(s.typeName){o.visited[s.id]=true;u=v.idToPath[s.id];if(t(s,q[p],u,u,p)){return}}if(g.visitComponentChildren(s,t,o,u,p)){return}}};g.mountStrategy=function(q,o,p){var r=q.length;return function(w,u,v,s){if(v<=q.length){return}for(var t=0;t<q.length;++t){if(s[t]!==q[t]){return}}return p(w,u,v-q.length,s.slice(r))}};g.invokerFromRecord=function(r,p,q){g.pushActivity("makeInvoker","beginning instantiation of invoker with name %name and record %record as child of %that",{name:p,record:r,that:q});var o=g.makeInvoker(q,r,p);g.popActivity();return o};g.memberFromRecord=function(r,o,p){var q=g.expandOptions(r,p,null,null,{freeRoot:true});return q};g.recordStrategy=function(q,p,s,o,t,r){r=r||[];return{strategy:function(x,v,w){if(w!==1){return}var u=g.driveStrategy(p,[o,v],s);if(u===undefined){return}g.set(x,[v],g.inEvaluationMarker);
var y=t(u,v,q);g.set(x,[v],y);return y},initter:function(){var u=g.driveStrategy(p,o,s)||{};for(var v in u){g.getForComponent(q,r.concat([v]))}}}};g.instantiateFirers=function(p){var q=g.shadowForComponent(p);var o=g.get(q,["eventStrategyBlock","initter"])||g.identity;o()};g.makeDistributionRecord=function(x,w,o,s,u,q,v){q=q||0;v=v||"distribution";var p=g.copy(g.get(w,o));g.each(u,function(y){g.model.applyChangeRequest(p,{path:y,type:"DELETE"})});var r={options:{}};var t=g.isPrimitive(p);g.model.applyChangeRequest(r,{path:s,type:t?"ADD":"MERGE",value:p});return f.extend(r,{contextThat:x,recordType:v,priority:g.mergeRecordTypes.distribution+q})};g.filterBlocks=function(o,r,t,q,p,v){var s=[],u=0;g.each(r,function(y){var x=g.get(y.source,t);if(x){s.push(g.makeDistributionRecord(o,y.source,t,q,p,u++,y.recordType));var w=f.extend({},x);if(v){g.model.applyChangeRequest(y.source,{path:t,type:"DELETE"})}g.each(p,function(z){var A=g.get(w,z);g.set(y.source,t.concat(z),A)})}});return s};g.matchIoCSelector=function(t,r,o,z,v){var A=r.length-1;var p=t.length-1;while(true){var y=A===r.length-1||t[p].child;var x=r[A];var s=t[p];var w=true;for(var u=0;u<s.predList.length;++u){var q=s.predList[u];if(q.context&&!(o[A][q.context]||z[A]===q.context)){w=false;break}if(q.id&&x.id!==q.id){w=false;break}}if(p===0&&A>v&&y){w=false}if(w){if(p===0){return true}--A;--p}else{if(y){return false}else{--A}}if(A<v){return false}}};g.noteCollectedDistribution=function(p,q,o){g.model.setSimple(p,["collectedDistributions",q,o.id],true)};g.isCollectedDistribution=function(p,q,o){return g.model.getSimple(p,["collectedDistributions",q,o.id])};g.clearCollectedDistributions=function(o,p){g.model.applyChangeRequest(o,{path:["collectedDistributions",p],type:"DELETE"})};g.collectDistributions=function(v,p,o,s,t,r,q){var u=r[r.length-1];if(!g.isCollectedDistribution(p,u,o)&&g.matchIoCSelector(o.selector,s,t,r,q)){v.push.apply(v,o.blocks);g.noteCollectedDistribution(p,u,o)}};g.registerCollectedClearer=function(q,o,p){if(!q.collectedClearer&&o){q.collectedClearer=function(){g.clearCollectedDistributions(o,p)}}};g.receiveDistributions=function(z,p,x,w){var v=g.getInstantiator(z||w);var q=v.getThatStack(z||w);var y=g.getMemberNames(v,q);var s=[];var r=g.transform(q,function(A){return v.idToShadow[A.id]});var u=r[r.length-(z?1:2)];var o=g.getMembers(r,"contextHash");if(z){y.push(x);o.push(g.gradeNamesToHash(p));q.push(w)}else{g.registerCollectedClearer(r[r.length-1],u,y[y.length-1])}for(var t=0;t<q.length-1;++t){g.each(r[t].distributions,function(A){g.collectDistributions(s,u,A,q,o,y,t)})}return s};g.applyDistributions=function(p,r,s){var q=g.transform(r,function(t){return g.generateExpandBlock(t,p,s.mergePolicy)});var o=s.mergeOptions;o.mergeBlocks.push.apply(o.mergeBlocks,q);o.updateBlocks();return q};g.parseExpectedOptionsPath=function(p,q){var o=g.model.parseEL(p);if(o.length>1&&o[0]!=="options"){g.fail("Error in options distribution path ",p," - only "+q+' paths beginning with "options" are supported')}return o.slice(1)};g.isIoCSSSelector=function(o){return o.indexOf(" ")!==-1};g.pushDistributions=function(p,o,r){var t=g.shadowForComponent(p);var s=g.allocateGuid();var q=(t.distributions=t.distributions||[]);q.push({id:s,selector:o,blocks:r});return s};g.clearDistributions=function(o,q){var p=g.shadowForComponent(o);g.remove_if(p.distributions,function(r){return r.id===q})};g.extractSelectorHead=function(q){var p=q[0].predList;var o=p[0].context;p.length=0;return o};g.undistributableOptions=["gradeNames","distributeOptions","returnedPath","argumentMap","initFunction","mergePolicy","progressiveCheckerOptions"];g.distributeOptions=function(p,q){var o=g.makeArray(g.driveStrategy(p.options,"distributeOptions",q));g.each(o,function(A){var x=g.parseContextReference(A.target);var D,w;if(g.isIoCSSSelector(x.context)){w=g.parseSelector(x.context,g.IoCSSMatcher);var t=g.extractSelectorHead(w);if(t!=="that"){g.fail('Downwards options distribution not supported from component other than "that"')}D=p}else{D=g.resolveContext(x.context,p);if(!D){g.fail("Error in options distribution record ",A," - could not resolve context selector {"+x.context+"} to a root component")}}var z=g.model.parseEL(x.path);var C;if(A.record!==undefined){C=[(g.makeDistributionRecord(p,A.record,[],z,[],0))]}else{var v=g.shadowForComponent(p);var s=g.parseContextReference(A.source||"{that}.options");if(s.context!=="that"){g.fail("Error in options distribution record ",A," only a context of {that} is supported")}var r=g.parseExpectedOptionsPath(s.path,"source");var u=g.makeArray(A.exclusions).concat(r.length===0?g.undistributableOptions:[]);var B=g.transform(u,function(E){return g.model.parseEL(E)});C=g.filterBlocks(p,v.mergeOptions.mergeBlocks,r,z,B,A.removeSource);v.mergeOptions.updateBlocks()}if(w){g.pushDistributions(D,w,C)}else{var y=g.shadowForComponent(D);g.applyDistributions(p,C,y)}})};g.gradeNamesToHash=function(p){var o={};g.each(p,function(q){o[q]=true;o[g.computeNickName(q)]=true});return o};g.cacheShadowGrades=function(p,q){var o=g.gradeNamesToHash(p.options.gradeNames);o[p.nickName]=true;q.contextHash=o};g.deliverOptionsStrategy=function(p,q,o){var r=g.shadowForComponent(p,r);g.cacheShadowGrades(p,r);r.mergeOptions=o};g.resolveReturnedPath=function(q,o){var p=g.shadowForComponent(o);return p&&p.path!==""?null:q};g.defaults("fluid.gradeLinkageRecord",{gradeNames:["fluid.littleComponent"]});g.defaults("fluid.applyGradeLinkage",{});g.gradeLinkageIndexer=function(o){if(o.contextGrades&&o.resultGrades){return["*"]}};g.getLinkedGrades=function(p){var q=[];var o=g.indexDefaults("gradeLinkages",{gradeNames:"fluid.gradeLinkageRecord",indexFunc:g.gradeLinkageIndexer});g.each(o["*"],function(s){var t=g.defaults(s);var r=g.find(g.makeArray(t.contextGrades),function(u){if(!g.contains(p,u)){return true}});if(!r){q.push.apply(q,g.makeArray(t.resultGrades))}});return q};g.expandDynamicGrades=function(t,w,o,u){var x=[];g.each(u,function(z){var y=g.expandOptions(z,t);if(typeof(y)==="function"){y=y()}if(y){x=x.concat(y)}});var p=g.makeArray(o).concat(x);if(g.contains(p,"fluid.applyGradeLinkage")){var v=g.getLinkedGrades(p);g.remove_if(v,function(y){return g.contains(p,y)});x=x.concat(v)}var s=g.receiveDistributions(null,null,null,t);if(s.length>0){var r=g.applyDistributions(t,s,w);var q=g.transform(g.getMembers(r,["source","gradeNames"]),g.makeArray);x=x.concat.apply(x,q)}return x};g.collectDynamicGrades=function(s,v,u,r,t,q){var p=g.copy(g.getGradedDefaults(s.typeName,q));r.length=0;r.push.apply(r,p.gradeNames);g.cacheShadowGrades(s,v);v.mergeOptions.destroyValue("mergePolicy");v.mergeOptions.destroyValue("components");v.mergeOptions.destroyValue("invokers");u.source=p;v.mergeOptions.updateBlocks();var o=g.remove_if(r,function(w){return w.charAt(0)==="{"&&!g.contains(t,w)},[]);t.push.apply(t,o);o=g.expandDynamicGrades(s,v,r,o);q.push.apply(q,o);return o};g.computeDynamicGrades=function(r,v,s){delete r.options.gradeNames;var q=g.driveStrategy(r.options,"gradeNames",s);var u=g.findMergeBlocks(v.mergeOptions.mergeBlocks,"defaults")[0];var t=g.remove_if(q,function(w){return w.charAt(0)==="{"||!g.hasGrade(u.target,w)},[]);var p=g.expandDynamicGrades(r,v,q,t);if(p.length!==0){var o;do{o=g.collectDynamicGrades(r,v,u,q,t,p)}while(o.length!==0)}if(v.collectedClearer){v.collectedClearer();delete v.collectedClearer}};g.computeDynamicComponentKey=function(p,o){return p+(o===0?"":"-"+o)};g.registerDynamicRecord=function(t,u,s,o,r){var p=g.computeDynamicComponentKey(u,s);var q=g.copy(o);delete q[r];g.set(t.options,["components",p],q);return p};g.computeDynamicComponents=function(r,o){var s=g.shadowForComponent(r);var q=s.subcomponentLocal={};var p=g.driveStrategy(r.options,"dynamicComponents",o.strategy);g.each(p,function(t,x){if(!t.sources&&!t.createOnEvent){g.fail("Cannot process dynamicComponents record ",t,' without a "sources" or "createOnEvent" entry')}if(t.sources){var u=g.expandOptions(t.sources,r);g.each(u,function(A,z){var y=g.registerDynamicRecord(r,x,z,t,"sources");q[y]={source:A,sourcePath:z}})}else{if(t.createOnEvent){var v=g.event.expandOneEvent(r,t.createOnEvent);g.set(s,["dynamicComponentCount",x],0);var w=function(){var y=g.registerDynamicRecord(r,x,s.dynamicComponentCount[x]++,t,"createOnEvent");q[y]={"arguments":g.makeArray(arguments)};g.initDependent(r,y)};v.addListener(w);g.recordListener(v,w,s)}}})};g.computeComponentAccessor=function(q){var t=g.shadowForComponent(q);var o=q.options;var s=t.mergeOptions.strategy;var r=g.mountStrategy(["options"],o,s);t.invokerStrategy=g.recordStrategy(q,o,s,"invokers",g.invokerFromRecord);t.eventStrategyBlock=g.recordStrategy(q,o,s,"events",g.eventFromRecord,["events"]);var p=g.mountStrategy(["events"],q,t.eventStrategyBlock.strategy,["events"]);t.memberStrategy=g.recordStrategy(q,o,s,"members",g.memberFromRecord);t.getConfig={strategies:[g.model.funcResolverStrategy,g.makeGingerStrategy(q),r,t.invokerStrategy.strategy,t.memberStrategy.strategy,p]};g.computeDynamicGrades(q,t,s,t.mergeOptions.mergeBlocks);g.distributeOptions(q,s);return t.getConfig};g.shadowForComponent=function(o){var p=g.getInstantiator(o);return p&&o?p.idToShadow[o.id]:null};g.getForComponent=function(p,q){var r=g.shadowForComponent(p);var o=r?r.getConfig:undefined;return g.get(p,q,o)};g.makeGingerStrategy=function(o){var p=g.getInstantiator(o);return function(v,t,u,r){var q=v[t];if(q===g.inEvaluationMarker&&u===r.length){g.fail('Error in component configuration - a circular reference was found during evaluation of path segment "'+t+'": for more details, see the activity records following this message in the console, or issue fluid.setLogging(fluid.logLevel.TRACE) when running your application')}if(u>1){return q}if(q===undefined&&v.hasOwnProperty(t)){return g.NO_VALUE}if(q===undefined){var s=p.idToShadow[v.id].path;var w=g.composePath(s,t);q=p.pathToComponent[w]}if(q===undefined){if(g.getForComponent(v,["options","components",t])){g.initDependent(v,t);q=v[t]}}return q}};g.filterBuiltinGrades=function(o){return g.remove_if(g.makeArray(o),function(p){return(/^(autoInit|fluid.littleComponent|fluid.modelComponent|fluid.eventedComponent|fluid.viewComponent|fluid.typeFount)$/).test(p)
})};g.dumpGradeNames=function(o){return o.options&&o.options.gradeNames?" gradeNames: "+JSON.stringify(g.filterBuiltinGrades(o.options.gradeNames)):""};g.dumpThat=function(o){return'{ typeName: "'+o.typeName+'"'+g.dumpGradeNames(o)+" id: "+o.id+"}"};g.dumpThatStack=function(o,q){var p=g.transform(o,function(r){var s=q.idToPath(r.id);return g.dumpThat(r)+(s?(" - path: "+s):"")});return p.join("\n")};g.resolveContext=function(q,r){var s=g.getInstantiator(r);if(q==="instantiator"){return s}else{if(q==="that"){return r}}var o;var p=s.getFullStack(r);l(s,p,function(u,t){var v=g.shadowForComponent(u);if(q===t||v&&v.contextHash&&v.contextHash[q]||q===u.typeName||q===u.nickName){o=u;return true}if(g.getForComponent(u,["options","components",q,"type"])&&!u[q]){o=g.getForComponent(u,q);return true}});return o};var k=/^(arguments|options|container|source|sourcePath|change)$/;g.makeStackFetcher=function(o,p){var q=function(s){if(o&&o.destroy===g.destroyedMarker){g.fail("Cannot resolve reference ",s," from component "+g.dumpThat(o)+" which has been destroyed")}var t=s.context;if(p&&k.test(t)){var v=g.get(p[t],s.path);return t==="arguments"||t==="source"||t==="sourcePath"||t==="change"?v:{marker:t==="options"?g.EXPAND:g.EXPAND_NOW,value:v}}var r=g.resolveContext(t,o);if(!r&&s.path!==""){var u=g.renderContextReference(s);g.fail("Failed to resolve reference "+u+" - could not match context with name "+t+" from component "+g.dumpThat(o),o)}return g.getForComponent(r,s.path)};return q};g.makeStackResolverOptions=function(o,p){return f.extend(g.copy(g.rawDefaults("fluid.makeExpandOptions")),{fetcher:g.makeStackFetcher(o,p),contextThat:o})};g.clearListeners=function(o){g.each(o.listeners,function(p){p.event.removeListener(p.listener)});delete o.listeners};g.recordListener=function(p,q,r){if(p.ownerId!==r.that.id){var o=r.listeners;if(!o){o=r.listeners=[]}o.push({event:p,listener:q})}};var n={};g.instantiator=function(o){var p={id:g.allocateGuid(),free:o,nickName:"instantiator",pathToComponent:{},idToShadow:{},modelTransactions:{init:{}},composePath:g.composePath};p.idToPath=function(s){var r=p.idToShadow[s];return r?r.path:""};p.getThatStack=function(t){var w=p.idToShadow[t.id];if(w){var v=w.path;var s=g.model.parseEL(v);var u=g.transform(s,function(z,y){var x=g.model.composeSegments.apply(null,s.slice(0,y+1));return p.pathToComponent[x]});var r=p.pathToComponent[""];if(r){u.unshift(r)}return u}else{return[t]}};p.getEnvironmentalStack=function(){var r=[g.staticEnvironment];if(!o){r.push(g.globalThreadLocal())}return r};p.getFullStack=function(r){var s=r?p.getThatStack(r):[];return p.getEnvironmentalStack().concat(s)};function q(r,s,u){if(u){n[r.id]=p;var t=p.idToShadow[r.id]={};t.that=r;t.path=s}if(p.pathToComponent[s]){g.fail("Error during instantiation - path "+s+" which has just created component "+g.dumpThat(r)+" has already been used for component "+g.dumpThat(p.pathToComponent[s])+" - this is a circular instantiation or other oversight. Please clear the component using instantiator.clearComponent() before reusing the path.")}p.pathToComponent[s]=r}p.recordRoot=function(r){if(r&&r.id&&!p.pathToComponent[""]){q(r,"",true)}};p.recordKnownComponent=function(u,t,s,w){var r=p.idToShadow[u.id].path;var v=p.composePath(r,s);q(t,v,w)};p.clearComponent=function(v,s,t,z,r,y){var u=p.idToShadow[v.id].path;z=z||{flat:true,instantiator:p};t=t||v[s];y=y||u;if(y===undefined){g.fail("Cannot clear component "+s+" from component ",v," which was not created by this instantiator")}g.fireEvent(t,"events.onClear",[t,s,v]);var x=p.composePath(y,s);var w=p.idToShadow[t.id];if(w&&w.path===x){g.doDestroy(t,s,v);g.clearListeners(w);g.visitComponentChildren(t,function(D,A,C,B){p.clearComponent(t,A,null,z,true,B)},z,x);g.fireEvent(t,"events.afterDestroy",[t,s,v]);delete p.idToShadow[t.id];delete n[t.id]}delete p.pathToComponent[x];if(!r){delete v[s]}};return p};g.freeInstantiator=g.instantiator(true);g.getInstantiator=function(o){return o&&n[o.id]||g.freeInstantiator};g.expandOptions=function(q,t,s,o,u){if(!q){return q}g.pushActivity("expandOptions","expanding options %args for component %that ",{that:t,args:q});var r=g.makeStackResolverOptions(t,o);r.mergePolicy=s;r.freeRoot=u&&u.freeRoot;var p=u&&u.defer?g.makeExpandOptions(q,r):g.expand(q,r);g.popActivity();return p};g.localRecordExpected=["type","options","args","mergeOptions","createOnEvent","priority","recordType"];g.checkComponentRecord=function(q,o){var p=g.arrayToHash(g.localRecordExpected);g.each(q&&q.argumentMap,function(s,r){p[r]=true});g.each(o,function(s,r){if(!p[r]){g.fail('Probable error in subcomponent record - key "'+r+'" found, where the only legal options are '+g.keys(p).join(", "))}})};g.pushDemands=function(v,r){r=g.makeArray(r);var t=g.mergeRecordTypes.demands;function q(w){w.recordType="demands";w.priority=t++;v.push(w)}function p(w){q({options:w})}for(var s=0;s<r.length;++s){var u=r[s];if(u.options){q(u)}else{if(u.mergeOptions){var o=g.makeArray(u.mergeOptions);g.each(o,p)}else{g.fail("Uninterpretable demands record without options or mergeOptions ",u)}}}};g.mergeRecordsToList=function(o){var p=[];g.each(o,function(r,q){r.recordType=q;if(q==="distributions"){p.push.apply(p,r)}else{if(q!=="demands"){if(!r.options){return}r.priority=g.mergeRecordTypes[q];if(r.priority===undefined){g.fail("Merge record with unrecognised type "+q+": ",r)}p.push(r)}else{g.pushDemands(p,r)}}});return p};var m=function(o){g.each(["gradeNames","mergePolicy","argumentMap","components","dynamicComponents","members","invokers","events","listeners","modelListeners","distributeOptions","transformOptions"],function(p){g.set(o,[p,"*","noexpand"],true)});return o};g.generateExpandBlock=function(p,s,r,o){var q=g.expandOptions(p.options,p.contextThat||s,r,o,{defer:true});q.priority=p.priority;q.recordType=p.recordType;return q};var b=function(s,q,r,t){var v=g.copy(q);m(s);var u=g.shadowForComponent(t);u.mergePolicy=s;var p={defaults:{options:v}};if(r){if(r.marker===g.EXPAND){f.extend(p,r.mergeRecords);if(p.subcomponentRecord){g.checkComponentRecord(q,p.subcomponentRecord)}}else{p.user={options:g.expandCompact(r,true)}}}var w=g.mergeRecordsToList(p);var o=g.transform(w,function(x){return g.generateExpandBlock(x,t,s,r&&r.localRecord)});return o};g.makeIoCRootDestroy=function(p,o){return function(){p.clearComponent(o,"",o,null,true);g.doDestroy(o);g.fireEvent(o,"events.afterDestroy",[o,"",null])}};g.expandComponentOptions=function(r,s,u,q){var t=u&&u.marker===g.EXPAND&&u.memberName!==undefined?u.instantiator:null;var o;if(!t){t=g.instantiator();o=true;g.log("Created new instantiator with id "+t.id+" in order to operate on component "+(q?q.typeName:"[none]"));q.destroy=g.makeIoCRootDestroy(t,q)}g.pushActivity("expandComponentOptions","expanding component options %options with record %record for component %that",{options:u&&u.mergeRecords,record:u,that:q});if(o){t.recordRoot(q)}else{t.recordKnownComponent(u.parentThat,q,u.memberName,true)}var p=b(r,s,u,q);g.popActivity();return p};g.argMapToDemands=function(p){var o=[];g.each(p,function(r,q){o[r]="{"+q+"}"});return o};g.makePassArgsSpec=function(o){return g.transform(o,function(p,q){return"{arguments}."+q})};g.pushDemandSpec=function(p,q,o){if(q&&q!=="{options}"){p.push({options:q})}if(o){p.push({mergeOptions:o})}};g.embodyDemands=function(o,u,q,s){s=s||{};if(u.mergeOptions&&u.options){g.fail("demandspec ",u," is invalid - cannot specify literal options together with mergeOptions")}if(u.transformOptions){u.options=f.extend(true,{},u.options,{transformOptions:u.transformOptions})}var A=g.makeArray(u.args);var E=g.defaults(u.funcName);var t={};var D=E&&o?g.receiveDistributions(o,E.gradeNames,s.memberName,t):[];var F=E?E.argumentMap:null;var y=false;if(E){s.passArgs=false}if(!F&&(E||(s&&s.componentRecord))){y=true;if(A.length<2){F=g.rawDefaults("fluid.littleComponent").argumentMap}else{var J=f.inArray("{options}",A);if(J===-1){J=A.length-1}F={options:J}}}s=s||{};if(A.length===0){if(F){A=g.argMapToDemands(F)}else{if(s.passArgs){A=g.makePassArgsSpec(q)}}}var x=g.shadowForComponent(o);var C=x&&s.memberName?x.subcomponentLocal[s.memberName]:null;var I=f.extend({"arguments":q},g.censorKeys(s.componentRecord,["type"]),C);g.each(F,function(L,K){if(q.length>0){I[K]=I["arguments"][L]}if(u[K]!==undefined&&I[K]===undefined){I[K]=u[K]}if(K!=="options"){for(var M=0;M<D.length;++M){if(D[M][K]!==undefined){I[K]=D[M][K]}}}});var G;for(G=0;G<D.length;++G){if(D[G].type!==undefined){u.funcName=D[G].type}}var B={distributions:D};if(s.componentRecord!==undefined){B.subcomponentRecord=f.extend({},s.componentRecord)}var v=g.makeStackResolverOptions(o,I);var p=function(K){g.pushDemandSpec(B.demands,K.options,K.mergeOptions)};var r=[];if(A){for(G=0;G<A.length;++G){var w=A[G];if(g.isMarker(w)&&w.value===g.COMPONENT_OPTIONS.value){w="{options}";if(y){F={options:G}}}if(typeof(w)==="string"){if(w.charAt(0)==="@"){var H=w.substring(1);w="{arguments}."+H}}A[G]=w;if(!F||F.options!==G){r[G]=g.expand(w,v)}else{if(s.passArgs){g.fail("Error invoking function "+u.funcName+": found component creator rather than free function")}if(typeof(w)==="object"&&!w.targetTypeName){w.targetTypeName=u.funcName}B.demands=[];g.each((u.backSpecs).reverse(),p);g.pushDemandSpec(B.demands,u.options||w,u.mergeOptions);if(q.length>0){B.user={options:I.options}}r[G]={marker:g.EXPAND,localRecord:C,mergeRecords:B,instantiator:g.getInstantiator(o),parentThat:o,memberName:s.memberName}}if(r[G]&&g.isMarker(r[G].marker,g.EXPAND_NOW)){r[G]=g.expand(r[G].value,v)}}}else{r=q?q:[]}var z={args:r,preExpand:A,funcName:u.funcName};return z};g.fabricateDestroyMethod=function(p,o,q,r){return function(){q.clearComponent(p,o,r)}};g.initDependent=function(s,o,q){if(s[o]){return}q=q||[];var u=s.options.components[o];g.pushActivity("initDependent",'instantiating dependent component with name "%name" with record %record as child of %parent',{name:o,record:u,parent:s});var v;var r=n[s.id];if(typeof(u)==="string"){v=g.expandOptions(u,s);r.recordKnownComponent(s,v,o,false)
}else{if(u.type){var t=g.expandOptions(u.type,s);if(!t){g.fail("Error in subcomponent record: ",u.type," could not be resolved to a type for component ",o," of parent ",s)}var w=g.resolveDemands(s,[t,o],q,{componentRecord:u,memberName:o});v=g.initSubcomponentImpl(s,{type:w.funcName},w.args);var x=r.composePath(r.idToPath(s.id),o);var p=r.pathToComponent[x];if(p&&p!==v){r.clearComponent(s,o,p)}if(v&&v.typeName&&v.id&&v!==p){r.recordKnownComponent(s,v,o,true)}v.destroy=g.fabricateDestroyMethod(s,o,r,v)}else{g.fail("Unrecognised material in place of subcomponent "+o+' - no "type" field found')}}s[o]=v;g.fireEvent(v,"events.onAttach",[v,o,s]);g.popActivity();return v};g.bindDeferredComponent=function(r,o,p){var q=g.makeArray(p.createOnEvent);g.each(q,function(s){var t=s.charAt(0)==="{"?g.expandOptions(s,r):r.events[s];t.addListener(function(){g.pushActivity("initDeferred","instantiating deferred component %componentName of parent %that due to event %eventName",{componentName:o,that:r,eventName:s});if(r[o]){var u=n[r.id];u.clearComponent(r,o)}g.initDependent(r,o);g.popActivity()},null,null,p.priority)})};g.priorityForComponent=function(o){return o.priority?o.priority:(o.type==="fluid.typeFount"||g.hasGrade(g.defaults(o.type),"fluid.typeFount"))?"first":undefined};g.initDependents=function(s){g.pushActivity("initDependents","instantiating dependent components for component %that",{that:s});var t=g.shadowForComponent(s);t.memberStrategy.initter();var p=s.options;var r=p.components||{};var o={};g.each(r,function(v,u){if(!v.createOnEvent){var w=g.priorityForComponent(v);o[u]={key:u,priority:g.event.mapPriority(w,0)}}else{g.bindDeferredComponent(s,u,v)}});var q=g.event.sortListeners(o);g.each(q,function(u){g.initDependent(s,u.key)});t.invokerStrategy.initter();g.popActivity()};var i={};function c(o,t){var r=i[o]||[];outer:for(var q=0;q<r.length;++q){var s=r[q];for(var p=0;p<t.length;++p){if(s.contexts[p]!==t[p]){continue outer}}return s.spec}}var e=false;g.setDemandLogging=function(o){e=o};g.isDemandLogging=function(){return e&&g.isLogging()};g.demands=function(p,r,o){var t=g.makeArray(r).sort();if(!o){return c(p,t)}else{if(o.length){o={args:o}}}if(g.getCallerInfo&&g.isDemandLogging()){var s=g.getCallerInfo(5);if(s){o.registeredFrom=s}}o.demandId=g.allocateGuid();var q=i[p];if(!q){q=[];i[p]=q}q.push({contexts:t,spec:o})};g.compareDemands=function(p,o){return o.intersect-p.intersect};g.locateAllDemands=function(B,q){var p=g.isDemandLogging(q);if(p){g.log("Resolving demands for function names ",q," in context of "+(B?"component "+B.typeName:"no component"))}var D={};var A=[];var z=g.getInstantiator(B);var r=z.getFullStack(B);l(z,r,function(G,I,H,E,J){D[G.typeName]=J;var F=g.makeArray(g.get(G,["options","gradeNames"]));g.each(F,function(K){D[K]=J});A.push(G)});if(p){g.log("Components in scope for resolution:\n"+g.dumpThatStack(A,z))}var y=[];for(var w=0;w<q.length;++w){var t=i[q[w]]||[];for(var u=0;u<t.length;++u){var C=t[u];var o=C.spec.horizon?D[C.spec.horizon]:-1;var x={spec:C,intersect:0,uncess:0};for(var s=0;s<C.contexts.length;++s){var v=D[C.contexts[s]];x[v!==undefined&&v>=o?"intersect":"uncess"]+=2}if(C.contexts.length===0){x.intersect++}if(x.uncess===0){y.push(x)}}}y.sort(g.compareDemands);return y};g.locateDemands=function(o,q){var r=g.locateAllDemands(o,q);var p=g.getMembers(r,["spec","spec"]);if(g.isDemandLogging(q)){if(p.length){g.log("Located "+r.length+" potential match"+(r.length===1?"":"es")+", selected best match with "+r[0].intersect+" matched context names: ",p)}else{g.log("No matches found for demands, using direct implementation")}}return p};g.determineDemands=function(o,r){r=g.makeArray(r);var q=r[0];var p=g.locateDemands(o,r);if(p.length&&p[0].funcName){q=p[0].funcName}return f.extend(true,{funcName:q,args:p[0]?g.makeArray(p[0].args):[]},{backSpecs:p.slice(1)},g.censorKeys(p[0],["funcName","args"]))};g.resolveDemands=function(o,r,s,q){var p=g.determineDemands(o,r);return g.embodyDemands(o,p,s,q)};g.thisistToApplicable=function(o,p,q){return{apply:function(t,r){var u=g.expandOptions(p,q);if(typeof(u)==="string"){u=g.getGlobalValue(u)}if(!u){g.fail("Could not resolve reference "+p+" to a value")}var s=u[o.method];if(typeof(s)!=="function"){g.fail("Object ",u," at reference "+p+" has no member named "+o.method+" which is a function ")}g.log("Applying arguments ",r," to method "+o.method+" of instance ",u);return s.apply(u,r)}}};g.changeToApplicable=function(o,p){return{apply:function(s,r){var q=g.parseValidModelReference(p,"changePath listener record",o.changePath);var t=g.expandOptions(o.value,p,{},{"arguments":r});g.fireSourcedChange(q.applier,q.path,t,o.source)}}};g.recordToApplicable=function(o,q){if(o.changePath){return g.changeToApplicable(o,q)}var p=o["this"];if(o.method^p){g.fail("Record ",q,' must contain both entries "method" and "this" if it contains either')}return o.method?g.thisistToApplicable(o,p,q):null};g.invoke=function(s,p,r,o){g.pushActivity("invokeFunc",'invoking function with name "%functionName" from component %that',{functionName:s,that:r});var t=g.resolveDemands(r,s,g.makeArray(p),{passArgs:true});var q=g.invokeGlobalFunction(t.funcName,t.args,o);g.popActivity();return q};g.makeFreeInvoker=function(p,o){var q=g.determineDemands(null,p);return function(){var r=g.embodyDemands(null,q,g.makeArray(arguments),{passArgs:true});return g.invokeGlobalFunction(r.funcName,r.args,o)}};var a="{arguments}.";g.parseInteger=function(o){return isFinite(o)&&((o%1)===0)?Number(o):NaN};g.makeFastInvoker=function(v,r){var u;if(v.preExpand){u={};for(var q=0;q<v.preExpand.length;++q){var t=v.preExpand[q];if(typeof(t)==="string"){if(t.indexOf("}.model")!==-1){return{noFast:true}}if(t==="{arguments}"){u[q]="*"}else{if(t.indexOf(a)===0){var s=g.parseInteger(t.substring(a.length));if(isNaN(s)){return{noFast:true}}else{u[q]=s}}}}}}var p=v.args;var o=u?function o(w){for(var x in u){p[x]=u[x]==="*"?w:w[u[x]]}return r.apply(null,p)}:function o(w){return r.apply(null,w)};return{invoke:o}};g.makeInvoker=function(t,v,s,o){var u;if(typeof(v)==="string"){if(v.charAt(0)==="{"){v={func:v}}else{u=v}}var r=u?g.determineDemands(t,u):v;var p={noFast:v.dynamic};return function q(){if(g.defeatLogging===false){g.pushActivity("invokeInvoker","invoking invoker with name %name and record %record from component %that",{name:s,record:v,that:t})}var y;if(p.invoke){y=p.invoke(arguments)}else{var x=g.recordToApplicable(v,t);var w=g.makeArray(arguments);var z=g.embodyDemands(t,r,w,{passArgs:true});x=x||(z.funcName?g.getGlobalValue(z.funcName,o):g.expandOptions(r.func,t));if(!x||!x.apply){g.fail("Error in invoker record: could not resolve members func, funcName or method to a function implementation - got "+x+" from ",r)}if(p.noFast!==true){p=g.makeFastInvoker(z,x)}y=x.apply(null,z.args)}if(g.defeatLogging===false){g.popActivity()}return y}};g.event.makeTrackedListenerAdder=function(o){var p=g.shadowForComponent(o);return function(q){return{addListener:function(r){g.recordListener(q,r,p);q.addListener.apply(null,arguments)}}}};g.event.listenerEngine=function(p,s,q){var r={};function o(){var t=g.find(p,function(w,v){if(r[v]===undefined){return true}});if(!t){var u=r;r={};s(u)}}g.each(p,function(u,t){q(u).addListener(function(){r[t]=g.makeArray(arguments);o()})})};g.event.dispatchListener=function(s,t,q,p,o){var r=function(){g.pushActivity("dispatchListener","firing to listener to event named %eventName of component %that",{eventName:q,that:s});var w=o?arguments[0]:g.makeArray(arguments);var v=g.determineDemands(s,q);if(v.args.length===0&&p.args){v.args=p.args}var u=g.embodyDemands(s,v,w,{passArgs:true});var x=g.event.invokeListener(t,u.args);g.popActivity();return x};g.event.impersonateListener(t,r);return r};g.event.resolveSoftNamespace=function(p){if(typeof(p)!=="string"){return null}else{var o=Math.max(p.lastIndexOf("."),p.lastIndexOf("}"));return p.substring(o+1)}};g.event.resolveListenerRecord=function(s,v,u,r,t){var w=function(y,x){g.fail("Error in listener record - could not resolve reference ",y,' to a listener or firer. Did you miss out "events." when referring to an event firer?'+x)};g.pushActivity("resolveListenerRecord","resolving listener record for event named %eventName for component %that",{eventName:u,that:v});var q=g.makeArray(s);var p=g.transform(q,function(x){var y=g.isPrimitive(x)||x.expander?{listener:x}:g.copy(x);var B=g.recordToApplicable(x,v);if(B){y.listener=B}else{y.listener=y.listener||y.func||y.funcName}if(!y.listener){w(x,' Listener record must contain a member named "listener", "func", "funcName" or "method"')}var C=x.method?g.event.resolveSoftNamespace(x["this"])+"."+x.method:g.event.resolveSoftNamespace(y.listener);if(!y.namespace&&!r&&C){y.softNamespace=true;y.namespace=(x.componentSource?x.componentSource:v.typeName)+"."+C}var A=y.listener=g.expandOptions(y.listener,v);if(!A){w(x,"")}var z=false;if(A.typeName==="fluid.event.firer"){A=A.fire;z=true}y.listener=(t&&(y.args||z))?g.event.dispatchListener(v,A,u,y):A;return y});var o={records:p,adderWrapper:t?g.event.makeTrackedListenerAdder(v):null};g.popActivity();return o};g.event.expandOneEvent=function(q,p){var o;if(typeof(p)==="string"&&p.charAt(0)!=="{"){o=g.getForComponent(q,["events",p])}else{o=g.expandOptions(p,q)}if(!o||o.typeName!=="fluid.event.firer"){g.fail("Error in event specification - could not resolve base event reference ",p," to an event firer: got ",o)}return o};g.event.expandEvents=function(p,o){return typeof(o)==="string"?g.event.expandOneEvent(p,o):g.transform(o,function(q){return g.event.expandOneEvent(p,q)})};g.event.resolveEvent=function(u,t,q){g.pushActivity("resolveEvent","resolving event with name %eventName attached to component %that",{eventName:t,that:u});var p=g.event.makeTrackedListenerAdder(u);if(typeof(q)==="string"){q={event:q}}var o=q.event||q.events;if(!o){g.fail("Event specification for event with name "+t+" does not include a base event specification: ",q)}var w=g.event.expandEvents(u,o);var s=w.typeName!=="fluid.event.firer";
var v=q.args||s;var r;if(v){r=g.makeEventFirer(null,null," [composite] "+g.event.nameEvent(u,t));var x=g.event.dispatchListener(u,r.fire,t,q,s);if(s){g.event.listenerEngine(w,x,p)}else{p(w).addListener(x)}}else{r={typeName:"fluid.event.firer"};r.fire=function(){var y=g.makeArray(arguments);g.pushActivity("fireSynthetic","firing synthetic event %eventName ",{eventName:t});var z=w.fire.apply(null,y);g.popActivity();return z};r.addListener=function(C,B,y,z,D){var A=g.event.dispatchListener(u,C,t,q);p(w).addListener(A,B,y,z,D)};r.removeListener=function(y){w.removeListener(y)}}g.popActivity();return r};g.withEnvironment=function(p,q,o){o=o||g.globalThreadLocal();return g.tryCatch(function(){for(var r in p){o[r]=p[r]}f.extend(o,p);return q()},null,function(){for(var r in p){delete o[r]}})};g.fetchContextReference=function(o,r,q,t,u){if(t){o=t(o,q)}var s=o.context?q[o.context]:r;if(!s){var p=u&&u(o);return p||s}return o.noDereference?o.path:g.get(s,o.path)};g.makeEnvironmentFetcher=function(p,q,o,r){o=o||g.globalThreadLocal;return function(s){var t=o();return g.fetchContextReference(s,p,t,q,r)}};g.coerceToPrimitive=function(o){return o==="false"?false:(o==="true"?true:(isFinite(o)?Number(o):o))};g.compactStringToRec=function(s,t){var q=s.indexOf("(");var p=s.indexOf(")");if(q===-1^p===-1||q>p){g.fail("Badly-formed compact "+t+" record without matching parentheses: ",s)}if(q!==-1&&p!==-1){var v=s.substring(0,q);var o=s.substring(q+1,p);var r=g.transform(o.split(","),f.trim,g.coerceToPrimitive);var u={args:r};if(t==="invoker"&&v.charAt(q-1)==="!"){v=s.substring(0,q-1);u.dynamic=true}u[v.charAt(0)==="{"?"func":"funcName"]=v;return u}else{if(t==="expander"){g.fail("Badly-formed compact expander record without parentheses: ",s)}}return s};g.expandPrefix="@expand:";g.expandCompactString=function(o,p){var q=o;if(o.indexOf(g.expandPrefix)===0){var r=o.substring(g.expandPrefix.length);q={expander:g.compactStringToRec(r,"expander")}}else{if(p){q=g.compactStringToRec(o,p)}}return q};var d={listeners:"listener",modelListeners:"modelListener"};var j=f.extend({invokers:"invoker"},d);g.expandCompactRec=function(o,s,q,t){var p=o.length>0?o[o.length-1]:"";var r=j[p];if(!r&&o.length>1){r=d[o[o.length-2]]}g.each(q,function(v,u){if(g.isPlainObject(v)&&!g.isDOMish(v)&&!(t&&u==="model"&&o.length===0)){s[u]=g.freshContainer(v);o.push(u);g.expandCompactRec(o,s[u],v);o.pop();return}else{if(typeof(v)==="string"){v=g.expandCompactString(v,r)}}s[u]=v})};g.expandCompact=function(o,q){var p={};g.expandCompactRec([],p,o,q);return p};g.extractEL=function(p,o){if(o.ELstyle==="ALL"){return p}else{if(o.ELstyle.length===1){if(p.charAt(0)===o.ELstyle){return p.substring(1)}}else{if(o.ELstyle==="${}"){var r=p.indexOf("${");var q=p.lastIndexOf("}");if(r===0&&q!==-1){return p.substring(2,q)}}}}};g.extractELWithContext=function(p,o){var q=g.extractEL(p,o);if(q&&q.charAt(0)==="{"&&q.indexOf("}")>0){return g.parseContextReference(q)}return q?{path:q}:q};g.parseContextReference=function(o,q,p){q=q||0;var t=o.indexOf("}",q+1);if(t===-1){g.fail('Cannot parse context reference "'+o+'": Malformed context reference without }')}var r=o.substring(q+1,t);var s=p?o.indexOf(p,t+1):o.length;var u=o.substring(t+1,s);if(u.charAt(0)==="."){u=u.substring(1)}return{context:r,path:u,endpos:s}};g.renderContextReference=function(o){return"{"+o.context+"}."+o.path};g.resolveContextValue=function(q,p){function s(w){g.pushActivity("resolveContextValue","resolving context value %string",{string:q});var x=p.fetcher(w);g.pushActivity("resolvedContextValue","resolved value %string to value %value",{string:q,value:x});g.popActivity(2);return x}var o;if(p.bareContextRefs&&q.charAt(0)==="{"&&q.indexOf("}")>0){o=g.parseContextReference(q);return s(o)}else{if(p.ELstyle&&p.ELstyle!=="${}"){o=g.extractELWithContext(q,p);if(o){return s(o)}}}while(typeof(q)==="string"){var v=q.indexOf("${");var u=q.indexOf("}",v+2);if(v!==-1&&u!==-1){if(q.charAt(v+2)==="{"){o=g.parseContextReference(q,v+2,"}");u=o.endpos}else{o={path:q.substring(v+2,u)}}var r=s(o);var t=(v===0&&u===q.length-1);if(r===undefined||r===null){return r}q=t?r:q.substring(0,v)+r+q.substring(u+1)}else{break}}return q};g.expandExpander=function(q,p,o){var r=g.getGlobalValue(p.expander.type||"fluid.deferredInvokeCall");if(r){return r.call(null,q,p,o)}};g.fetchExpandChildren=function(v,r,o,t,s,u,q){if(t.expander){var p=g.expandExpander(v,t,q);if(q.freeRoot||g.isPrimitive(p)||g.isDOMish(p)||!g.isPlainObject(p)||(g.isArrayable(p)^g.isArrayable(v))){return p}else{f.extend(true,v,p)}}g.each(t,function(x,w){if(x===undefined){v[w]=undefined}else{if(w!=="expander"){o[r]=w;q.strategy(v,w,r+1,o,t,s,u)}}});return v};function h(s,p,o,r){for(var q=0;q<o;++q){s=r(s,p[q],q,g.makeArray(p))}return s}g.isUnexpandable=function(o){return g.isPrimitive(o)||g.isComponent(o)||o.nodeType!==undefined||o.jquery||!g.isPlainObject(o)};g.expandSource=function(A,v,r,q,y,o,w,t,p){var s,u,x;var z=g.derefMergePolicy(w);if(typeof(o)==="string"&&!z.noexpand){if(!A.defaultEL||o.charAt(0)==="{"){g.pushActivity("expandContextValue","expanding context value %source held at path %path",{source:o,path:g.path.apply(null,q.slice(0,r))});s=g.resolveContextValue(o,A);g.popActivity(1)}else{s=o}}else{if(z.noexpand||g.isUnexpandable(o)){s=o}else{if(o.expander){s=g.expandExpander(y,o,A)}else{if(z.preserve){s=o;x=true}else{s=g.freshContainer(o)}u=true}}}if(!x&&s!==g.NO_VALUE){y(s)}if(u){p(s,o,r,q,w,t||x)}if(x&&s!==g.NO_VALUE){y(s)}return s};g.makeExpandStrategy=function(o){var p=function(v,t,s,r,w,u){return g.fetchExpandChildren(v,s||0,r||[],t,w,u,o)};var q=function(x,s,v,t,r,y,w){if(v>g.strategyRecursionBailout){g.fail("Overflow/circularity in options expansion, current path is ",t," at depth ",v,' - please ensure options are not circularly connected, or protect from expansion using the "noexpand" policy or expander')}if(!x){return}if(!w&&x.hasOwnProperty(s)){return x[s]}if(r===undefined){r=h(o.source,t,v-1,o.sourceStrategy);y=h(o.mergePolicy,t,v-1,g.concreteTrundler)}var u=o.sourceStrategy(r,s,v,t);var A=g.concreteTrundler(y,s);function z(B){x[s]=B}return g.expandSource(o,x,v,t,z,u,A,w,p)};o.recurse=p;o.strategy=q;return q};g.defaults("fluid.makeExpandOptions",{ELstyle:"${}",bareContextRefs:true,target:g.inCreationMarker});g.makeExpandOptions=function(p,o){o=f.extend({},g.rawDefaults("fluid.makeExpandOptions"),o);o.defaultEL=o.ELStyle==="${}"&&o.bareContextRefs;o.expandSource=function(q){return g.expandSource(o,null,0,[],g.identity,q,o.mergePolicy,false)};if(!g.isUnexpandable(p)){o.source=p;o.target=g.freshContainer(p);o.sourceStrategy=o.sourceStrategy||g.concreteTrundler;g.makeExpandStrategy(o);o.initter=function(){o.target=g.fetchExpandChildren(o.target,0,[],o.source,o.mergePolicy,false,o)}}else{o.strategy=g.concreteTrundler;o.initter=g.identity;if(typeof(p)==="string"){o.target=o.expandSource(p)}else{o.target=p}}return o};g.expand=function(q,o){var p=g.makeExpandOptions(q,o);p.initter();return p.target};g.registerNamespace("fluid.expander");g.expander.deferredCall=function(s,q,p){var r=q.expander;var o=(!r.args||g.isArrayable(r.args))?r.args:g.makeArray(r.args);o=p.recurse([],o);return g.invokeGlobalFunction(r.func,o)};g.deferredCall=g.expander.deferredCall;g.deferredInvokeCall=function(u,s,q){var t=s.expander;var p=g.makeArray(t.args);p=q.recurse([],p);var o=t.func||t.funcName;var r=q.expandSource(o)||g.recordToApplicable(t,q.contextThat);if(!r){g.fail("Error in expander record - "+o+" could not be resolved to a function for component ",q.contextThat)}return r.apply?r.apply(null,p):g.invoke(r,p,q.contextThat)};g.expander.noexpand=function(p,o){return o.expander.value?o.expander.value:o.expander.tree};g.noexpand=g.expander.noexpand})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(d,c){c.model.makeEnvironmentStrategy=function(g){return function(h,j,i){return i===0&&g[j]?g[j]:undefined}};c.model.defaultCreatorStrategy=function(g,h){if(g[h]===undefined){g[h]={};return g[h]}};c.model.defaultFetchStrategy=function(g,h){return g[h]};c.model.funcResolverStrategy=function(g,h){if(g.resolvePathSegment){return g.resolvePathSegment(h)}};c.model.traverseWithStrategy=function(q,g,r,h,o){var k=h.strategies;var l=g.length-o;for(var n=r;n<l;++n){if(!q){return q}var p;for(var m=0;m<k.length;++m){p=k[m](q,g[n],n+1,g);if(p!==undefined){break}}if(p===c.NO_VALUE){p=undefined}q=p}return q};c.model.getValueAndSegments=function(g,j,h,i){return c.model.accessWithStrategy(g,j,c.NO_VALUE,h,i,true)};c.model.makeTrundler=function(g){return function(h,i){return c.model.getValueAndSegments(h.root,i,g,h.segs)}};c.model.getWithStrategy=function(g,j,h,i){return c.model.accessWithStrategy(g,j,c.NO_VALUE,h,i)};c.model.setWithStrategy=function(g,j,k,h,i){c.model.accessWithStrategy(g,j,k,h,i)};c.model.accessWithStrategy=function(o,n,h,i,l,g){if(!c.isPrimitive(n)&&!c.isArrayable(n)){var p=n.type||"default";var j=i.resolvers[p];if(!j){c.fail("Unable to find resolver of type "+p)}var m=c.model.makeTrundler(i);var k={root:o,segs:l};k=j(k,n,m);if(n.path&&k){k=m(k,n.path)}return g?k:(k?k.root:undefined)}else{return c.model.accessImpl(o,n,h,i,l,g,c.model.traverseWithStrategy)}};c.registerNamespace("fluid.pathUtil");var f=function(j,m,h){var k=null;if(j){k=""}var l=false;var g=m.length;for(;h<g;++h){var n=m.charAt(h);if(!l){if(n==="."){break}else{if(n==="\\"){l=true}else{if(k!==null){k+=n}}}}else{l=false;if(k!==null){k+=n}}}if(k!==null){j[0]=k}return h};var a=[];c.pathUtil.parseEL=function(k){var j=[];var h=0;var g=k.length;while(h<g){var i=f(a,k,h);j.push(a[0]);h=i+1}return j};c.pathUtil.composeSegment=function(j,h){h=h.toString();for(var g=0;g<h.length;++g){var k=h.charAt(g);if(k==="."||k==="\\"||k==="}"){j+="\\"}j+=k}return j};c.pathUtil.escapeSegment=function(g){return c.pathUtil.composeSegment("",g)};c.pathUtil.composePath=function(g,h){if(g.length!==0){g+="."}return c.pathUtil.composeSegment(g,h)};c.pathUtil.composeSegments=function(){var h="";for(var g=0;g<arguments.length;++g){h=c.pathUtil.composePath(h,arguments[g])
}return h};c.model.unescapedParser={parse:c.model.parseEL,compose:c.model.composeSegments};c.model.defaultGetConfig={parser:c.model.unescapedParser,strategies:[c.model.funcResolverStrategy,c.model.defaultFetchStrategy]};c.model.defaultSetConfig={parser:c.model.unescapedParser,strategies:[c.model.funcResolverStrategy,c.model.defaultFetchStrategy,c.model.defaultCreatorStrategy]};c.model.escapedParser={parse:c.pathUtil.parseEL,compose:c.pathUtil.composeSegments};c.model.escapedGetConfig={parser:c.model.escapedParser,strategies:[c.model.defaultFetchStrategy]};c.model.escapedSetConfig={parser:c.model.escapedParser,strategies:[c.model.defaultFetchStrategy,c.model.defaultCreatorStrategy]};c.initSimpleModel=function(g,h){g.model=h||{};return g.model};c.initRelayModel=function(h,g){return g};c.isModelComplete=function(g){return g.model!==c.inEvaluationMarker};c.enlistModelComponent=function(g){var i=c.getInstantiator(g);var h=i.modelTransactions.init[g.id];if(!h){h={that:g,complete:c.isModelComplete(g)};i.modelTransactions.init[g.id]=h}return h};c.clearLinkCounts=function(h,g){c.each(h,function(j,i){if(typeof(j)==="number"){h[i]=0}else{if(g&&j.options&&typeof(j.options.relayCount)==="number"){j.options.relayCount=0}}})};c.sortCompleteLast=function(h,g){return(h.completeOnInit?1:0)-(g.completeOnInit?1:0)};c.operateInitialTransaction=function(m,g){var l=c.allocateGuid();var k=c.getModelTransactionRec(m,l);var h;var i=c.transform(g,function(n){h=n.that.applier.initiate(l);k[n.that.applier.applierId]={transaction:h};return h});var j=c.values(g).sort(c.sortCompleteLast);c.each(j,function(n){var p=n.that;var o=i[p.id];if(n.completeOnInit){c.initModelEvent(p,o,p.applier.changeListeners.listeners)}else{c.each(n.initModels,function(r){o.fireChangeRequest({type:"ADD",segs:[],value:r});c.clearLinkCounts(k,true)})}var q=c.shadowForComponent(p);q.modelComplete=true});h.commit()};c.deenlistModelComponent=function(i){var j=c.getInstantiator(i);var h=j.modelTransactions.init;i.model=undefined;h[i.id].complete=true;var g=c.find_if(h,function(k){return k.complete!==true});if(!g){c.operateInitialTransaction(j,h);j.modelTransactions.init={}}};c.transformToAdapter=function(g,i){var h={};h[i]=g;return function(j,k){c.model.transformWithRules(k,h,{finalApplier:j})}};c.parseModelReference=function(i,h){var g=c.parseContextReference(h);g.segs=i.applier.parseEL(g.path);return g};c.parseValidModelReference=function(j,h,i){var k=function(m){c.fail("Error in "+h+": "+i+m)};var g,l;if(i.charAt(0)==="{"){g=c.parseModelReference(j,i);if(g.segs[0]!=="model"){k(' must be a reference into a component model beginning with "model"')}else{g.modelSegs=g.segs.slice(1);delete g.path}l=c.resolveContext(g.context,j);if(!l){k(" must be a reference to an existing component")}}else{l=j;g={path:i,modelSegs:j.applier.parseEL(i)}}if(!l.applier){c.getForComponent(l,["applier"])}if(!l.applier){k(" must be a reference to a component with a ChangeApplier (descended from fluid.modelComponent)")}g.that=l;g.applier=l.applier;if(!g.path){g.path=l.applier.composeSegments.apply(null,g.modelSegs)}return g};c.getModelTransactionRec=function(i,h){if(!h){c.fail("Cannot get transaction record without transaction id")}var g=i.modelTransactions[h];if(!g&&!i.free){g=i.modelTransactions[h]={};g.externalChanges={}}return g};c.recordChangeListener=function(i,h,g){var j=c.shadowForComponent(i);c.recordListener(h.modelChanged,g,j)};c.registerDirectChangeRelay=function(n,l,h,i,o,p,r){var m=c.getInstantiator(n);var q=r.targetApplier||n.applier;var k=r.sourceApplier||h.applier;var j=q.applierId;l=c.makeArray(l);i=i?c.makeArray(i):i;var g=function(v,t,B,x,C,A){var s=C.id;var z=c.getModelTransactionRec(m,s);if(A&&C&&!z[A.applierId]){z[A.applierId]={transaction:C}}var u=z[j];z[o]=z[o]||0;var w=true;if(w){++z[o];if(!u){var y=q.initiate(s,true);u=z[j]={transaction:y,options:r}}if(p&&!r.targetApplier){p(u.transaction,r.sourceApplier?undefined:v,i,l)}else{if(v!==undefined){u.transaction.fireChangeRequest({type:"ADD",segs:l,value:v})}}}};if(i){k.modelChanged.addListener({isRelay:true,segs:i,transactional:r.transactional},g)}if(h){c.recordChangeListener(h,k,g);if(n!==h){c.recordChangeListener(n,k,g)}}};c.connectModelRelay=function(k,g,l,i,h){var m=c.allocateGuid();function j(n){var o=c.enlistModelComponent(n);if(o.complete){var p=c.shadowForComponent(n);if(p.modelComplete){o.completeOnInit=true}}}j(l);j(k);if(h.update){if(h.targetApplier){c.registerDirectChangeRelay(k,g,l,i,m,null,{targetApplier:h.targetApplier,relayCount:h.relayCount,update:h.update})}else{c.registerDirectChangeRelay(l,i,k,[],m+"-transform",h.forwardAdapter,{transactional:true,sourceApplier:h.forwardApplier})}}else{c.registerDirectChangeRelay(l,i,k,g,m,h.forwardAdapter,{});if(g){c.registerDirectChangeRelay(k,g,l,i,m,h.backwardAdapter,{})}}};c.model.guardedAdapter=function(h,i,k,g){var l=h.modelRelay===c.inEvaluationMarker;var j=i[l?"init":"live"];if(j){k.apply(null,g)}};c.makeTransformPackage=function(j,h,m,n,i,g){var k={forwardHolder:{model:h},backwardHolder:{model:null}};k.generateAdapters=function(o){k.forwardAdapterImpl=c.transformToAdapter(o?o.newHolder.model:k.forwardHolder.model,n);if(m!==null){k.backwardHolder.model=c.model.transform.invertConfiguration(h);k.backwardAdapterImpl=c.transformToAdapter(k.backwardHolder.model,m)}};k.forwardAdapter=function(p,o){if(o===undefined){k.generateAdapters()}c.model.guardedAdapter(j,i,k.forwardAdapterImpl,arguments)};k.runTransform=function(o){o.commit();o.reset()};k.forwardApplier=c.makeNewChangeApplier(k.forwardHolder);k.forwardApplier.isRelayApplier=true;k.invalidator=c.makeEventFirer(null,null,"Invalidator for model relay with applier "+k.forwardApplier.applierId);if(m!==null){k.backwardApplier=c.makeNewChangeApplier(k.backwardHolder);k.backwardAdapter=function(){c.model.guardedAdapter(j,g,k.backwardAdapterImpl,arguments)}}k.update=k.invalidator.fire;var l={relayCount:0,targetApplier:k.forwardApplier,update:k.update,refCount:0};k.forwardHolder.model=c.parseImplicitRelay(j,h,[],l);k.refCount=l.refCount;k.generateAdapters();k.invalidator.addListener(k.generateAdapters);k.invalidator.addListener(k.runTransform);return k};c.singleTransformToFull=function(g){var h=d.extend(true,{valuePath:""},g);return{"":{transform:h}}};c.model.relayConditions={initOnly:{init:true,live:false},liveOnly:{init:false,live:true},never:{init:false,live:false},always:{init:true,live:true}};c.model.parseRelayCondition=function(g){return c.model.relayConditions[g||"always"]};c.parseModelRelay=function(n,h){var j=h.source?c.parseValidModelReference(n,'modelRelay record member "source"',h.source):{path:null,modelSegs:null};var l=c.parseValidModelReference(n,'modelRelay record member "target"',h.target);var i=h.singleTransform?c.singleTransformToFull(h.singleTransform):h.transform;if(!i){c.fail('Cannot parse modelRelay record without element "singleTransform" or "transform":',h)}var k=c.model.parseRelayCondition(h.forward),g=c.model.parseRelayCondition(h.backward);var m=c.makeTransformPackage(n,i,j.path,l.path,k,g);if(m.refCount===0){c.connectModelRelay(j.that||n,j.modelSegs,l.that,l.modelSegs,{forwardAdapter:m.forwardAdapter,backwardAdapter:m.backwardAdapter})}else{c.connectModelRelay(j.that||n,j.modelSegs,l.that,l.modelSegs,m)}};c.parseImplicitRelay=function(j,n,g,i){var k;if(typeof(n)==="string"&&n.charAt(0)==="{"){var h=c.parseModelReference(j,n);var l=c.resolveContext(h.context,j);if(h.segs[0]==="model"){var m=h.segs.slice(1);++i.refCount;c.connectModelRelay(j,g,l,m,i)}else{k=c.getForComponent(l,h.segs)}}else{if(c.isPrimitive(n)||!c.isPlainObject(n)){k=n}else{if(n.expander&&c.isPlainObject(n.expander)){k=c.expandOptions(n,j)}else{k=c.freshContainer(n);c.each(n,function(o,p){g.push(p);var q=c.parseImplicitRelay(j,o,g,i);if(q!==undefined){k[p]=q}g.pop()})}}}return k};c.model.notifyExternal=function(h){var k=h?c.values(h.externalChanges):[];k.sort(c.priorityComparator);for(var g=0;g<k.length;++g){var j=k[g];j.listener.apply(null,j.args)}c.clearLinkCounts(h,true)};c.model.commitRelays=function(h,i){var g=h.modelTransactions[i];c.each(g,function(j){if(j.transaction){j.transaction.commit("relay");j.transaction.reset()}})};c.model.updateRelays=function(i,j){var h=i.modelTransactions[j];var g=0;c.each(h,function(k){if(k.options&&k.transaction&&k.transaction.changeRecord.changes>0&&k.options.relayCount<2&&k.options.update){k.options.relayCount++;c.clearLinkCounts(h);k.options.update(k.transaction,h);++g}});return g};c.establishModelRelay=function(o,l,m,i,q){c.mergeModelListeners(o,m);var g=c.enlistModelComponent(o);c.each(i,function(r){c.parseModelRelay(o,r)});var h=c.transform(l,function(r){return c.parseImplicitRelay(o,r,[],{refCount:0})});g.initModels=h;var n=c.getInstantiator(o);function k(r){while(c.model.updateRelays(n,r.id)>0){}}function p(t,r,s){if(s!=="relay"){c.model.commitRelays(n,t.id)}}function j(t,r,s){if(s!=="relay"){c.model.notifyExternal(n.modelTransactions[t.id]);delete n.modelTransactions[t.id]}}q.preCommit.addListener(k);q.preCommit.addListener(p);q.postCommit.addListener(j);c.deenlistModelComponent(o);return q.holder.model};c.defaults("fluid.commonModelComponent",{gradeNames:["fluid.littleComponent","autoInit"],mergePolicy:{modelListeners:c.makeMergeListenersPolicy(c.arrayConcatPolicy)}});c.defaults("fluid.modelComponent",{gradeNames:["fluid.commonModelComponent","autoInit"],members:{model:"@expand:fluid.initSimpleModel({that}, {that}.options.model)",applier:"@expand:fluid.makeChangeApplier({that}.model, {that}.options.changeApplierOptions)",modelListeners:"@expand:fluid.mergeModelListeners({that}, {that}.options.modelListeners)"},mergePolicy:{model:"preserve"}});c.defaults("fluid.modelRelayComponent",{gradeNames:["fluid.commonModelComponent","fluid.eventedComponent","autoInit"],changeApplierOptions:{relayStyle:true,cullUnchanged:true},members:{model:"@expand:fluid.initRelayModel({that}, {that}.modelRelay)",applier:"@expand:fluid.makeNewChangeApplier({that}, {that}.options.changeApplierOptions)",modelRelay:"@expand:fluid.establishModelRelay({that}, {that}.options.model, {that}.options.modelListeners, {that}.options.modelRelay, {that}.applier)"},mergePolicy:{model:{noexpand:true,func:c.arrayConcatPolicy},modelRelay:{noexpand:true,func:c.arrayConcatPolicy}}});
c.defaults("fluid.standardComponent",{gradeNames:["fluid.modelComponent","fluid.eventedComponent","autoInit"]});c.defaults("fluid.standardRelayComponent",{gradeNames:["fluid.modelRelayComponent","autoInit"]});c.modelChangedToChange=function(i,g){var h=g[0],k=g[1],j=g[3];return i?{value:g[0],oldValue:g[1],path:g[2]}:{value:c.get(h,j),oldValue:c.get(k,j),path:j}};c.resolveModelListener=function(j,g,i){var h=function(){var m=c.modelChangedToChange(i,arguments);var l=[m];var k={change:m,"arguments":l};if(g.args){l=c.expandOptions(g.args,j,{},k)}c.event.invokeListener(g.listener,c.makeArray(l))};c.event.impersonateListener(g.listener,h);return h};c.mergeModelListeners=function(h,g){var i=0;c.each(g,function(m,n){if(typeof(m)==="string"){m={funcName:m}}var k=c.event.resolveListenerRecord(m,h,"modelListeners",null,false);var j=c.parseValidModelReference(h,"modelListeners entry",n);var l=j.applier.preCommit;c.each(k.records,function(p){var r=c.resolveModelListener(h,p,l);var q={listener:r,listenerIndex:i,segs:j.modelSegs,path:j.path,priority:c.event.mapPriority(p.priority,i),transactional:true};++i;c.addSourceGuardedListener(j.applier,q,p.guardSource,r,"modelChanged",p.namespace,p.softNamespace);c.recordChangeListener(h,j.applier,r);function o(){if(l&&c.isModelComplete(j.that)){var s=j.applier.initiate();c.initModelEvent(h,s,[q]);s.commit()}}if(h!==j.that&&!c.isModelComplete(h)){h.events.onCreate.addListener(o)}})})};c.addSourceGuardedListener=function(i,m,l,k,h,j,n){h=h||"modelChanged";var g=function(r,o,q,p){if(!i.hasChangeSource(l,p)){return k.apply(null,arguments)}};c.event.impersonateListener(k,g);i[h].addListener(m,g,j,n)};c.fireSourcedChange=function(g,j,i,h){g.fireChangeRequest({path:j,value:i,source:h})};c.requestChanges=function(g,j){for(var h=0;h<j.length;++h){g.fireChangeRequest(j[h])}};c.bindRequestChange=function(g){g.requestChange=g.change=function(k,j,h){var i={path:k,value:j,type:h};g.fireChangeRequest(i)}};c.identifyChangeListener=function(g){return c.event.identifyListener(g)||g};c.typeCode=function(g){return c.isPrimitive(g)||!c.isPlainObject(g)?"primitive":c.isArrayable(g)?"array":"object"};c.model.isChangedPath=function(j,g){for(var h=0;h<=g.length;++h){if(typeof(j)==="string"){return true}if(h<g.length&&j){j=j[g[h]]}}return false};c.model.setChangedPath=function(h,g,i){var j=function(k){g.unshift(k);c.model.setSimple(h,g,i);g.shift()};if(!c.model.isChangedPath(h.changeMap,g)){++h.changes;j("changeMap")}if(!c.model.isChangedPath(h.deltaMap,g)){++h.deltas;j("deltaMap")}};c.model.fetchChangeChildren=function(l,j,g,k,h){c.each(k,function(m,i){g[j]=i;c.model.applyChangeStrategy(l,i,j,g,m,h);g.length=j})};c.model.isSameValue=function(h,g){if(typeof(h)!=="number"||typeof(g)!=="number"){return h===g}else{if(h===g){return true}else{var i=Math.abs((h-g)/g);return i<1e-12}}};c.model.applyChangeStrategy=function(p,h,m,j,g,q){var l=p[h];var k=c.typeCode(g);var n=c.typeCode(l);var o=c.NO_VALUE;if(k==="primitive"){if(!c.model.isSameValue(l,g)){o=g}}else{if(n!==k||k==="array"&&g.length!==l.length){o=c.freshContainer(g)}}if(o!==c.NO_VALUE){p[h]=o;if(q.changeMap){c.model.setChangedPath(q,j,"ADD")}}if(k!=="primitive"){c.model.fetchChangeChildren(p[h],m+1,j,g,q)}};c.model.stepTargetAccess=function(o,l,g,n,m,h){for(var j=n;j<m;++j){var k=o[g[j]];o=c.model.traverseWithStrategy(o,g,j,h[l==="ADD"?"resolverSetConfig":"resolverGetConfig"],g.length-j-1);if(k!==o&&h.changeMap){c.model.setChangedPath(h,g.slice(0,j+1),"ADD")}}return{root:o,last:g[m]}};c.model.defaultAccessorConfig=function(g){g=g||{};g.resolverSetConfig=g.resolverSetConfig||c.model.defaultSetConfig;g.resolverGetConfig=g.resolverGetConfig||c.model.defaultGetConfig;return g};c.model.applyHolderChangeRequest=function(i,m,h){h=c.model.defaultAccessorConfig(h);h.deltaMap=h.changeMap?{}:null;h.deltas=0;var l=m.segs.length;var k,j=l===0;if(j){k={root:i,last:"model"}}else{if(!i.model){i.model={};c.model.setChangedPath(h,[],"ADD")}k=c.model.stepTargetAccess(i.model,m.type,m.segs,0,l-1,h)}if(m.type==="ADD"){var n=m.value;var g=c.makeArray(m.segs);c.model.applyChangeStrategy(k.root,k.last,l-1,g,n,h,j)}else{if(m.type==="DELETE"){if(k.root&&k.root[k.last]!==undefined){delete k.root[k.last];if(h.changeMap){c.model.setChangedPath(h,m.segs,"DELETE")}}}else{c.fail("Unrecognised change type of "+m.type)}}return h.deltas?h.deltaMap:null};c.matchChanges=function(k,g,q){var p=q.model;var h=k;var o=["model"];var l=false;var j=[];for(var n=0;n<g.length;++n){var m=g[n];if(m==="*"){if(n===g.length-1){l=true}else{c.fail("Wildcard specification in modelChanged listener is only supported for the final path segment: "+g.join("."))}}else{o.push(m);h=c.isPrimitive(h)?h:h[m];p=p?p[m]:undefined}}if(h){if(l){c.each(p,function(r,i){j.push(o.concat(i))})}else{j.push(o)}}return j};c.storeExternalChange=function(n,l,m,i,k){var h=l.composeSegments.apply(null,m);var j=[l.applierId,c.event.identifyListener(i.listener),i.listenerIndex,h];var g=j.join("|");n.externalChanges[g]={listener:i.listener,priority:i.priority,args:k}};c.notifyModelChanges=function(s,k,w,t,h,g,v,p){var o=c.getInstantiator(p);var n=g&&c.getModelTransactionRec(o,g.id);for(var m=0;m<s.length;++m){var x=s[m];var r=c.matchChanges(k,x.segs,w);for(var l=0;l<r.length;++l){var u=r[l];x.listener=c.event.resolveListener(x.listener);var q=[c.model.getSimple(w,u),c.model.getSimple(t,u),u.slice(1),h,g,v];if(n&&!x.isRelay&&x.transactional){c.storeExternalChange(n,v,u,x,q)}else{x.listener.apply(null,q)}}}};c.bindELMethods=function(g){g.parseEL=function(h){return c.model.pathToSegments(h,g.options.resolverSetConfig)};g.composeSegments=function(){return g.options.resolverSetConfig.parser.compose.apply(null,arguments)}};c.initModelEvent=function(i,g,h){c.notifyModelChanges(h,"ADD",g.oldHolder,c.emptyHolder,null,g,i)};c.emptyHolder={model:undefined};c.makeNewChangeApplier=function(h,g){g=c.model.defaultAccessorConfig(g);var k=c.allocateGuid();var j={applierId:k,holder:h,changeListeners:{listeners:[],transListeners:[]},options:g,modelChanged:{},preCommit:c.makeEventFirer(null,null,"preCommit event for ChangeApplier "+k),postCommit:c.makeEventFirer(null,null,"postCommit event for ChangeApplier "+k)};function i(l){if(!l.type){l.type="ADD"}l.segs=l.segs||j.parseEL(l.path)}j.modelChanged.addListener=function(l,o,m,q){if(typeof(l)==="string"){l={path:l}}else{l=c.copy(l)}l.id=c.event.identifyListener(o);l.namespace=m;l.softNamespace=q;if(typeof(o)==="string"){o={globalName:o}}l.listener=o;var n=l.transactional;l.segs=l.segs||j.parseEL(l.path);var p=n?"transListeners":"listeners";j.changeListeners[p].push(l)};j.modelChanged.removeListener=function(n){var o=c.event.identifyListener(n);var m=typeof(n)==="string"?n:null;var l=function(p){return p.id===o||p.namespace===m};c.remove_if(j.changeListeners.listeners,l);c.remove_if(j.changeListeners.transListeners,l)};j.modelChanged.isRelayEvent=true;j.fireChangeRequest=function(m){var l=j.initiate();l.fireChangeRequest(m);l.commit()};j.initiate=function(n,l){var m={instanceId:c.allocateGuid(),id:n||c.allocateGuid(),changeRecord:{resolverSetConfig:g.resolverSetConfig,resolverGetConfig:g.resolverGetConfig},reset:function(){m.oldHolder=h;m.newHolder={model:c.copy(h.model)};m.changeRecord.changes=0;m.changeRecord.changeMap={}},commit:function(p){j.preCommit.fire(m,j,p);if(m.changeRecord.changes>0){var o={model:h.model};h.model=m.newHolder.model;c.notifyModelChanges(j.changeListeners.transListeners,m.changeRecord.changeMap,h,o,null,m,j,h)}if(!l){j.postCommit.fire(m,j,p)}},fireChangeRequest:function(p){i(p);p.transactionId=m.id;var o=c.model.applyHolderChangeRequest(m.newHolder,p,m.changeRecord);c.notifyModelChanges(j.changeListeners.listeners,o,m.newHolder,h,p,m,j,h)}};m.reset();c.bindRequestChange(m);return m};j.hasChangeSource=function(m,l){return l?l[m]:false};c.bindRequestChange(j);c.bindELMethods(j);return j};c.pathUtil.getPathSegment=function(h,g){f(a,h,g);return a[0]};c.pathUtil.getHeadPath=function(g){return c.pathUtil.getPathSegment(g,0)};c.pathUtil.getFromHeadPath=function(h){var g=f(null,h,0);return g===h.length?"":h.substring(g+1)};function e(g){return g.lastIndexOf(".")}c.pathUtil.getToTailPath=function(h){var g=e(h);return g===-1?"":h.substring(0,g)};c.pathUtil.getTailPath=function(h){var g=e(h);return c.pathUtil.getPathSegment(h,g+1)};c.pathUtil.matchSegments=function(k,h,l,g){if(g-l!==k.length){return false}for(var j=l;j<g;++j){if(h[j]!==k[j-l]){return false}}return true};c.pathUtil.getExcessPath=function(i,h){var g=h.indexOf(i);if(g!==0){c.fail("Path "+i+" is not a prefix of path "+h)}if(i.length===h.length){return""}if(h[i.length]!=="."){c.fail("Path "+i+" is not properly nested in path "+h)}return h.substring(i.length+1)};c.pathUtil.matchPath=function(g,k,i){var j=[];while(true){if(((k==="")^(g===""))&&i){return null}if(!g||!k){break}var h=c.pathUtil.getHeadPath(g);var l=c.pathUtil.getHeadPath(k);if(h!=="*"&&h!==l){return null}j.push(l);g=c.pathUtil.getFromHeadPath(g);k=c.pathUtil.getFromHeadPath(k)}return j};c.model.isNullChange=function(h,j,g){if(j.type==="ADD"&&!j.forceChange){var i=c.get(h,j.segs,g);if(i===j.value){return true}}};c.model.applyChangeRequest=function(g,k,j){var i=c.model.accessWithStrategy(g,k.path,c.VALUE,j||c.model.defaultSetConfig,null,true);var h=i.segs[i.segs.length-1];if(k.type==="ADD"||k.type==="MERGE"){if(i.segs.length===0||(k.type==="MERGE"&&i.root[h])){if(k.type==="ADD"){c.clear(i.root)}d.extend(true,i.segs.length===0?i.root:i.root[h],k.value)}else{i.root[h]=k.value}}else{if(k.type==="DELETE"){if(i.segs.length===0){c.clear(i.root)}else{delete i.root[h]}}}};function b(h,g){return function(k){var j=g().sources;var i=arguments;var l=k.source||"";c.tryCatch(function(){if(j[l]===undefined){j[l]=0}++j[l];h.apply(null,i)},null,function(){--j[l]})}}c.makeChangeApplier=function(h,g){return c.makeHolderChangeApplier({model:h},g)};c.makeHolderChangeApplier=function(s,w){w=c.model.defaultAccessorConfig(w);var m={guards:c.event.getEventFirer(false,true,"guard event"),postGuards:c.event.getEventFirer(false,true,"postGuard event"),modelChanged:c.event.getEventFirer(false,false,"modelChanged event")};
var i=c.threadLocal(function(){return{sources:{}}});var p={applierId:c.allocateGuid(),holder:s,options:w};function h(y){if(!y){return null}var x=function(z){return function(A,B,D){var C=z(A,B,D);if(C===false){return false}else{if(c.model.isNullChange(A,B)){x.culled=true;return false}}}};return x}function v(C,y){var A=y;var B=false;var z=Number.MAX_VALUE;if(typeof(y)==="string"){y={path:y}}A=y.path;B=y.transactional;if(y.priority!==undefined){z=y.priority}if(A.charAt(0)==="!"){B=true;A=A.substring(1)}var x=function(I,H,E){var G=c.event.identifyListener(C);var J=H.guids[G];if(!J||!E){var F=c.pathUtil.matchPath(A,I);if(F!==null){var D={match:F,pathSpec:A,listener:C,priority:z,transactional:B};if(E){D.accumulate=[E]}H.guids[G]=D;var K=B?"transListeners":"listeners";H[K].push(D);H.all.push(D)}}else{if(E){if(!J.accumulate){J.accumulate=[]}J.accumulate.push(E)}}};c.event.impersonateListener(C,x);return x}function o(z,y,x,A,B){return m[z].fireToListeners(y[A],x,B)}function k(y,x){return y.priority-x.priority}function l(A,z,y,x){m[A].fire(z,y,x);y.all.sort(k);y.listeners.sort(k);y.transListeners.sort(k)}function r(){return{guids:{},all:[],listeners:[],transListeners:[]}}function n(z,y){var x=r();l(z,y,x);return x}function u(A,z,y,B){var x=n(A,z);return o(A,x,y,"all",B)}function j(y,x){y[x]={addListener:function(z,B,A,C){m[x].addListener(v(B,z),A,null,null,C)},removeListener:function(z){m[x].removeListener(z)}}}j(p,"guards");j(p,"postGuards");j(p,"modelChanged");function g(x){if(!x.type){x.type="ADD"}x.segs=p.parseEL(x.path)}var t={fireChangeRequest:function(x){p.fireChangeRequest(x,true)}};c.bindRequestChange(t);p.fireChangeRequest=function(y){g(y);var x=p.initiate();x.fireChangeRequest(y);x.commit()};p.fireChangeRequest=b(p.fireChangeRequest,i);c.bindRequestChange(p);c.bindELMethods(p);function q(B,H,F,D,y,E){var x=r();for(var A=0;A<F.length;++A){l(B,F[A].path,x,F[A])}for(var z=0;z<x[H].length;++z){var G=x[H][z];if(y!==undefined){D[y]=G.accumulate}if(E!==undefined){D[E]=G.match}var C=G.listener.apply(null,D);if(C===false){return false}}}p.initiate=function(y){var A=false;var z=[];if(w.thin){y=s.model}else{y=y||{};c.model.copyModel(y,s.model)}var x={commit:function(){var C;if(A){return false}var B=q("postGuards","transListeners",z,[y,null,x],1);if(B===false||A){return false}if(w.thin){C=s.model}else{C={};c.model.copyModel(C,s.model);c.clear(s.model);c.model.copyModel(s.model,y)}q("modelChanged","all",z,[s.model,C,null,null],2,3)},fireChangeRequest:function(C){g(C);if(w.cullUnchanged&&c.model.isNullChange(s.model,C,w.resolverGetConfig)){return}var D=h(w.cullUnchanged);var B=u("guards",C.path,[y,C,x],D);if(B===false&&!(D&&D.culled)){A=true}if(!A){if(!(D&&D.culled)){c.model.applyChangeRequest(y,C,w.resolverSetConfig);z.push(C)}}}};x.fireChangeRequest=b(x.fireChangeRequest,i);c.bindRequestChange(x);return x};p.hasChangeSource=function(x){return i().sources[x]>0};return p};c.makeSuperApplier=function(){var h=[];var g={};g.addSubApplier=function(i,j){h.push({path:i,subApplier:j})};g.fireChangeRequest=function(m){for(var l=0;l<h.length;++l){var n=h[l].path;if(m.path.indexOf(n)===0){var k=m.path.substring(n.length+1);var j=c.copy(m);j.path=k;h[l].subApplier.fireChangeRequest(j)}}};c.bindRequestChange(g);return g};c.attachModel=function(g,n,l){var j=c.model.parseEL(n);for(var m=0;m<j.length-1;++m){var h=j[m];var k=g[h];if(!k){g[h]=k={}}g=k}g[j[j.length-1]]=l};c.assembleModel=function(g){var h={};var j=c.makeSuperApplier();var i={model:h,applier:j};for(var k in g){var l=g[k];c.attachModel(h,k,l.model);if(l.applier){j.addSubApplier(k,l.applier)}}return i}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};var fluid=fluid||fluid_1_5;(function(b,a){a.registerNamespace("fluid.model.transform");a.defaults("fluid.transformFunction",{gradeNames:"fluid.function"});a.defaults("fluid.standardInputTransformFunction",{gradeNames:"fluid.transformFunction"});a.defaults("fluid.standardOutputTransformFunction",{gradeNames:"fluid.transformFunction"});a.defaults("fluid.multiInputTransformFunction",{gradeNames:"fluid.transformFunction"});a.defaults("fluid.standardTransformFunction",{gradeNames:["fluid.standardInputTransformFunction","fluid.standardOutputTransformFunction"]});a.defaults("fluid.lens",{gradeNames:"fluid.transformFunction",invertConfiguration:null});a.model.transform.pathToRule=function(c){return{transform:{type:"fluid.transforms.value",inputPath:c}}};a.model.transform.literalValueToRule=function(c){return{transform:{type:"fluid.transforms.literalValue",value:c}}};a.model.composePaths=function(c,d){c=c===0?"0":c||"";d=d===0?"0":d||"";return !c?d:(!d?c:c+"."+d)};a.model.transform.accumulateInputPath=function(d,c,e){if(d!==undefined){e.push(a.model.composePaths(c.inputPrefix,d))}};a.model.transform.accumulateStandardInputPath=function(c,e,d,f){a.model.transform.getValue(undefined,e[c],d);a.model.transform.accumulateInputPath(e[c+"Path"],d,f)};a.model.transform.accumulateMultiInputPaths=function(e,d,c,f){a.each(e,function(h,g){a.model.transform.accumulateStandardInputPath(g,d,c,f)})};a.model.transform.getValue=function(f,e,c){var d;if(f!==undefined){d=a.get(c.source,a.model.composePaths(c.inputPrefix,f),c.resolverGetConfig)}if(d===undefined){d=a.isPrimitive(e)?e:c.expand(e)}return d};a.model.transform.NONDEFAULT_OUTPUT_PATH_RETURN={};a.model.transform.setValue=function(e,f,d,h){var g=a.copy(f);var c=a.model.composePaths(d.outputPrefix,e);if(g!==undefined){d.applier.requestChange(c,g,h?"MERGE":undefined)}return e?a.model.transform.NONDEFAULT_OUTPUT_PATH_RETURN:g};a.model.transform.resolveParam=function(d,c,e,f){var g=a.model.transform.getValue(d[e+"Path"],d[e],c);return(g!==undefined)?g:f};a.deepEquals=function(d,e,c){if(a.isPrimitive(d)){if(d===e){++c.matchCount}else{++c.mismatchCount;c.messages.push("Value mismatch at path "+c.path+": expected "+d+" actual "+e)}}else{if(typeof(d)!==typeof(e)){++c.mismatchCount;c.messages.push("Type mismatch at path "+c.path+": expected "+typeof(d)+" actual "+typeof(e))}else{a.each(d,function(g,f){c.pathOps.push(f);a.deepEquals(d[f],e[f],c);c.pathOps.pop(f)})}}};a.model.transform.matchValue=function(d,e){if(a.isPrimitive(d)){return d===e?1:0}else{var c={matchCount:0,mismatchCount:0,messages:[]};a.model.makePathStack(c,"path");a.deepEquals(d,e,c);return c.matchCount}};a.model.transform.compareMatches=function(d,c){return c.matchCount-d.matchCount};a.firstDefined=function(d,c){return d===undefined?c:d};a.model.transform.prefixApplier=function(d,c){if(d.inputPrefix){c.inputPrefixOp.push(d.inputPrefix)}if(d.outputPrefix){c.outputPrefixOp.push(d.outputPrefix)}c.expand(d.value);if(d.inputPrefix){c.inputPrefixOp.pop()}if(d.outputPrefix){c.outputPrefixOp.pop()}};a.defaults("fluid.model.transform.prefixApplier",{gradeNames:["fluid.transformFunction"]});a.model.makePathStack=function(e,d){var c=e[d+"Stack"]=[];e[d]="";return{push:function(g){var f=a.model.composePaths(e[d],g);c.push(e[d]);e[d]=f},pop:function(){e[d]=c.pop()}}};a.model.transform.aliasStandardInput=function(c){return{value:c.value===undefined?c.input:c.value,valuePath:c.valuePath===undefined?c.inputPath:c.valuePath}};a.model.transform.doTransform=function(j,c,m){var i=m.defaults;var l=a.getGlobalValue(m.typeName);if(typeof(l)!=="function"){a.fail("Transformation record specifies transformation function with name "+j.type+" which is not a function - ",l)}if(!a.hasGrade(i,"fluid.transformFunction")){i=a.defaults("fluid.standardTransformFunction")}var e=[j,c];if(a.hasGrade(i,"fluid.standardInputTransformFunction")){var g=a.model.transform.aliasStandardInput(j);var k=a.model.transform.getValue(g.valuePath,g.value,c);e.unshift(k);if(k===undefined){return undefined}}else{if(a.hasGrade(i,"fluid.multiInputTransformFunction")){var h={};a.each(i.inputVariables,function(o,n){h[n]=function(){var p=a.model.transform.getValue(j[n+"Path"],j[n],c);p=(p===undefined&&o!==null)?o:p;return p}});e.unshift(h)}}var d=l.apply(null,e);if(a.hasGrade(i,"fluid.standardOutputTransformFunction")){var f=j.outputPath!==undefined?j.outputPath:(m.doOutput?"":undefined);if(f!==undefined&&d!==undefined){a.model.transform.setValue(j.outputPath,d,c,j.merge);d=undefined}}return d};a.model.transform.expandWildcards=function(c,d){a.each(d,function(l,h){var k=c.queuedTransforms;c.pathOp.push(a.pathUtil.escapeSegment(h.toString()));for(var g=0;g<k.length;++g){if(a.pathUtil.matchPath(k[g].matchPath,c.path,true)){var f=a.copy(k[g].transformSpec);if(f.inputPath===undefined||a.model.transform.hasWildcard(f.inputPath)){f.inputPath=""}c.inputPrefixOp.push(c.path);c.outputPrefixOp.push(c.path);var j=a.model.transform.lookupType(f.type);var e=a.model.transform.doTransform(f,c,j);if(e!==undefined){a.model.transform.setValue(null,e,c)}c.outputPrefixOp.pop();c.inputPrefixOp.pop()}}if(!a.isPrimitive(l)){a.model.transform.expandWildcards(c,l)}c.pathOp.pop()})};a.model.transform.hasWildcard=function(c){return typeof(c)==="string"&&c.indexOf("*")!==-1};a.model.transform.maybePushWildcard=function(f,e){var c=a.model.transform.hasWildcard;var d;if(c(f.inputPath)){d=a.model.composePaths(e.inputPrefix,f.inputPath)}else{if(c(e.outputPrefix)||c(f.outputPath)){d=a.model.composePaths(e.outputPrefix,f.outputPath)}}if(d){e.queuedTransforms.push({transformSpec:f,outputPrefix:e.outputPrefix,inputPrefix:e.inputPrefix,matchPath:d});return true}return false};a.model.sortByKeyLength=function(d){var c=a.keys(d);return c.sort(a.compareStringLength(true))};a.model.transform.handleTransformStrategy=function(d,c,e){if(a.model.transform.maybePushWildcard(d,c)){return}else{return a.model.transform.doTransform(d,c,e)}};a.model.transform.handleInvertStrategy=function(e,d,f){var g=f.defaults&&f.defaults.invertConfiguration;if(g){var c=a.invokeGlobalFunction(g,[e,d]);d.inverted.push(c)}};a.model.transform.handleCollectStrategy=function(f,e,g){var i=g.defaults;var j=a.hasGrade(i,"fluid.standardInputTransformFunction");var d=a.hasGrade(i,"fluid.multiInputTransformFunction");if(j){a.model.transform.accumulateStandardInputPath("input",f,e,e.inputPaths)
}else{if(d){a.model.transform.accumulateMultiInputPaths(i.inputVariables,f,e,e.inputPaths)}else{var h=i.collectInputPaths;if(h){var c=a.makeArray(a.invokeGlobalFunction(h,[f,e]));e.inputPaths=e.inputPaths.concat(c)}}}};a.model.transform.lookupType=function(c,d){if(!c){a.fail("Transformation record is missing a type name: ",d)}if(c.indexOf(".")===-1){c="fluid.transforms."+c}var e=a.defaults(c);return{defaults:e,typeName:c}};a.model.transform.processRule=function(j,d){if(typeof(j)==="string"){j=a.model.transform.pathToRule(j)}else{if(j.literalValue&&d.outputPrefix!==""){j=a.model.transform.literalValueToRule(j.literalValue)}}var g;if(j.transform){var c,h;if(a.isArrayable(j.transform)){var f=j.transform;g=undefined;for(var e=0;e<f.length;++e){c=f[e];h=a.model.transform.lookupType(c.type);d.transformHandler(c,d,h)}}else{c=j.transform;h=a.model.transform.lookupType(c.type);g=d.transformHandler(c,d,h)}}if(a.isArrayable(j)){d.collectedFlatSchemaOpts=d.collectedFlatSchemaOpts||{};d.collectedFlatSchemaOpts[d.outputPrefix]="array"}a.each(j,function(l,i){if(i!=="transform"){d.outputPrefixOp.push(i);var k=d.expand(l,d);if(k!==undefined){a.model.transform.setValue(null,k,d);k=undefined}d.outputPrefixOp.pop()}});return g};a.model.transform.makeStrategy=function(c,d,e){e=e||a.model.transform.processRule;c.expand=function(f){return e(f,c)};c.outputPrefixOp=a.model.makePathStack(c,"outputPrefix");c.inputPrefixOp=a.model.makePathStack(c,"inputPrefix");c.transformHandler=d};a.model.transform.invertConfiguration=function(d){var c={inverted:[]};a.model.transform.makeStrategy(c,a.model.transform.handleInvertStrategy);c.expand(d);return{transform:c.inverted}};a.model.transform.collectInputPaths=function(d){var c={inputPaths:[]};a.model.transform.makeStrategy(c,a.model.transform.handleCollectStrategy);c.expand(d);return c.inputPaths};a.model.transform.flatSchemaStrategy=function(e,c){var d=a.model.sortByKeyLength(e);return function(g,l,h,f){var m=c.parser.compose.apply(null,f.slice(0,h));for(var k=0;k<d.length;++k){var j=d[k];if(a.pathUtil.matchPath(j,m,true)!==null){return e[j]}}}};a.model.transform.defaultSchemaValue=function(d){var c=a.isPrimitive(d)?d:d.type;return c==="array"?[]:{}};a.model.transform.isomorphicSchemaStrategy=function(d,c){return function(f,i,g,e){var h=a.get(d,e.slice(0,g),c);return a.isArrayable(h)?"array":"object"}};a.model.transform.decodeStrategy=function(e,d,c){if(d.isomorphic){return a.model.transform.isomorphicSchemaStrategy(e,c)}else{if(d.flatSchema){return a.model.transform.flatSchemaStrategy(d.flatSchema,c)}}};a.model.transform.schemaToCreatorStrategy=function(c){return function(e,g,f,d){if(e[g]===undefined){var h=c(e,g,f,d);e[g]=a.model.transform.defaultSchemaValue(h);return e[g]}}};a.model.transform.sequence=function(e,f,c){for(var d=0;d<f.length;++d){e=a.model.transform(e,f[d],c)}return e};a.model.compareByPathLength=function(d,c){var e=d.path.length-c.path.length;return e===0?d.sequence-c.sequence:e};a.model.fireSortedChanges=function(d,c){d.sort(a.model.compareByPathLength);a.requestChanges(c,d)};a.model.transformWithRules=function(h,i,f){f=f||{};var c=a.model.escapedGetConfig;var d=a.model.transform.decodeStrategy(h,f,c);var e={source:h,target:d?a.model.transform.defaultSchemaValue(d(null,"",0,[""])):{},resolverGetConfig:c,collectedFlatSchemaOpts:undefined,queuedChanges:[],queuedTransforms:[]};a.model.transform.makeStrategy(e,a.model.transform.handleTransformStrategy);e.applier={fireChangeRequest:function(j){j.sequence=e.queuedChanges.length;e.queuedChanges.push(j)}};a.bindRequestChange(e.applier);e.expand(i);var g=a.copy(a.model.escapedSetConfig);if(e.collectedFlatSchemaOpts!==undefined){b.extend(e.collectedFlatSchemaOpts,f.flatSchema);d=a.model.transform.flatSchemaStrategy(e.collectedFlatSchemaOpts,c)}g.strategies=[a.model.defaultFetchStrategy,d?a.model.transform.schemaToCreatorStrategy(d):a.model.defaultCreatorStrategy];e.finalApplier=f.finalApplier||a.makeChangeApplier(e.target,{resolverSetConfig:g});if(e.queuedTransforms.length>0){e.typeStack=[];e.pathOp=a.model.makePathStack(e,"path");a.model.transform.expandWildcards(e,h)}a.model.fireSortedChanges(e.queuedChanges,e.finalApplier);return e.target};b.extend(a.model.transformWithRules,a.model.transform);a.model.transform=a.model.transformWithRules;a.transformOne=function(c){return{transformOptions:{transformer:"fluid.model.transformWithRules",config:c}}};a.transformMany=function(c){return{transformOptions:{transformer:"fluid.model.transform.sequence",config:c}}}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};var fluid=fluid||fluid_1_5;(function(b,a){a.registerNamespace("fluid.model.transform");a.registerNamespace("fluid.transforms");a.defaults("fluid.transforms.value",{gradeNames:"fluid.standardTransformFunction",invertConfiguration:"fluid.transforms.value.invert"});a.transforms.value=a.identity;a.transforms.value.invert=function(d,c){var e=a.copy(d);e.inputPath=a.model.composePaths(c.outputPrefix,d.outputPath);e.outputPath=a.model.composePaths(c.inputPrefix,d.inputPath);return e};a.transforms.identity=a.transforms.value;a.defaults("fluid.transforms.identity",{gradeNames:"fluid.transforms.value"});a.defaults("fluid.transforms.literalValue",{gradeNames:"fluid.standardOutputTransformFunction"});a.transforms.literalValue=function(c){return c.value};a.defaults("fluid.transforms.arrayValue",{gradeNames:"fluid.standardTransformFunction"});a.transforms.arrayValue=a.makeArray;a.defaults("fluid.transforms.count",{gradeNames:"fluid.standardTransformFunction"});a.transforms.count=function(c){return a.makeArray(c).length};a.defaults("fluid.transforms.round",{gradeNames:"fluid.standardTransformFunction"});a.transforms.round=function(c){return Math.round(c)};a.defaults("fluid.transforms.delete",{gradeNames:"fluid.transformFunction"});a.transforms["delete"]=function(e,d){var c=a.model.composePaths(d.outputPrefix,e.outputPath);d.applier.requestChange(c,null,"DELETE")};a.defaults("fluid.transforms.firstValue",{gradeNames:"fluid.transformFunction"});a.transforms.firstValue=function(e,d){if(!e.values||!e.values.length){a.fail('firstValue transformer requires an array of values at path named "values", supplied',e)}for(var f=0;f<e.values.length;f++){var g=e.values[f];var c=d.expand(g);if(c!==undefined){return c}}};a.defaults("fluid.transforms.linearScale",{gradeNames:["fluid.multiInputTransformFunction","fluid.standardOutputTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.linearScale.invert",inputVariables:{value:null,factor:1,offset:0}});a.transforms.linearScale=function(c){var e=c.value();var d=c.factor();var f=c.offset();if(typeof(e)!=="number"||typeof(d)!=="number"||typeof(f)!=="number"){return undefined}return e*d+f};a.transforms.linearScale.invert=function(d,c){var e=a.copy(d);if(e.factor){e.factor=(e.factor===0)?0:1/e.factor}if(e.offset){e.offset=-e.offset*(e.factor!==undefined?e.factor:1)}e.valuePath=a.model.composePaths(c.outputPrefix,d.outputPath);e.outputPath=a.model.composePaths(c.inputPrefix,d.valuePath);return e};a.defaults("fluid.transforms.binaryOp",{gradeNames:["fluid.multiInputTransformFunction","fluid.standardOutputTransformFunction"],inputVariables:{left:null,right:null}});a.transforms.binaryLookup={"===":function(d,c){return d===c},"!==":function(d,c){return d!==c},"<=":function(d,c){return d<=c},"<":function(d,c){return d<c},">=":function(d,c){return d>=c},">":function(d,c){return d>c},"+":function(d,c){return d+c},"-":function(d,c){return d-c},"*":function(d,c){return d*c},"/":function(d,c){return d/c},"%":function(d,c){return d%c},"&&":function(d,c){return d&&c},"||":function(d,c){return d||c}};a.transforms.binaryOp=function(d,g,f){var i=d.left();var h=d.right();var e=a.model.transform.getValue(undefined,g.operator,f);var c=a.transforms.binaryLookup[e];return(c===undefined||i===undefined||h===undefined)?undefined:c(i,h)};a.defaults("fluid.transforms.condition",{gradeNames:["fluid.multiInputTransformFunction","fluid.standardOutputTransformFunction"],inputVariables:{"true":null,"false":null,condition:null}});a.transforms.condition=function(c){var d=c.condition();if(d===null){return undefined}return c[d?"true":"false"]()};a.defaults("fluid.transforms.valueMapper",{gradeNames:["fluid.transformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.valueMapper.invert",collectInputPaths:"fluid.transforms.valueMapper.collect"});a.model.transform.matchValueMapperFull=function(j,h,d){var c=h.options;if(c.length===0){a.fail("valueMapper supplied empty list of options: ",h)}if(c.length===1){return 0}var e=[];for(var f=0;f<c.length;++f){var g=c[f];var l=a.firstDefined(a.model.transform.getValue(g.inputPath,undefined,d),j);var k=a.model.transform.matchValue(g.undefinedInputValue?undefined:g.inputValue,l);e[f]={index:f,matchCount:k}}e.sort(a.model.transform.compareMatches);return e[0].matchCount===e[1].matchCount?-1:e[0].index};a.transforms.valueMapper=function(f,e){if(!f.options){a.fail('demultiplexValue requires a list or hash of options at path named "options", supplied ',f)}var i=a.model.transform.getValue(f.inputPath,undefined,e);var g=a.isArrayable(f.options)?function(k){var j=a.model.transform.matchValueMapperFull(k,f,e);return j===-1?null:f.options[j]}:function(j){return f.options[j]};var h=g(i);if(!h){h=g(f.defaultInputValue)}if(!h){return}var d=h.outputPath===undefined?f.defaultOutputPath:h.outputPath;e.outputPrefixOp.push(d);var c;if(a.isPrimitive(h)){c=h}else{if(h.undefinedOutputValue){c=undefined}else{c=a.model.transform.resolveParam(h,e,"outputValue",undefined);c=(c===undefined)?f.defaultOutputValue:c}}if(typeof(d)==="string"&&c!==undefined){a.model.transform.setValue(undefined,c,e,f.merge);c=undefined}e.outputPrefixOp.pop();return c};a.transforms.valueMapper.invert=function(i,f){var k=[];var e={type:"fluid.transforms.valueMapper",options:k};var h=a.isArrayable(i.options);var j=function(l){return a.find(i.options,function(m){if(m[l]){return true}})};var c=j("outputPath");var g=j("inputPath");if(!c){e.inputPath=a.model.composePaths(f.outputPrefix,i.outputPath)
}if(!g){e.defaultOutputPath=a.model.composePaths(f.inputPrefix,i.inputPath)}var d=a.firstDefined;a.each(i.options,function(p,o){var n={};var l=d(h?p.inputValue:o,i.defaultInputValue);if(l===undefined){a.fail("Failure inverting configuration for valueMapper - inputValue could not be resolved for record "+o+": ",i)}n.outputValue=l;var m=d(p.outputValue,i.defaultOutputValue);n.inputValue=a.model.transform.getValue(p.outputValuePath,m,f);if(c){n.inputPath=a.model.composePaths(f.outputPrefix,d(p.outputPath,i.outputPath))}if(g){n.outputPath=a.model.composePaths(f.inputPrefix,d(p.inputPath,i.inputPath))}if(p.outputValuePath){n.inputValuePath=p.outputValuePath}k.push(n)});return e};a.transforms.valueMapper.collect=function(d,c){var e=[];a.model.transform.accumulateInputPath(d.inputPath,c,e);a.each(d.options,function(f){a.model.transform.accumulateInputPath(f.inputPath,c,e)});return e};a.defaults("fluid.transforms.arrayToSetMembership",{gradeNames:["fluid.standardInputTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.arrayToSetMembership.invert"});a.transforms.arrayToSetMembership=function(f,e,d){var c=e.options;if(!f||!a.isArrayable(f)){a.fail("arrayToSetMembership didn't find array at inputPath nor passed as value.",e)}if(!c){a.fail("arrayToSetMembership requires an options block set")}if(e.presentValue===undefined){e.presentValue=true}if(e.missingValue===undefined){e.missingValue=false}a.each(c,function(i,g){var h=(b.inArray(g,f)!==-1)?e.presentValue:e.missingValue;a.model.transform.setValue(i,h,d)})};a.transforms.arrayToSetMembership.invert=function(d,c){var e=a.copy(d);delete e.inputPath;e.type="fluid.transforms.setMembershipToArray";e.outputPath=a.model.composePaths(c.inputPrefix,d.inputPath);var f={};a.each(d.options,function(h,g){var i=a.model.composePaths(c.outputPrefix,h);f[i]=g});e.options=f;return e};a.defaults("fluid.transforms.setMembershipToArray",{gradeNames:["fluid.standardOutputTransformFunction"]});a.transforms.setMembershipToArray=function(e,d){var c=e.options;if(!c){a.fail("setMembershipToArray requires an options block specified")}if(e.presentValue===undefined){e.presentValue=true}if(e.missingValue===undefined){e.missingValue=false}var f=[];a.each(c,function(i,g){var h=a.model.transform.getValue(g,undefined,d);if(h===e.presentValue){f.push(i)}});return f};a.model.transform.applyPaths=function(c,e,f){for(var d=0;d<f.length;++d){if(c==="push"){e.push(f[d])}else{e.pop()}}};a.model.transform.expandInnerValues=function(i,c,f,j){var h=f.inputPrefixOp;var g=f.outputPrefixOp;var e=a.model.transform.applyPaths;e("push",h,i);e("push",g,c);var d={};a.each(j,function(k){var l=f.expand(k);if(!a.isPrimitive(l)){b.extend(true,d,l)}else{d=l}});e("pop",g,c);e("pop",h,i);return d};a.defaults("fluid.transforms.arrayToObject",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.arrayToObject.invert"});a.transforms.arrayToObject=function(c,f,e){if(f.key===undefined){a.fail("arrayToObject requires a 'key' option.",f)}if(!a.isArrayable(c)){a.fail("arrayToObject didn't find array at inputPath.",f)}var g={};var d=f.key;a.each(c,function(i,h){var m=i[d];var l=typeof(m);if(l!=="string"&&l!=="boolean"&&l!=="number"){a.fail("arrayToObject encountered untransformable array due to missing or invalid key",i)}var j=a.copy(i);delete j[d];if(f.innerValue){j=a.model.transform.expandInnerValues([e.inputPrefix,f.inputPath,h.toString()],[m],e,f.innerValue)}g[m]=j});return g};a.transforms.arrayToObject.invert=function(e,d){var g=a.copy(e);g.type="fluid.transforms.objectToArray";g.inputPath=a.model.composePaths(d.outputPrefix,e.outputPath);g.outputPath=a.model.composePaths(d.inputPrefix,e.inputPath);if(g.innerValue){var c=g.innerValue;for(var f=0;f<c.length;++f){c[f]=a.model.transform.invertConfiguration(c[f])}}return g};a.defaults("fluid.transforms.objectToArray",{gradeNames:"fluid.standardTransformFunction"});a.transforms.objectToArray=function(g,f,e){if(f.key===undefined){a.fail("objectToArray requires a 'key' option.",f)}var c=[];var d=f.key;a.each(g,function(i,h){var j={};j[d]=h;if(f.innerValue){i=a.model.transform.expandInnerValues([f.inputPath,h],[f.outputPath,c.length.toString()],e,f.innerValue)}b.extend(true,j,i);c.push(j)});return c};a.defaults("fluid.transforms.limitRange",{gradeNames:"fluid.standardTransformFunction"});a.transforms.limitRange=function(h,e){var f=e.min;if(f!==undefined){var d=e.excludeMin||0;f+=d;if(h<f){h=f}}var c=e.max;if(c!==undefined){var g=e.excludeMax||0;c-=g;if(h>c){h=c}}return h};a.defaults("fluid.transforms.free",{gradeNames:"fluid.transformFunction"});a.transforms.free=function(d){var c=a.makeArray(d.args);return a.invokeGlobalFunction(d.func,c)}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};var fluid=fluid||fluid_1_5;(function(j,n){n.thatistBridge=function(G,I){var H=function(J){var L=J.split(".");var K=I;for(var O=0;O<L.length;++O){K=K[L[O]]}var N=[this];if(arguments.length===2){N=N.concat(j.makeArray(arguments[1]))}var M=K.apply(null,N);this.that=function(){return M};var P=typeof(M);return !M||P==="string"||P==="number"||P==="boolean"||(M&&M.length!==undefined)?M:this};j.fn[G]=H;return H};n.thatistBridge("fluid",n);n.thatistBridge("fluid_1_5",fluid_1_5);var k=function(){return j.browser.msie?"tabIndex":"tabindex"};var p=function(G){if(G.length<=0){return false}return j(G[0]).is("a, input, button, select, area, textarea, object")};var g=function(H){if(H.length<=0){return undefined}if(!n.tabindex.hasAttr(H)){return p(H)?Number(0):undefined}var G=H.attr(k());return Number(G)};var d=function(G,H){return G.each(function(I,J){j(J).attr(k(),H)})};n.tabindex=function(H,G){H=j(H);if(G!==null&&G!==undefined){return d(H,G)}else{return g(H)}};n.tabindex.remove=function(G){G=j(G);return G.each(function(H,I){j(I).removeAttr(k())})};n.tabindex.hasAttr=function(H){H=j(H);if(H.length<=0){return false}var G=H.map(function(){var I=this.getAttributeNode(k());return I?I.specified:false});return G.length===1?G[0]:G};n.tabindex.has=function(G){G=j(G);return n.tabindex.hasAttr(G)||p(G)};n.a11y=j.a11y||{};n.a11y.orientation={HORIZONTAL:0,VERTICAL:1,BOTH:2};var t={next:j.ui.keyCode.DOWN,previous:j.ui.keyCode.UP};var b={next:j.ui.keyCode.RIGHT,previous:j.ui.keyCode.LEFT};var B=function(G){return G.jquery?G[0]:G};var w=function(G){G.each(function(H,I){I=j(I);if(!I.fluid("tabindex.has")||I.fluid("tabindex")<0){I.fluid("tabindex",0)}})};n.tabbable=function(G){G=j(G);w(G)};var o="selectionContext";var v=-32768;var q=function(G){if(G.activeItemIndex!==v){if(G.options.onLeaveContainer){G.options.onLeaveContainer(G.selectables[G.activeItemIndex])}else{if(G.options.onUnselect){G.options.onUnselect(G.selectables[G.activeItemIndex])}}}if(!G.options.rememberSelectionState){G.activeItemIndex=v}};var m=function(G,H){if(H){H(G)}};var x=function(H,G){if(G&&H){G(H)}};var f=function(H,G){x(H,G.options.onUnselect)};var y=function(G,H){f(H.selectedElement(),H);G=B(G);var I=H.selectables.index(G);if(I===-1){return}H.activeItemIndex=I;m(G,H.options.onSelect)};var F=function(G){return function(H){j(H.target).fluid("tabindex",0);y(H.target,G);return H.stopPropagation()}};var h=function(G){return function(H){j(H.target).fluid("tabindex",G.options.selectablesTabindex);f(H.target,G);return H.stopPropagation()}};var u=function(G){var H=G.selectables;if(G.activeItemIndex>=H.length){G.activeItemIndex=(G.options.noWrap?H.length-1:0)}if(G.activeItemIndex<0&&G.activeItemIndex!==v){G.activeItemIndex=(G.options.noWrap?0:H.length-1)}if(G.activeItemIndex>=0){n.focus(H[G.activeItemIndex])}};var A=function(G){var H=G.selectedElement();if(H){n.blur(H)}f(G.selectedElement(),G);if(G.activeItemIndex===v){G.activeItemIndex=-1}};var C=function(G){A(G);++G.activeItemIndex;u(G)};var l=function(G){A(G);--G.activeItemIndex;u(G)};var i=function(G,H){return function(I){if(I.which===H.next){C(G);I.preventDefault()}else{if(I.which===H.previous){l(G);I.preventDefault()}}}};var s=function(G){var H;if(G===n.a11y.orientation.HORIZONTAL){H=b}else{if(G===n.a11y.orientation.VERTICAL){H=t}}return H};var c=function(G){return function(H){if(H.which!==j.ui.keyCode.TAB){return}q(G);if(H.shiftKey){G.focusIsLeavingContainer=true}}};var r=function(G){return function(H){var J=G.options.autoSelectFirstItem;var I=typeof(J)==="function"?J():J;if(G.focusIsLeavingContainer){I=false}if(I&&H.target===G.container.get(0)){if(G.activeItemIndex===v){G.activeItemIndex=0}n.focus(G.selectables[G.activeItemIndex])}return H.stopPropagation()}};var z=function(G){return function(H){G.focusIsLeavingContainer=false;return H.stopPropagation()}};var e=function(H,K,L){var I=j.extend(true,{},K,L);var M=s(I.direction);var G=I.selectableElements?I.selectableElements:H.find(I.selectableSelector);var J={container:H,activeItemIndex:v,selectables:G,focusIsLeavingContainer:false,options:I};J.selectablesUpdated=function(N){if(typeof(J.options.selectablesTabindex)==="number"){J.selectables.fluid("tabindex",J.options.selectablesTabindex)}J.selectables.unbind("focus."+o);J.selectables.unbind("blur."+o);J.selectables.bind("focus."+o,F(J));J.selectables.bind("blur."+o,h(J));if(M&&J.options.noBubbleListeners){J.selectables.unbind("keydown."+o);J.selectables.bind("keydown."+o,i(J,M))}if(N){y(N,J)}else{u(J)}};J.refresh=function(){if(!J.options.selectableSelector){n.fail("Cannot refresh selectable context which was not initialised by a selector")}J.selectables=H.find(I.selectableSelector);J.selectablesUpdated()};J.selectedElement=function(){return J.activeItemIndex<0?null:J.selectables[J.activeItemIndex]};if(M&&!J.options.noBubbleListeners){H.keydown(i(J,M))}H.keydown(c(J));H.focus(r(J));H.blur(z(J));J.selectablesUpdated();return J};n.selectable=function(I,G){I=j(I);var H=e(I,n.selectable.defaults,G);n.setScopedData(I,o,H);return H};n.selectable.select=function(H,G){n.focus(G)};n.selectable.selectNext=function(G){G=j(G);C(n.getScopedData(G,o))};n.selectable.selectPrevious=function(G){G=j(G);l(n.getScopedData(G,o))};n.selectable.currentSelection=function(H){H=j(H);
var G=n.getScopedData(H,o);return j(G.selectedElement())};n.selectable.defaults={direction:n.a11y.orientation.VERTICAL,selectablesTabindex:-1,autoSelectFirstItem:true,rememberSelectionState:true,selectableSelector:".selectable",selectableElements:null,onSelect:null,onUnselect:null,onLeaveContainer:null,noWrap:false};var a=function(L,H){if(!L.modifier){return true}var I=L.modifier;var J=I&&H.ctrlKey;var G=I&&H.altKey;var K=I&&H.shiftKey;return J||G||K};var E=function(G){return function(H){var K=H.target;if(!n.enabled(K)){return}var J=H.which?H.which:H.keyCode;if(J===G.key&&G.activateHandler&&a(G,H)){var I=j.Event("fluid-activate");j(K).trigger(I,[G.activateHandler]);if(I.isDefaultPrevented()){H.preventDefault()}}}};var D=function(J,M,G,H){var L=[];j(G).each(function(N,O){L.push({modifier:null,key:O,activateHandler:M})});if(H&&H.additionalBindings){L=L.concat(H.additionalBindings)}n.initEnablement(J);for(var I=0;I<L.length;++I){var K=L[I];J.keydown(E(K))}J.bind("fluid-activate",function(N,O){O=O||M;return O?O(N):null})};n.activatable=function(I,H,G){I=j(I);D(I,H,n.activatable.defaults.keys,G)};n.activate=function(G){j(G).trigger("fluid-activate")};n.activatable.defaults={keys:[j.ui.keyCode.ENTER,j.ui.keyCode.SPACE]}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(d,c){c.defaults("fluid.commonViewComponent",{gradeNames:["fluid.littleComponent","autoInit"],initFunction:"fluid.initView",argumentMap:{container:0,options:1},members:{dom:"@expand:fluid.initDomBinder({that}, {that}.options.selectors)"}});c.defaults("fluid.viewComponent",{gradeNames:["fluid.commonViewComponent","fluid.standardComponent","autoInit"]});c.defaults("fluid.viewRelayComponent",{gradeNames:["fluid.commonViewComponent","fluid.standardRelayComponent","autoInit"]});c.dumpSelector=function(e){return typeof(e)==="string"?e:e.selector?e.selector:""};c.diagnoseFailedView=function(f,j,h,g){if(!j&&(c.hasGrade(h,"fluid.viewComponent")||c.hasGrade(h,"fluid.viewRelayComponent"))){var e=c.wrap(g[1]);var i="Instantiation of autoInit component with type "+f+" failed, since ";if(!e){c.fail(i+" container argument is empty")}else{if(e.length===0){c.fail(i+'selector "',c.dumpSelector(g[1]),'" did not match any markup in the document')}else{c.fail(i+" component creator function did not return a value")}}}};c.checkTryCatchParameter=function(){var e=window.location||{search:"",protocol:"file:"};var f=e.search.slice(1).split("&");return c.find(f,function(g){if(g.indexOf("notrycatch")===0){return true}})===true};c.notrycatch=c.checkTryCatchParameter();c.wrap=function(e,f){f=f||d;return((!e||e.jquery)?e:f(e))};c.unwrap=function(e){return e&&e.jquery&&e.length===1?e[0]:e};c.container=function(g,h,i){if(i){g=c.unwrap(g)}var e=c.wrap(g,i);if(h&&(!e||e.length===0)){return null}if(!e||!e.jquery||e.length!==1){if(typeof(g)!=="string"){g=e.selector}var f=e.length!==undefined?e.length:0;c.fail((f>1?"More than one ("+f+") container elements were":"No container element was")+" found for selector "+g)}if(!c.isDOMNode(e[0])){c.fail("fluid.container was supplied a non-jQueryable element")}return e};c.createDomBinder=function(f,h){var g={},i={id:c.allocateGuid()};var k=f.constructor;function j(m,l){return c.allocateSimpleId(l)+"-"+m}function e(n,m,l){g[j(n,m)]=l}i.locate=function(n,p){var l,m,o;l=h[n];m=p?p:f;if(!m){c.fail("DOM binder invoked for selector "+n+" without container")}if(!l){return m}if(typeof(l)==="function"){o=k(l.call(null,c.unwrap(m)))}else{o=k(l,m)}if(o.get(0)===document){o=[]}if(!o.selector){o.selector=l;o.context=m}o.selectorName=n;e(n,m,o);return o};i.fastLocate=function(m,p){var l=p?p:f;var n=j(m,l);var o=g[n];return o?o:i.locate(m,p)};i.clear=function(){g={}};i.refresh=function(o,p){var m=p?p:f;if(typeof o==="string"){o=[o]}if(m.length===undefined){m=[m]}for(var n=0;n<o.length;++n){for(var l=0;l<m.length;++l){i.locate(o[n],m[l])}}};i.resolvePathSegment=i.locate;return i};c.expectFilledSelector=function(e,f){if(e&&e.length===0&&e.jquery){c.fail(f+': selector "'+e.selector+'" with name '+e.selectorName+" returned no results in context "+c.dumpEl(e.context))}};c.initView=function(f,j,k,i){var e=c.container(j,true);c.expectFilledSelector(e,'Error instantiating component with name "'+f);if(!e){return null}var h=function(m){m.container=e};var g=c.initLittleComponent(f,k,i||{gradeNames:["fluid.viewComponent"]},h);if(!g.dom){c.initDomBinder(g)}var l=g.options.jQuery;c.log("Constructing view component "+f+" with container "+e.constructor.expando+(l?" user jQuery "+l.expando:"")+" env: "+d.expando);return g};c.initDomBinder=function(f,e){f.dom=c.createDomBinder(f.container,e||f.options.selectors||{});f.locate=f.dom.locate;return f.dom};c.findAncestor=function(e,f){e=c.unwrap(e);while(e){if(f(e)){return e}e=e.parentNode}};c.findForm=function(e){return c.findAncestor(e,function(f){return f.nodeName.toLowerCase()==="form"})};c.each(["text","html"],function(e){c[e]=function(f,g){f=d(f);return g===undefined?f[e]():f[e](g)}});c.value=function(l,k){var i=c.unwrap(l);var e=false;if(i.nodeType===undefined&&i.length>1){i=i[0];e=true}if("input"!==i.nodeName.toLowerCase()||!/radio|checkbox/.test(i.type)){return k===undefined?d(i).val():d(i).val(k)}var f=i.name;if(f===undefined){c.fail("Cannot acquire value from node "+c.dumpEl(i)+" which does not have name attribute set")}var j;if(e){j=l}else{j=i.ownerDocument.getElementsByName(f);var g=c.findForm(i);j=d.grep(j,function(m){if(m.name!==f){return false}return !g||c.dom.isContainer(g,m)})}if(k!==undefined){if(typeof(k)==="boolean"){k=(k?"true":"false")}d.each(j,function(){this.checked=(k instanceof Array?d.inArray(this.value,k)!==-1:k===this.value)})}else{var h=d.map(j,function(m){return m.checked?m.value:null});return i.type==="radio"?h[0]:h}};c.BINDING_ROOT_KEY="fluid-binding-root";c.findData=function(f,e){while(f){var g=d.data(f,e);if(g){return g}f=f.parentNode}};c.bindFossils=function(f,g,e){d.data(f,c.BINDING_ROOT_KEY,{data:g,fossils:e})};c.boundPathForNode=function(h,g){h=c.unwrap(h);var f=h.name||h.id;var e=g[f];return e?e.EL:null};c.applyBoundChange=function(j,k,g){j=c.unwrap(j);if(k===undefined){k=c.value(j)}if(j.nodeType===undefined&&j.length>0){j=j[0]}var e=c.findData(j,c.BINDING_ROOT_KEY);if(!e){c.fail("Bound data could not be discovered in any node above "+c.dumpEl(j))}var f=j.name;var h=e.fossils[f];if(!h){c.fail("No fossil discovered for name "+f+" in fossil record above "+c.dumpEl(j))}if(typeof(h.oldvalue)==="boolean"){k=k[0]?true:false}var i=e.fossils[f].EL;if(g){g.fireChangeRequest({path:i,value:k,source:"DOM:"+j.id})}else{c.set(e.data,i,k)}};c.jById=function(h,g){g=g&&g.nodeType===9?g:document;var e=c.byId(h,g);var f=e?d(e):[];f.selector="#"+h;f.context=g;return f};c.byId=function(g,f){f=f&&f.nodeType===9?f:document;var e=f.getElementById(g);if(e){if(e.id!==g){c.fail("Problem in document structure - picked up element "+c.dumpEl(e)+" for id "+g+" without this id - most likely the element has a name which conflicts with this id")}return e}else{return null}};c.getId=function(e){return c.unwrap(e).id};c.allocateSimpleId=function(f){var e="fluid-id-"+c.allocateGuid();if(!f||c.isPrimitive(f)){return e}f=c.unwrap(f);if(!f.id){f.id=e}return f.id};c.defaults("fluid.ariaLabeller",{labelAttribute:"aria-label",liveRegionMarkup:'<div class="liveRegion fl-offScreen-hidden" aria-live="polite"></div>',liveRegionId:"fluid-ariaLabeller-liveRegion",events:{generateLiveElement:"unicast"},listeners:{generateLiveElement:"fluid.ariaLabeller.generateLiveElement"}});c.ariaLabeller=function(f,e){var g=c.initView("fluid.ariaLabeller",f,e);g.update=function(i){i=i||g.options;g.container.attr(g.options.labelAttribute,i.text);if(i.dynamicLabel){var h=c.jById(g.options.liveRegionId);if(h.length===0){h=g.events.generateLiveElement.fire(g)}h.text(i.text)}};g.update();return g};c.ariaLabeller.generateLiveElement=function(f){var e=d(f.options.liveRegionMarkup);e.prop("id",f.options.liveRegionId);d("body").append(e);return e};var b="aria-labelling";c.getAriaLabeller=function(e){e=d(e);var f=c.getScopedData(e,b);return f};c.updateAriaLabel=function(f,h,e){e=d.extend({},e||{},{text:h});var g=c.getAriaLabeller(f);if(!g){g=c.ariaLabeller(f,e);c.setScopedData(f,b,g)}else{g.update(e)}return g};var a={};d(document).click(function(e){var f=c.resolveEventTarget(e);while(f){if(a[f.id]){return}f=f.parentNode}c.each(a,function(h,g){h(e);delete a[g]})});c.globalDismissal=function(e,f){c.each(e,function(g){var h=c.unwrap(g).ownerDocument===document?c.allocateSimpleId(g):c.allocateGuid();if(f){a[h]=f}else{delete a[h]}})};c.now=function(){return Date.now?Date.now():(new Date()).getTime()};c.deadMansBlur=function(g,e){var f={options:d.extend(true,{},c.defaults("fluid.deadMansBlur"),e)};f.blurPending=false;f.lastCancel=0;f.canceller=function(h){c.log("Cancellation through "+h.type+" on "+c.dumpEl(h.target));f.lastCancel=c.now();f.blurPending=false};f.noteProceeded=function(){c.globalDismissal(f.options.exclusions)};f.reArm=function(){c.globalDismissal(f.options.exclusions,f.proceed)};f.addExclusion=function(h){c.globalDismissal(h,f.proceed)};f.proceed=function(h){c.log("Direct proceed through "+h.type+" on "+c.dumpEl(h.target));f.blurPending=false;f.options.handler(g)};c.each(f.options.exclusions,function(h){h=d(h);c.each(h,function(i){d(i).bind("focusin",f.canceller).bind("fluid-focus",f.canceller).click(f.canceller).mousedown(f.canceller)})});if(!f.options.cancelByDefault){d(g).bind("focusout",function(i){c.log("Starting blur timer for element "+c.dumpEl(i.target));var h=c.now();c.log("back delay: "+(h-f.lastCancel));if(h-f.lastCancel>f.options.backDelay){f.blurPending=true}setTimeout(function(){if(f.blurPending){f.options.handler(g)}},f.options.delay)})}else{f.reArm()}return f};c.defaults("fluid.deadMansBlur",{delay:150,backDelay:100})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(e,d){var c={};var b={};d.fetchResources=function(g,i,f){var h=d.initLittleComponent("fluid.fetchResources",f);h.resourceSpecs=g;h.callback=i;h.operate=function(){d.fetchResources.fetchResourcesImpl(h)
};d.each(g,function(j,k){j.recurseFirer=d.event.getEventFirer(null,null,'I/O completion for resource "'+k+'"');j.recurseFirer.addListener(h.operate);if(j.url&&!j.href){j.href=j.url}});if(h.options.amalgamateClasses){d.fetchResources.amalgamateClasses(g,h.options.amalgamateClasses,h.operate)}h.operate();return h};d.fetchResources.amalgamateClasses=function(h,g,f){d.each(g,function(i){var j=b[i];d.each(j,function(k,l){h[i+"!"+l]=k;k.recurseFirer.addListener(f)})})};d.fetchResources.timeSuccessCallback=function(f){if(f.timeSuccess&&f.options&&f.options.success){var g=f.options.success;f.options.success=function(){var i=new Date();var h=g.apply(null,arguments);d.log("External callback for URL "+f.href+" completed - callback time: "+(new Date().getTime()-i.getTime())+"ms");return h}}};function a(f){return f}d.fetchResources.clearResourceCache=function(f){if(f){delete c[a(f)]}else{d.clear(c)}};d.fetchResources.handleCachedRequest=function(g,f){var i=a(g.href);var h=c[i];if(h.$$firer$$){d.log("Handling request for "+i+" from cache");var j=g.fetchClass;if(j&&b[j]){d.log("Clearing pendingClass entry for class "+j);delete b[j][i]}c[i]=f;h.fire(f)}};d.fetchResources.completeRequest=function(f){f.queued=false;f.completeTime=new Date();d.log("Request to URL "+f.href+" completed - total elapsed time: "+(f.completeTime.getTime()-f.initTime.getTime())+"ms");f.recurseFirer.fire()};d.fetchResources.makeResourceCallback=function(f){return{success:function(g){f.resourceText=g;f.resourceKey=f.href;if(f.forceCache){d.fetchResources.handleCachedRequest(f,g)}d.fetchResources.completeRequest(f)},error:function(g,i,h){f.fetchError={status:g.status,textStatus:g.textStatus,errorThrown:h};d.fetchResources.completeRequest(f)}}};d.fetchResources.issueCachedRequest=function(g,f){var i=a(g.href);var h=c[i];if(!h){d.log("First request for cached resource with url "+i);h=d.event.getEventFirer(null,null,"cache notifier for resource URL "+i);h.$$firer$$=true;c[i]=h;var j=g.fetchClass;if(j){if(!b[j]){b[j]={}}b[j][i]=g}f.cache=false;e.ajax(f)}else{if(!h.$$firer$$){f.success(h)}else{d.log("Request for cached resource which is in flight: url "+i);h.addListener(function(k){f.success(k)})}}};d.fetchResources.composeCallbacks=function(f,g){return g?(f?function(){try{g.apply(null,arguments)}catch(h){d.log("Exception applying external fetchResources callback: "+h)}f.apply(null,arguments)}:g):f};d.fetchResources.composePolicy=function(g,f){return d.fetchResources.composeCallbacks(g,f)};d.defaults("fluid.fetchResources.issueRequest",{mergePolicy:{success:d.fetchResources.composePolicy,error:d.fetchResources.composePolicy,url:"reverse"}});d.fetchResources.issueRequest=function(g,h){var i=d.fetchResources.makeResourceCallback(g);var f={url:g.href,success:i.success,error:i.error,dataType:g.dataType||"text"};d.fetchResources.timeSuccessCallback(g);f=d.merge(d.defaults("fluid.fetchResources.issueRequest").mergePolicy,f,g.options);g.queued=true;g.initTime=new Date();d.log("Request with key "+h+" queued for "+g.href);if(g.forceCache){d.fetchResources.issueCachedRequest(g,f)}else{e.ajax(f)}};d.fetchResources.fetchResourcesImpl=function(l){var f=true;var j=true;var h=l.resourceSpecs;for(var i in h){var g=h[i];if(!g.options||g.options.async){j=false}if(g.href&&!g.completeTime){if(!g.queued){d.fetchResources.issueRequest(g,i)}if(g.queued){f=false}}else{if(g.nodeId&&!g.resourceText){var k=document.getElementById(g.nodeId);g.resourceText=d.dom.getElementText(k);g.resourceKey=g.nodeId}}}if(f&&l.callback&&!l.callbackCalled){l.callbackCalled=true;if(e.browser.mozilla&&!j){setTimeout(function(){l.callback(h)},1)}else{l.callback(h)}}};d.fetchResources.primeCacheFromResources=function(f){var h=d.defaults(f).resources;var g=(d.expandOptions?d.expandOptions:d.identity)(d.copy(h));d.fetchResources(g)};d.registerNamespace("fluid.expander");d.expander.makeDefaultFetchOptions=function(f,h,g){return e.extend(true,{dataType:"text"},g,{success:function(i,k){var j=JSON.parse(i);k(f(j))},error:function(i,j){d.log("Error fetching "+h+": "+j)}})};d.expander.makeFetchExpander=function(f){return{expander:{type:"fluid.expander.deferredFetcher",href:f.url,options:d.expander.makeDefaultFetchOptions(f.disposer,f.url,f.options),resourceSpecCollector:"{resourceSpecCollector}",fetchKey:f.fetchKey}}};d.expander.deferredFetcher=function(m,j,h){var l=j.expander;var f=d.copy(l);var k=d.expand(l.resourceSpecCollector,h);delete f.type;delete f.resourceSpecCollector;delete f.fetchKey;var i=function(n){m(n)};f.options.success=function(n){l.options.success(n,i)};var g=l.fetchKey||d.allocateGuid();k[g]=f;return d.NO_VALUE}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.undo");a.undo.STATE_INITIAL="state_initial";a.undo.STATE_CHANGED="state_changed";a.undo.STATE_REVERTED="state_reverted";a.undo.defaultRenderer=function(f,d){var g=f.options.strings;var c="<span class='flc-undo'><a href='#' class='flc-undo-undoControl'>"+g.undo+"</a><a href='#' class='flc-undo-redoControl'>"+g.redo+"</a></span>";var e=b(c).attr({role:"region","aria-live":"polite","aria-relevant":"all"});d.append(e);return e};a.undo.refreshView=function(c){if(c.state===a.undo.STATE_INITIAL){c.locate("undoContainer").hide();c.locate("redoContainer").hide()}else{if(c.state===a.undo.STATE_CHANGED){c.locate("undoContainer").show();c.locate("redoContainer").hide()}else{if(c.state===a.undo.STATE_REVERTED){c.locate("undoContainer").hide();c.locate("redoContainer").show()}}}};a.undo.undoControlClick=function(c){if(c.state!==a.undo.STATE_REVERTED){a.model.copyModel(c.extremalModel,c.component.model);c.component.updateModel(c.initialModel,c);c.state=a.undo.STATE_REVERTED;a.undo.refreshView(c);c.locate("redoControl").focus()}return false};a.undo.redoControlClick=function(c){if(c.state!==a.undo.STATE_CHANGED){c.component.updateModel(c.extremalModel,c);c.state=a.undo.STATE_CHANGED;a.undo.refreshView(c);c.locate("undoControl").focus()}return false};a.undo.modelChanged=function(d,c,f,e){if(e!==d){d.state=a.undo.STATE_CHANGED;a.model.copyModel(d.initialModel,f);a.undo.refreshView(d)}};a.undo.finalInit=function(c){a.tabindex(c.locate("undoControl"),0);a.tabindex(c.locate("redoControl"),0);a.model.copyModel(c.initialModel,c.component.model);a.model.copyModel(c.extremalModel,c.component.model)};a.defaults("fluid.undo",{gradeNames:["fluid.eventedComponent","autoInit"],members:{state:a.undo.STATE_INITIAL,initialModel:{},extremalModel:{},component:"{fluid.undoable}",container:{expander:{func:"{that}.options.renderer",args:["{that}","{that}.component.container"]}},dom:{expander:{funcName:"fluid.initDomBinder",args:["{that}","{that}.options.selectors"]}}},invokers:{undoControlClick:{funcName:"fluid.undo.undoControlClick",args:"{that}"},redoControlClick:{funcName:"fluid.undo.redoControlClick",args:"{that}"}},listeners:{onCreate:[{funcName:"fluid.undo.refreshView",args:"{that}"},{"this":"{that}.dom.undoControl",method:"click",args:"{that}.undoControlClick"},{"this":"{that}.dom.redoControl",method:"click",args:"{that}.redoControlClick"}],"{fluid.undoable}.events.modelChanged":{funcName:"fluid.undo.modelChanged",args:["{that}","{arguments}.0","{arguments}.1","{arguments}.2"]}},selectors:{undoContainer:".flc-undo-undoControl",undoControl:".flc-undo-undoControl",redoContainer:".flc-undo-redoControl",redoControl:".flc-undo-redoControl"},strings:{undo:"undo edit",redo:"redo edit"},renderer:a.undo.defaultRenderer});a.defaults("fluid.undoable",{gradeNames:["fluid.modelComponent"],invokers:{updateModel:{}},events:{modelChanged:null}});a.defaults("fluid.undoDecorator",{gradeNames:["fluid.undo","autoInit"]})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.tooltip");a.tooltip.computeContentFunc=function(c){c.contentFunc=c.options.contentFunc?c.options.contentFunc:c.modelToContentFunc()};a.tooltip.updateContentImpl=function(c){c.computeContentFunc();if(c.initialised){c.container.tooltip("option","content",c.contentFunc)}};a.tooltip.updateContent=function(d,c){if(d.model.content!==c){d.applier.requestChange("content",c)}};a.tooltip.idSearchFunc=function(c){return function(){var f=this;if(b.contains(f.ownerDocument,f)){var e=c();var d=a.findAncestor(f,function(g){return e[g.id]});return d?e[d.id]:null}else{return null}}};a.tooltip.modelToContentFunc=function(d){var c=d.model;if(c.idToContent){return a.tooltip.idSearchFunc(function(){return d.model.idToContent})}else{if(c.content){return function(){return c.content}}}};a.tooltip.makeOpenHandler=function(c){return function(f,g){a.tooltip.closeAll(c);var e=a.resolveEventTarget(f);var d=a.allocateSimpleId(e);c.openIdMap[d]=true;if(c.initialised){c.events.afterOpen.fire(c,e,g.tooltip,f)}}};a.tooltip.makeCloseHandler=function(c){return function(e,f){if(c.initialised){var d=a.resolveEventTarget(e);delete c.openIdMap[d.id];c.events.afterClose.fire(c,d,f.tooltip,e)}}};a.tooltip.closeAll=function(c){a.each(c.openIdMap,function(e,d){var f=a.byId(d);c.container.tooltip("close",{type:"close",currentTarget:f,target:f})});a.clear(c.openIdMap)};a.tooltip.setup=function(e){a.tooltip.updateContentImpl(e);var d={content:e.contentFunc,open:a.tooltip.makeOpenHandler(e),close:a.tooltip.makeCloseHandler(e)};var c=b.extend(true,d,e.options.widgetOptions);e.container.tooltip(c);e.initialised=true};a.tooltip.doDestroy=function(c){if(c.initialised){a.tooltip.closeAll(c);if(b.contains(document,c.container[0])){c.container.tooltip("destroy")}c.initialised=false}};a.defaults("fluid.tooltip",{gradeNames:["fluid.viewComponent","autoInit"],widgetOptions:{tooltipClass:"{that}.options.styles.tooltip",position:"{that}.options.position",items:"{that}.options.items",show:{duration:"{that}.options.duration",delay:"{that}.options.delay"},hide:{duration:"{that}.options.duration",delay:"{that}.options.delay"}},invokers:{open:{"this":"{that}.container",method:"tooltip",args:"open"},close:{funcName:"fluid.tooltip.closeAll",args:"{that}"},updateContent:{funcName:"fluid.tooltip.updateContent",args:["{that}","{arguments}.0"]},computeContentFunc:{funcName:"fluid.tooltip.computeContentFunc",args:["{that}"]},modelToContentFunc:{funcName:"fluid.tooltip.modelToContentFunc",args:"{that}"}},model:{content:"{that}.options.content"},members:{openIdMap:{}},styles:{tooltip:""},events:{afterOpen:null,afterClose:null},listeners:{onCreate:"fluid.tooltip.setup",onDestroy:"fluid.tooltip.doDestroy"},modelListeners:{"":{funcName:"fluid.tooltip.updateContentImpl",args:"{that}"}},position:{my:"left top",at:"left bottom",offset:"0 5"},items:"*",delay:300})
})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.inlineEdit");a.inlineEdit.sendKey=function(g,f,c,e){var d=document.createEvent("KeyEvents");d.initKeyEvent(f,1,1,null,0,0,0,0,c,e);g.dispatchEvent(d)};a.setCaretToEnd=function(g,d){var h=d?d.length:0;try{g.focus();if(g.setSelectionRange){g.setSelectionRange(h,h);if(b.browser.mozilla&&h>0){a.inlineEdit.sendKey(g,"keypress",92,92);a.inlineEdit.sendKey(g,"keydown",8,0);a.inlineEdit.sendKey(g,"keypress",8,0)}}else{if(g.createTextRange){var c=g.createTextRange();c.move("character",h);c.select()}}}catch(f){}};a.inlineEdit.switchToViewMode=function(c){c.editContainer.hide();c.displayModeRenderer.show()};a.inlineEdit.cancel=function(c){if(c.isEditing()){setTimeout(function(){c.editView.value(c.model.value)},1);a.inlineEdit.switchToViewMode(c);c.events.afterFinishEdit.fire(c.model.value,c.model.value,c.editField[0],c.viewEl[0])}};a.inlineEdit.finish=function(g){var h=g.editView.value();var e=g.model.value;var c=g.viewEl[0];var f=g.editField[0];var d=g.events.onFinishEdit.fire(h,e,f,c);if(d===false){return}g.updateModelValue(h);g.events.afterFinishEdit.fire(h,e,f,c);a.inlineEdit.switchToViewMode(g)};a.inlineEdit.bindEditFinish=function(f){if(f.options.submitOnEnter===undefined){f.options.submitOnEnter="textarea"!==a.unwrap(f.editField).nodeName.toLowerCase()}function g(h){return h.keyCode?h.keyCode:(h.which?h.which:0)}var e=f.textEditButton||b();var c=function(h){var i=g(h);if(i===b.ui.keyCode.ESCAPE){e.focus();a.inlineEdit.cancel(f);return false}};var d=function(h){var i=g(h);if(i!==b.ui.keyCode.ENTER){e.blur();return true}else{a.inlineEdit.finish(f);e.focus()}return false};if(f.options.submitOnEnter){f.editContainer.keypress(d)}f.editContainer.keydown(c)};a.inlineEdit.bindBlurHandler=function(c){if(c.options.blurHandlerBinder){c.options.blurHandlerBinder(c)}else{var d=function(){if(c.isEditing()){a.inlineEdit.finish(c)}return false};c.editField.blur(d)}};a.inlineEdit.initializeEditView=function(d,c){if(!d.editInitialized){a.inlineEdit.renderEditContainer(d,!d.options.lazyEditView||!c);if(!d.options.lazyEditView||!c){d.events.onCreateEditView.fire();if(d.textEditButton){a.inlineEdit.bindEditFinish(d)}a.inlineEdit.bindBlurHandler(d);d.editView.refreshView(d);d.editInitialized=true}}};a.inlineEdit.edit=function(d){a.inlineEdit.initializeEditView(d,false);var c=d.viewEl;var e=d.displayView.value();d.updateModelValue(d.model.value===""?"":e);if(d.options.applyEditPadding){d.editField.width(Math.max(c.width()+d.options.paddings.edit,d.options.paddings.minimumEdit))}d.displayModeRenderer.hide();d.editContainer.show();setTimeout(function(){a.setCaretToEnd(d.editField[0],d.editView.value());if(d.options.selectOnEdit){d.editField[0].select()}},0);d.events.afterBeginEdit.fire()};a.inlineEdit.clearEmptyViewStyles=function(c,e,d){c.removeClass(e.defaultViewStyle);c.css("padding-right",d);c.removeClass(e.emptyDefaultViewText)};a.inlineEdit.showDefaultViewText=function(c){c.displayView.value(c.options.strings.defaultViewText);c.viewEl.css("padding-right",c.existingPadding);c.viewEl.addClass(c.options.styles.defaultViewStyle)};a.inlineEdit.showNothing=function(c){c.displayView.value("");if(b.browser.msie){if(c.viewEl.css("display")==="inline"){c.viewEl.css("display","inline-block")}}};a.inlineEdit.showEditedText=function(c){c.displayView.value(c.model.value);a.inlineEdit.clearEmptyViewStyles(c.viewEl,c.options.styles,c.existingPadding)};a.inlineEdit.refreshView=function(c,d){c.displayView.refreshView(c,d);if(c.editView){c.editView.refreshView(c,d)}};a.inlineEdit.updateModelValue=function(d,f,e){var c=d.options.modelComparator;var g=c?c(d.model.value,f):d.model.value===f;if(!g){var h=b.extend(true,{},d.model);d.model.value=f;d.events.modelChanged.fire(d.model,h,e);d.refreshView(e)}};a.inlineEdit.editHandler=function(d){var c=d.events.onBeginEdit.fire();if(c===false){return false}a.inlineEdit.edit(d);return true};a.inlineEdit.initTooltips=function(d){var c={content:d.options.tooltipText,position:{my:"left top",at:"left bottom",offset:"0 5"},target:"*",delay:d.options.tooltipDelay,styles:{tooltip:d.options.styles.tooltip}};a.tooltip(d.viewEl,c);if(d.textEditButton){a.tooltip(d.textEditButton,c)}};a.inlineEdit.calculateInitialPadding=function(c){var d=c.css("padding-right");return d?parseFloat(d):0};a.inlineEdit.setupEditField=function(d,f,c){var e=b(f);e=e.length?e:b(c);e.addClass(d);return e};a.inlineEdit.setupEditContainer=function(f,c,e,g){var d=b(e);d=d.length?d:b(g);f.after(d);d.append(c);return d};a.inlineEdit.defaultEditModeRenderer=function(d){var c=a.inlineEdit.setupEditField(d.options.styles.edit,d.editField,d.options.markup.editField);var e=a.inlineEdit.setupEditContainer(d.displayModeRenderer,c,d.editContainer,d.options.markup.editContainer);var f=a.inlineEdit.setupEditModeInstruction(d.options.styles.editModeInstruction,d.options.strings.editModeInstruction,d.options.markup.editModeInstruction);var g=a.allocateSimpleId(f);c.attr("aria-describedby",g);a.inlineEdit.positionEditModeInstruction(f,e,c);return{container:e,field:c}};a.inlineEdit.renderEditContainer=function(e,d){e.editContainer=e.locate("editContainer");e.editField=e.locate("edit");if(e.editContainer.length!==1){if(e.editContainer.length>1){a.fail("InlineEdit did not find a unique container for selector "+e.options.selectors.editContainer+": "+a.dumpEl(e.editContainer))}}if(!d){return}var c=e.options.editModeRenderer(e);if(c){e.editContainer=c.container;e.editField=c.field}};a.inlineEdit.setupEditModeInstruction=function(c,e,d){var f=b(d);f.addClass(c);f.text(e);return f};a.inlineEdit.positionEditModeInstruction=function(e,d,c){d.append(e);c.focus(function(){e.show();var f=c.offset();e.css({left:f.left});e.css({top:f.top+c.height()+5})})};a.inlineEdit.setupDisplayModeContainer=function(c,d){var e=b(d);e=e.length?e:b("<span></span>");e.addClass(c.displayView);return e};a.inlineEdit.setupDisplayText=function(c,d){c.attr("tabindex","-1");c.addClass(d);return c};a.inlineEdit.setupTextEditButton=function(g,e){var f=g.options;var c=g.locate("textEditButton");if(c.length===0){var d=b(g.options.markup.textEditButton);d.addClass(f.styles.textEditButton);d.text(f.tooltipText);a.inlineEdit.updateTextEditButton(d,e.value||f.strings.defaultViewText,f.strings.textEditButton);g.events.modelChanged.addListener(function(){a.inlineEdit.updateTextEditButton(d,e.value||f.strings.defaultViewText,f.strings.textEditButton)});g.locate("text").after(d);c=g.locate("textEditButton")}return c};a.inlineEdit.updateTextEditButton=function(c,e,f){var d=a.stringTemplate(f,{text:e});c.text(d)};a.inlineEdit.bindHoverHandlers=function(f,e){var d=function(){f.addClass(e)};var c=function(){f.removeClass(e)};f.hover(d,c)};a.inlineEdit.bindHighlightHandler=function(f,h,g,d,e){f=b(f);var c=function(i){return function(){h.toggleClass(g.focus,i);h.toggleClass(g.invitation,i);if(!e||!e.value){h.prevObject.text(i?d.defaultFocussedViewText:d.defaultViewText)}}};f.focus(c(true));f.blur(c(false))};a.inlineEdit.bindMouseHandlers=function(c,d){c=b(c);var e=a.inlineEdit.makeEditTriggerGuard(c,d);c.click(function(f){e(f);return false})};a.inlineEdit.bindKeyboardHandlers=function(c,e){c=b(c);c.attr("role","button");var d=a.inlineEdit.makeEditTriggerGuard(c,e);a.activatable(c,function(f){return d(f)})};a.inlineEdit.makeEditTriggerGuard=function(e,d){var c=a.unwrap(e);return function(g){var f=a.findAncestor(g.target,function(h){if(/input|select|textarea|button|a/i.test(h.nodeName)||h===c){return true}});if(f===c){d();return false}}};a.inlineEdit.bindEventHandlers=function(e,d,f){var c=e.options.styles;a.inlineEdit.bindHoverHandlers(f,c.invitation);a.inlineEdit.bindMouseHandlers(e.viewEl,d);a.inlineEdit.bindMouseHandlers(e.textEditButton,d);a.inlineEdit.bindKeyboardHandlers(e.textEditButton,d);a.inlineEdit.bindHighlightHandler(e.viewEl,f,e.options.styles,e.options.strings,e.model);a.inlineEdit.bindHighlightHandler(e.textEditButton,f,e.options.styles,e.options.strings,e.model)};a.inlineEdit.defaultDisplayModeRenderer=function(f,e,c){var d=f.options.styles;var g=a.inlineEdit.setupDisplayModeContainer(d);var h=f.viewEl.wrap(g).parent();f.textEditButton=a.inlineEdit.setupTextEditButton(f,c);h.append(f.textEditButton);a.inlineEdit.bindEventHandlers(f,e,h);return h};a.inlineEdit.getNodeName=function(c){return a.unwrap(c).nodeName.toLowerCase()};a.defaults("fluid.inlineEdit.standardAccessor",{gradeNames:["fluid.viewComponent","autoInit"],members:{nodeName:{expander:{funcName:"fluid.inlineEdit.getNodeName",args:"{that}.container"}}},invokers:{value:{funcName:"fluid.inlineEdit.standardAccessor.value",args:["{that}.nodeName","{that}.container","{arguments}.0"]}}});a.inlineEdit.standardAccessor.value=function(e,c,d){return a[e==="input"||e==="textarea"?"value":"text"](b(c),d)};a.defaults("fluid.inlineEdit.standardDisplayView",{gradeNames:["fluid.viewComponent","autoInit"],invokers:{refreshView:{funcName:"fluid.inlineEdit.standardDisplayView.refreshView",args:["{fluid.inlineEdit}","{that}.container","{arguments}.0"]}}});a.inlineEdit.standardDisplayView.refreshView=function(c){if(c.model.value){a.inlineEdit.showEditedText(c)}else{if(c.options.strings.defaultViewText){a.inlineEdit.showDefaultViewText(c)}else{a.inlineEdit.showNothing(c)}}if(b.trim(c.viewEl.text()).length===0){c.viewEl.addClass(c.options.styles.emptyDefaultViewText);if(c.existingPadding<c.options.paddings.minimumView){c.viewEl.css("padding-right",c.options.paddings.minimumView)}}};a.defaults("fluid.inlineEdit.standardEditView",{gradeNames:["fluid.viewComponent","autoInit"],invokers:{refreshView:{funcName:"fluid.inlineEdit.standardEditView.refreshView",args:["{fluid.inlineEdit}","{that}.container","{arguments}.0"]}}});a.inlineEdit.standardEditView.refreshView=function(d,c,e){if(!e||(c&&c.index(e)===-1)){d.editView.value(d.model.value)}};a.inlineEdit.setup=function(c){if(c.editContainer){c.editContainer.hide()}if(c.tooltipEnabled()){a.inlineEdit.initTooltips(c)}};a.inlineEdit.setIsEditing=function(c,d){c.isEditingState=d
};a.inlineEdit.tooltipEnabled=function(c){return c&&b.fn.tooltip};a.inlineEdit.processUndoDecorator=function(e){if(e.options.componentDecorators){var d=a.makeArray(e.options.componentDecorators);var c=d[0];if(typeof(c)==="string"){c={type:c}}if(c.type==="fluid.undoDecorator"){a.set(e.options,["components","undo"],{type:"fluid.undo",options:c.options});e.decorators=[a.initDependent(e,"undo")]}}};a.defaults("fluid.inlineEdit",{gradeNames:["fluid.viewComponent","fluid.undoable","autoInit"],mergePolicy:{"strings.defaultViewText":"defaultViewText"},members:{isEditingState:false,viewEl:{expander:{funcName:"fluid.inlineEdit.setupDisplayText",args:["{that}.dom.text","{that}.options.styles.text"]}},existingPadding:{expander:{funcName:"fluid.inlineEdit.calculateInitialPadding",args:"{that}.viewEl"}},displayModeRenderer:{expander:{func:"{that}.options.displayModeRenderer",args:["{that}","{that}.edit","{that}.model"]}}},invokers:{edit:{funcName:"fluid.inlineEdit.editHandler",args:"{that}"},isEditing:{funcName:"fluid.identity",args:"{that}.isEditingState",dynamic:true},finish:{funcName:"fluid.inlineEdit.finish",args:"{that}"},cancel:{funcName:"fluid.inlineEdit.cancel",args:"{that}"},tooltipEnabled:{funcName:"fluid.inlineEdit.tooltipEnabled",args:"{that}.options.useTooltip"},refreshView:{funcName:"fluid.inlineEdit.refreshView",args:["{that}","{arguments}.0"]},updateModelValue:{funcName:"fluid.inlineEdit.updateModelValue",args:["{that}","{arguments}.0","{arguments}.1"]},updateModel:{funcName:"fluid.inlineEdit.updateModelValue",args:["{that}","{arguments}.0.value","{arguments}.1"]}},components:{displayView:{type:"{that}.options.displayView.type",container:"{that}.viewEl",options:{gradeNames:"{fluid.inlineEdit}.options.displayAccessor.type"}},editView:{type:"{that}.options.editView.type",createOnEvent:"onCreateEditView",container:"{that}.editField",options:{gradeNames:"{fluid.inlineEdit}.options.editAccessor.type"}}},model:{value:{expander:{func:"{that}.displayView.value"}}},selectors:{text:".flc-inlineEdit-text",editContainer:".flc-inlineEdit-editContainer",edit:".flc-inlineEdit-edit",textEditButton:".flc-inlineEdit-textEditButton"},styles:{text:"fl-inlineEdit-text",edit:"fl-inlineEdit-edit",invitation:"fl-inlineEdit-invitation",defaultViewStyle:"fl-inlineEdit-emptyText-invitation",emptyDefaultViewText:"fl-inlineEdit-emptyDefaultViewText",focus:"fl-inlineEdit-focus",tooltip:"fl-inlineEdit-tooltip",editModeInstruction:"fl-inlineEdit-editModeInstruction",displayView:"fl-inlineEdit-simple-editableText fl-inlineEdit-textContainer",textEditButton:"fl-offScreen-hidden"},events:{modelChanged:null,onBeginEdit:"preventable",afterBeginEdit:null,onFinishEdit:"preventable",afterFinishEdit:null,afterInitEdit:null,onCreateEditView:null},listeners:{onCreate:[{func:"{that}.refreshView"},{funcName:"fluid.inlineEdit.initializeEditView",args:["{that}",true]},{funcName:"fluid.inlineEdit.setup",args:"{that}"},{funcName:"fluid.inlineEdit.processUndoDecorator",args:"{that}"}],onBeginEdit:{funcName:"fluid.inlineEdit.setIsEditing",args:["{that}",true]},afterFinishEdit:{funcName:"fluid.inlineEdit.setIsEditing",args:["{that}",false]}},strings:{textEditButton:"Edit text %text",editModeInstruction:"Escape to cancel, Enter or Tab when finished",defaultViewText:"Click here to edit",defaultFocussedViewText:"Click here or press enter to edit"},markup:{editField:"<input type='text' class='flc-inlineEdit-edit'/>",editContainer:"<span></span>",editModeInstruction:"<p></p>",textEditButton:"<a href='#_' class='flc-inlineEdit-textEditButton'></a>"},paddings:{edit:10,minimumEdit:80,minimumView:60},applyEditPadding:true,blurHandlerBinder:null,submitOnEnter:undefined,modelComparator:null,displayAccessor:{type:"fluid.inlineEdit.standardAccessor"},displayView:{type:"fluid.inlineEdit.standardDisplayView"},editAccessor:{type:"fluid.inlineEdit.standardAccessor"},editView:{type:"fluid.inlineEdit.standardEditView"},displayModeRenderer:a.inlineEdit.defaultDisplayModeRenderer,editModeRenderer:a.inlineEdit.defaultEditModeRenderer,lazyEditView:false,useTooltip:true,tooltipText:"Select or press Enter to edit",tooltipDelay:1000,selectOnEdit:false});a.setupInlineEdits=function(c,d){return a.transform(d,function(g,f){var h={type:"fluid.inlineEdit",container:g};var e="inlineEdit-"+f;a.set(c.options,["components",e],h);return a.initDependent(c,e)})};a.defaults("fluid.inlineEdits",{gradeNames:["fluid.viewComponent","autoInit"],distributeOptions:{source:"{that}.options",exclusions:["members.inlineEdits","selectors.editables"],removeSource:true,target:"{that > fluid.inlineEdit}.options"},members:{inlineEdits:{expander:{funcName:"fluid.setupInlineEdits",args:["{that}","{that}.dom.editables"]}}},returnedPath:"inlineEdits",selectors:{editables:".flc-inlineEditable"}})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(c,b){b.defaults("fluid.inlineEdit.editorViewAccessor",{gradeNames:["fluid.viewComponent","autoInit"],invokers:{value:{funcName:"fluid.inlineEdit.editorViewAccessor.value",args:["{that}.container","{that}.options","{arguments}.0"]}}});b.inlineEdit.editorViewAccessor.value=function(f,e,h){var g=e.editorGetFn(f);if(!g||g.length===0){if(h!==undefined){c(f).val(h)}return""}if(h!==undefined){e.setValueFn(f,g,h)}else{return e.getValueFn(g)}};b.defaults("fluid.inlineEdit.richTextViewAccessor",{gradeNames:["fluid.viewComponent","autoInit"],invokers:{value:{funcName:"fluid.inlineEdit.richTextViewAccessor.value",args:["{that}.container","{arguments}.0"]}}});b.inlineEdit.richTextViewAccessor.value=function(e,f){return b.html(e,f)};b.inlineEdit.normalizeHTML=function(f){var e=c.trim(f.replace(/\s+/g," "));e=e.replace(/\s+<\//g,"</");e=e.replace(/<([a-z0-9A-Z\/]+)>/g,function(g){return g.toLowerCase()});return e};b.inlineEdit.htmlComparator=function(f,e){return b.inlineEdit.normalizeHTML(f)===b.inlineEdit.normalizeHTML(e)};b.inlineEdit.bindRichTextHighlightHandler=function(f,i,g){f=c(f);var h=function(){i.addClass(g)};var e=function(){i.removeClass(g)};f.focus(h);f.blur(e)};b.inlineEdit.setupRichTextEditButton=function(h){var g=h.options;var e=h.locate("textEditButton");if(e.length===0){var f=c("<a href='#_' class='flc-inlineEdit-textEditButton'></a>");f.text(g.strings.textEditButton);h.locate("text").after(f);e=h.locate("textEditButton")}return e};b.inlineEdit.richTextDisplayModeRenderer=function(g,f){var e=g.options.styles;var h=b.inlineEdit.setupDisplayModeContainer(e);var i=g.viewEl.wrap(h).parent();g.textEditButton=b.inlineEdit.setupRichTextEditButton(g);i.append(g.textEditButton);i.addClass(e.focus);b.inlineEdit.bindHoverHandlers(i,e.invitation);b.inlineEdit.bindMouseHandlers(g.textEditButton,f);b.inlineEdit.bindKeyboardHandlers(g.textEditButton,f);b.inlineEdit.bindRichTextHighlightHandler(g.viewEl,i,e.invitation);b.inlineEdit.bindRichTextHighlightHandler(g.textEditButton,i,e.invitation);return i};var d=b.registerNamespace("fluid.inlineEdit.tinyMCE");b.inlineEdit.tinyMCE.getEditor=function(e){return tinyMCE.get(e.prop("id"))};b.inlineEdit.tinyMCE.setValue=function(e,f,g){c(e).val(g);f.setContent(g,{format:"raw"})};b.inlineEdit.tinyMCE.getValue=function(e){return e.getContent()};b.defaults("fluid.inlineEdit.tinyMCE.viewAccessor",{gradeNames:["fluid.inlineEdit.editorViewAccessor","autoInit"],editorGetFn:d.getEditor,setValueFn:d.setValue,getValueFn:d.getValue});b.inlineEdit.tinyMCE.blurHandlerBinder=function(e){function f(g){setTimeout(function(){tinyMCE.execCommand("mceFocus",false,e.editField[0].id);g.selection.select(g.getBody(),1);g.selection.collapse(0)},10)}e.events.afterInitEdit.addListener(function(g){f(g);var h=g.getBody();e.deadMansBlur=b.deadMansBlur(e.editField,{cancelByDefault:true,exclusions:{body:c(h),container:e.container},handler:function(){e[e.options.onBlur]()}});g.controlManager.onAdd.add(function(i){if(i.onShowMenu){i.onShowMenu.add(function(){var j=b.byId(i.element.id);if(j){e.deadMansBlur.addExclusion({id:j})}})}})});e.events.afterBeginEdit.addListener(function(){var g=tinyMCE.get(e.editField[0].id);if(g){f(g)}if(e.deadMansBlur){e.deadMansBlur.reArm()}});e.events.afterFinishEdit.addListener(function(){e.deadMansBlur.noteProceeded()})};b.inlineEdit.tinyMCE.editModeRenderer=function(g){var f=g.options.tinyMCE;f.elements=b.allocateSimpleId(g.editField);var e=f.init_instance_callback;f.init_instance_callback=function(h){g.events.afterInitEdit.fire(h);if(e){e()}};setTimeout(function(){tinyMCE.init(f)},1)};b.defaults("fluid.inlineEdit.tinyMCE",{gradeNames:["fluid.inlineEdit","autoInit"],tinyMCE:{mode:"exact",theme:"simple"},listeners:{onCreate:{"this":"tinyMCE",method:"init",namespace:"initTinyMCE",args:"{that}.options.tinyMCE"}},useTooltip:true,selectors:{edit:"textarea"},styles:{invitation:"fl-inlineEdit-richText-invitation",displayView:"fl-inlineEdit-textContainer",text:""},strings:{textEditButton:"Edit"},displayAccessor:{type:"fluid.inlineEdit.richTextViewAccessor"},editAccessor:{type:"fluid.inlineEdit.tinyMCE.viewAccessor"},lazyEditView:true,defaultViewText:"Click Edit",modelComparator:b.inlineEdit.htmlComparator,onBlur:"finish",blurHandlerBinder:b.inlineEdit.tinyMCE.blurHandlerBinder,displayModeRenderer:b.inlineEdit.richTextDisplayModeRenderer,editModeRenderer:b.inlineEdit.tinyMCE.editModeRenderer});var a=b.registerNamespace("fluid.inlineEdit.CKEditor");b.inlineEdit.CKEditor.getEditor=function(e){return CKEDITOR.instances[e.prop("id")]};b.inlineEdit.CKEditor.setValue=function(e,f,g){f.setData(g)};b.inlineEdit.CKEditor.getValue=function(e){return e.getData()};b.defaults("fluid.inlineEdit.CKEditor.viewAccessor",{gradeNames:["fluid.inlineEdit.editorViewAccessor","autoInit"],editorGetFn:a.getEditor,setValueFn:a.setValue,getValueFn:a.getValue});b.inlineEdit.CKEditor.focus=function(e){setTimeout(function(){e.focus()},0)};b.inlineEdit.CKEditor.normalizeHTML=function(g){var f=b.inlineEdit.normalizeHTML(g);var e=f.indexOf(">");if(e!==-1&&e<f.length-1){if(f.charAt(e+1)!==" "){f=f.substring(0,e+1)+" "+f.substring(e+1)}}return f};b.inlineEdit.CKEditor.htmlComparator=function(f,e){return b.inlineEdit.CKEditor.normalizeHTML(f)===b.inlineEdit.CKEditor.normalizeHTML(e)
};b.inlineEdit.CKEditor.blurHandlerBinder=function(e){e.events.afterInitEdit.addListener(b.inlineEdit.CKEditor.focus);e.events.afterBeginEdit.addListener(function(){var f=b.inlineEdit.CKEditor.getEditor(e.editField);if(f){b.inlineEdit.CKEditor.focus(f)}})};b.inlineEdit.CKEditor.editModeRenderer=function(f){var g=b.allocateSimpleId(f.editField);c.data(b.unwrap(f.editField),"fluid.inlineEdit.CKEditor",f);var e=CKEDITOR.replace(g,f.options.CKEditor);e.on("instanceReady",function(h){b.inlineEdit.CKEditor.focus(h.editor);f.events.afterInitEdit.fire(h.editor)})};b.defaults("fluid.inlineEdit.CKEditor",{gradeNames:["fluid.inlineEdit","autoInit"],selectors:{edit:"textarea"},styles:{invitation:"fl-inlineEdit-richText-invitation",displayView:"fl-inlineEdit-textContainer",text:""},strings:{textEditButton:"Edit"},displayAccessor:{type:"fluid.inlineEdit.richTextViewAccessor"},editAccessor:{type:"fluid.inlineEdit.CKEditor.viewAccessor"},lazyEditView:true,defaultViewText:"Click Edit",modelComparator:b.inlineEdit.CKEditor.htmlComparator,blurHandlerBinder:b.inlineEdit.CKEditor.blurHandlerBinder,displayModeRenderer:b.inlineEdit.richTextDisplayModeRenderer,editModeRenderer:b.inlineEdit.CKEditor.editModeRenderer,CKEditor:{}});b.registerNamespace("fluid.inlineEdit.dropdown");b.inlineEdit.dropdown.editModeRenderer=function(e){b.allocateSimpleId(e.editField);e.editField.selectbox({finishHandler:function(){e.finish()}});return{container:e.editContainer,field:c("input.selectbox",e.editContainer)}};b.inlineEdit.dropdown.blurHandlerBinder=function(e){b.deadMansBlur(e.editField,{exclusions:{selectBox:c("div.selectbox-wrapper",e.editContainer)},handler:function(){e.cancel()}})};b.defaults("fluid.inlineEdit.dropdown",{gradeNames:["fluid.inlineEdit","autoInit"],applyEditPadding:false,blurHandlerBinder:b.inlineEdit.dropdown.blurHandlerBinder,editModeRenderer:b.inlineEdit.dropdown.editModeRenderer})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.XMLP=function(c){return a.XMLP.XMLPImpl(c)};a.XMLP.closedTags={abbr:true,br:true,col:true,img:true,input:true,link:true,meta:true,param:true,hr:true,area:true,embed:true};a.XMLP._NONE=0;a.XMLP._ELM_B=1;a.XMLP._ELM_E=2;a.XMLP._ELM_EMP=3;a.XMLP._ATT=4;a.XMLP._TEXT=5;a.XMLP._ENTITY=6;a.XMLP._PI=7;a.XMLP._CDATA=8;a.XMLP._COMMENT=9;a.XMLP._DTD=10;a.XMLP._ERROR=11;a.XMLP._CONT_XML=0;a.XMLP._CONT_ALT=1;a.XMLP._ATT_NAME=0;a.XMLP._ATT_VAL=1;a.XMLP._STATE_PROLOG=1;a.XMLP._STATE_DOCUMENT=2;a.XMLP._STATE_MISC=3;a.XMLP._errs=[];a.XMLP._errs[a.XMLP.ERR_CLOSE_PI=0]="PI: missing closing sequence";a.XMLP._errs[a.XMLP.ERR_CLOSE_DTD=1]="DTD: missing closing sequence";a.XMLP._errs[a.XMLP.ERR_CLOSE_COMMENT=2]="Comment: missing closing sequence";a.XMLP._errs[a.XMLP.ERR_CLOSE_CDATA=3]="CDATA: missing closing sequence";a.XMLP._errs[a.XMLP.ERR_CLOSE_ELM=4]="Element: missing closing sequence";a.XMLP._errs[a.XMLP.ERR_CLOSE_ENTITY=5]="Entity: missing closing sequence";a.XMLP._errs[a.XMLP.ERR_PI_TARGET=6]="PI: target is required";a.XMLP._errs[a.XMLP.ERR_ELM_EMPTY=7]="Element: cannot be both empty and closing";a.XMLP._errs[a.XMLP.ERR_ELM_NAME=8]='Element: name must immediately follow "<"';a.XMLP._errs[a.XMLP.ERR_ELM_LT_NAME=9]='Element: "<" not allowed in element names';a.XMLP._errs[a.XMLP.ERR_ATT_VALUES=10]="Attribute: values are required and must be in quotes";a.XMLP._errs[a.XMLP.ERR_ATT_LT_NAME=11]='Element: "<" not allowed in attribute names';a.XMLP._errs[a.XMLP.ERR_ATT_LT_VALUE=12]='Attribute: "<" not allowed in attribute values';a.XMLP._errs[a.XMLP.ERR_ATT_DUP=13]="Attribute: duplicate attributes not allowed";a.XMLP._errs[a.XMLP.ERR_ENTITY_UNKNOWN=14]="Entity: unknown entity";a.XMLP._errs[a.XMLP.ERR_INFINITELOOP=15]="Infinite loop";a.XMLP._errs[a.XMLP.ERR_DOC_STRUCTURE=16]="Document: only comments, processing instructions, or whitespace allowed outside of document element";a.XMLP._errs[a.XMLP.ERR_ELM_NESTING=17]="Element: must be nested correctly";a.XMLP._checkStructure=function(e,f){var c=e.m_stack;if(a.XMLP._STATE_PROLOG==e.m_iState){e.m_iState=a.XMLP._STATE_DOCUMENT}if(a.XMLP._STATE_DOCUMENT===e.m_iState){if((a.XMLP._ELM_B==f)||(a.XMLP._ELM_EMP==f)){e.m_stack[c.length]=e.getName()}if((a.XMLP._ELM_E==f)||(a.XMLP._ELM_EMP==f)){if(c.length===0){return a.XMLP._NONE}var d=c[c.length-1];e.m_stack.length--;if(d===null||d!==e.getName()){return a.XMLP._setErr(e,a.XMLP.ERR_ELM_NESTING)}}}return f};a.XMLP._parseCDATA=function(d,c){var e=d.m_xml.indexOf("]]>",c);if(e==-1){return a.XMLP._setErr(d,a.XMLP.ERR_CLOSE_CDATA)}a.XMLP._setContent(d,a.XMLP._CONT_XML,c,e);d.m_iP=e+3;return a.XMLP._CDATA};a.XMLP._parseComment=function(d,c){var e=d.m_xml.indexOf("-->",c);if(e==-1){return a.XMLP._setErr(d,a.XMLP.ERR_CLOSE_COMMENT)}a.XMLP._setContent(d,a.XMLP._CONT_XML,c-4,e+3);d.m_iP=e+3;return a.XMLP._COMMENT};a.XMLP._parseDTD=function(g,d){var h,c,e,f;h=g.m_xml.indexOf(">",d);if(h==-1){return a.XMLP._setErr(g,a.XMLP.ERR_CLOSE_DTD)}e=g.m_xml.indexOf("[",d);c=((e!=-1)&&(e<h))?"]>":">";while(true){if(h==f){return a.XMLP._setErr(g,a.XMLP.ERR_INFINITELOOP)}f=h;h=g.m_xml.indexOf(c,d);if(h==-1){return a.XMLP._setErr(g,a.XMLP.ERR_CLOSE_DTD)}if(g.m_xml.substring(h-1,h+2)!="]]>"){break}}g.m_iP=h+c.length;return a.XMLP._DTD};a.XMLP._parsePI=function(e,d){var h,c,g,i,f;h=e.m_xml.indexOf("?>",d);if(h==-1){return a.XMLP._setErr(e,a.XMLP.ERR_CLOSE_PI)}c=a.SAXStrings.indexOfNonWhitespace(e.m_xml,d,h);if(c==-1){return a.XMLP._setErr(e,a.XMLP.ERR_PI_TARGET)}g=a.SAXStrings.indexOfWhitespace(e.m_xml,c,h);if(g==-1){g=h}i=a.SAXStrings.indexOfNonWhitespace(e.m_xml,g,h);if(i==-1){i=h}f=a.SAXStrings.lastIndexOfNonWhitespace(e.m_xml,i,h);if(f==-1){f=h-1}e.m_name=e.m_xml.substring(c,g);a.XMLP._setContent(e,a.XMLP._CONT_XML,i,f+1);e.m_iP=h+2;return a.XMLP._PI};a.XMLP._parseText=function(d,c){var e=d.m_xml.indexOf("<",c);if(e==-1){e=d.m_xml.length}a.XMLP._setContent(d,a.XMLP._CONT_XML,c,e);d.m_iP=e;return a.XMLP._TEXT};a.XMLP._setContent=function(d,e){var c=arguments;if(a.XMLP._CONT_XML==e){d.m_cAlt=null;d.m_cB=c[2];d.m_cE=c[3]}else{d.m_cAlt=c[2];d.m_cB=0;d.m_cE=c[2].length}d.m_cSrc=e};a.XMLP._setErr=function(e,d){var c=a.XMLP._errs[d];e.m_cAlt=c;e.m_cB=0;e.m_cE=c.length;e.m_cSrc=a.XMLP._CONT_ALT;return a.XMLP._ERROR};a.XMLP._parseElement=function(o,p){var l,f,i;var q,g,c;f=l=o.m_xml.indexOf(">",p);if(l==-1){return a.XMLP._setErr(o,a.XMLP.ERR_CLOSE_ELM)}if(o.m_xml.charAt(p)=="/"){q=a.XMLP._ELM_E;p++}else{q=a.XMLP._ELM_B}if(o.m_xml.charAt(l-1)=="/"){if(q==a.XMLP._ELM_E){return a.XMLP._setErr(o,a.XMLP.ERR_ELM_EMPTY)}q=a.XMLP._ELM_EMP;f--}o.nameRegex.lastIndex=p;var m=o.nameRegex.exec(o.m_xml);if(!m){return a.XMLP._setErr(o,a.XMLP.ERR_ELM_NAME)}g=m[1].toLowerCase();if("li"===g&&q!==a.XMLP._ELM_E&&o.m_stack.length>0&&o.m_stack[o.m_stack.length-1]==="li"&&!o.m_emitSynthetic){o.m_name="li";o.m_emitSynthetic=true;return a.XMLP._ELM_E}o.m_attributes={};o.m_cAlt="";if(o.nameRegex.lastIndex<f){o.m_iP=o.nameRegex.lastIndex;while(o.m_iP<f){o.attrStartRegex.lastIndex=o.m_iP;var e=o.attrStartRegex.exec(o.m_xml);if(!e){return a.XMLP._setErr(o,a.XMLP.ERR_ATT_VALUES)}var j=e[1].toLowerCase();var n;if(o.m_xml.charCodeAt(o.attrStartRegex.lastIndex)===61){var d=o.m_xml.charCodeAt(o.attrStartRegex.lastIndex+1)===34?o.attrValRegex:o.attrValIERegex;d.lastIndex=o.attrStartRegex.lastIndex+1;e=d.exec(o.m_xml);if(!e){return a.XMLP._setErr(o,a.XMLP.ERR_ATT_VALUES)}n=e[1]}else{n=j;d=o.attrStartRegex}if(!o.m_attributes[j]||o.m_attributes[j]===n){o.m_attributes[j]=n}else{return a.XMLP._setErr(o,a.XMLP.ERR_ATT_DUP)}o.m_iP=d.lastIndex}}if(g.indexOf("<")!=-1){return a.XMLP._setErr(o,a.XMLP.ERR_ELM_LT_NAME)}o.m_name=g;o.m_iP=l+1;if(a.XMLP.closedTags[g]){o.closeRegex.lastIndex=l+1;var h=o.closeRegex.exec;if(h){var k=o.m_xml.indexOf(g,h.lastIndex);if(k===h.lastIndex){return q}else{return a.XMLP._ELM_EMP}}}o.m_emitSynthetic=false;return q};a.XMLP._parse=function(f){var g=f.m_iP;var d=f.m_xml;if(g===d.length){return a.XMLP._NONE}var h=d.charAt(g);if(h==="<"){var e=d.charAt(g+1);if(e==="?"){return a.XMLP._parsePI(f,g+2)}else{if(e==="!"){if(g===d.indexOf("<!DOCTYPE",g)){return a.XMLP._parseDTD(f,g+9)}else{if(g===d.indexOf("<!--",g)){return a.XMLP._parseComment(f,g+4)}else{if(g===d.indexOf("<![CDATA[",g)){return a.XMLP._parseCDATA(f,g+9)}}}}else{return a.XMLP._parseElement(f,g+1)}}}else{return a.XMLP._parseText(f,g)}};a.XMLP.XMLPImpl=function(d){var c={};c.m_xml=d;c.m_iP=0;c.m_iState=a.XMLP._STATE_PROLOG;c.m_stack=[];c.m_attributes={};c.m_emitSynthetic=false;c.getColumnNumber=function(){return a.SAXStrings.getColumnNumber(c.m_xml,c.m_iP)};c.getContent=function(){return(c.m_cSrc==a.XMLP._CONT_XML)?c.m_xml:c.m_cAlt};c.getContentBegin=function(){return c.m_cB};c.getContentEnd=function(){return c.m_cE};c.getLineNumber=function(){return a.SAXStrings.getLineNumber(c.m_xml,c.m_iP)};c.getName=function(){return c.m_name};c.next=function(){return a.XMLP._checkStructure(c,a.XMLP._parse(c))};c.nameRegex=/([^\s\/>]+)/g;c.attrStartRegex=/\s*([\w:_][\w:_\-\.]*)/gm;c.attrValRegex=/\"([^\"]*)\"\s*/gm;c.attrValIERegex=/([^\>\s]+)\s*/gm;c.closeRegex=/\s*<\//g;return c};a.SAXStrings={};a.SAXStrings.WHITESPACE=" \t\n\r";a.SAXStrings.QUOTES="\"'";a.SAXStrings.getColumnNumber=function(f,e){if(!f){return -1}e=e||f.length;var c=f.substring(0,e).split("\n");c.length--;var d=c.join("\n").length;return e-d};a.SAXStrings.getLineNumber=function(d,c){if(!d){return -1}c=c||d.length;return d.substring(0,c).split("\n").length};a.SAXStrings.indexOfNonWhitespace=function(h,d,f){if(!h){return -1}d=d||0;f=f||h.length;for(var e=d;e<f;++e){var g=h.charAt(e);if(g!==" "&&g!=="\t"&&g!=="\n"&&g!=="\r"){return e}}return -1};a.SAXStrings.indexOfWhitespace=function(f,c,e){if(!f){return -1}c=c||0;e=e||f.length;for(var d=c;d<e;d++){if(a.SAXStrings.WHITESPACE.indexOf(f.charAt(d))!=-1){return d}}return -1};a.SAXStrings.lastIndexOfNonWhitespace=function(f,c,e){if(!f){return -1}c=c||0;e=e||f.length;for(var d=e-1;d>=c;d--){if(a.SAXStrings.WHITESPACE.indexOf(f.charAt(d))==-1){return d}}return -1};a.SAXStrings.replace=function(g,c,f,e,d){if(!g){return""
}c=c||0;f=f||g.length;return g.substring(c,f).split(e).join(d)}})(jQuery,fluid_1_5);fluid_1_5=fluid_1_5||{};(function(b,a){a.parseTemplate=function(h,I,e,c,y){y=y||{};if(!h){a.fail("empty template supplied to fluid.parseTemplate")}var E;var z;var M;var H=0;var x=0;var p=false;var j=-1;var i=-1;var N=false;var o=[];var f={};var m=[];var g=function(O,t){return{nestingdepth:t,lumpindex:O,parent:E}};function B(t){return t.length===1&&t[0].predList.length===1&&t[0].predList[0].clazz}function J(S,O,R){E.rootlump=g(0,-1);M=[E.rootlump];H=0;x=0;p=false;j=-1;i=-1;I=S;N=O;if(R){for(var Q=0;Q<R.length;++Q){var t=a.parseSelector(R[Q].selector,a.simpleCSSMatcher);var P=B(t);if(P){f[P]=R[Q].id}else{m.push([]);o.push(b.extend({},R[Q],{tree:t}))}}}}function A(){for(var t=M.length-1;t>=0;--t){var O=M[t];if(O.rsfID!==undefined){return O}}return E.rootlump}function D(){var t=g(H,x);if(N){t.line=z.getLineNumber();t.column=z.getColumnNumber()}E.lumps[H]=t;++H;return t}function q(O,t,P){var Q=O[t];if(!Q){Q=[];O[t]=Q}Q[Q.length]=P}function l(t,O){if(t.indexOf("scr=contribute-")!==-1){var P=t.substring("scr=contribute-".length);q(E.collectmap,P,O)}}function G(t){return"<"+t.tagname+">"}function v(O,t){if(!t){return false}return(" "+t+" ").indexOf(" "+O+" ")!==-1}function u(Q,R,O){if(Q.predList){for(var P=0;P<Q.predList.length;++P){var t=Q.predList[P];if(t.id&&R.attributemap.id!==t.id){return false}if(t.clazz&&!v(t.clazz,O)){return false}if(t.tag&&R.tagname!==t.tag){return false}}return true}}function F(U){var O;var S=U.attributemap["class"];var R;if(S){var V=S.split(" ");for(R=0;R<V.length;++R){var T=f[b.trim(V[R])];if(T){return T}}}for(R=0;R<o.length;++R){var W=o[R];var X=m[R];var t=X.length;if(t<W.tree.length){var P=W.tree[t];if(t>0){if(W.tree[t-1].child&&X[t-1]!==U.nestingdepth-1){continue}}var Q=u(P,U,S);if(Q){X[X.length]=U.nestingdepth;if(X.length===W.tree.length){if(O!==undefined){a.fail("Cutpoint specification error - node "+G(U)+" has already matched with rsf:id of "+O)}if(W.id===undefined||W.id===null){a.fail("Error in cutpoints list - entry at position "+R+" does not have an id set")}O=W.id}}}}return O}function C(){if(o){for(var t=0;t<o.length;++t){var O=m[t];if(O.length>0&&O[O.length-1]===x){O.length--}}}}function r(){C();var t=D();--x;t.text="</"+z.getName()+">";var O=M[M.length-1];O.close_tag=E.lumps[H-1];M.length--;p=true}function d(U){++x;if(p){p=false;var R=D();R.nestingdepth--}if(E.firstdocumentindex===-1){E.firstdocumentindex=H}var T=D();var t=M[M.length-1];T.uplump=t;var W=z.getName();T.tagname=W;var X=T.attributemap=z.m_attributes;var V=X[a.ID_ATTRIBUTE];if(V===undefined){V=F(T)}for(var Q in X){if(V===undefined){if(/href|src|codebase|action/.test(Q)){V="scr=rewrite-url"}else{if(V===undefined&&/for|headers/.test(Q)){V="scr=null"}}}}if(V){if(V.charCodeAt(0)===126){V=V.substring(1);T.elide=true}l(V,T);T.rsfID=V;var P=A();if(!P.downmap){P.downmap={}}while(P){if(P.downmap){q(P.downmap,V,T)}P=P.uplump}q(E.globalmap,V,T);var O=V.indexOf(":");if(O!==-1){var S=V.substring(0,O);if(!t.finallump){t.finallump={}}t.finallump[S]=T}}T.text="<"+W+a.dumpAttributes(X)+(U&&!V?"/>":">");M[M.length]=T;if(U){if(V){r()}else{--x;M.length--}}}function n(){if(j!==-1){if(E.firstdocumentindex===-1){E.firstdocumentindex=H}var O=z.getContent().substr(j,i-j);p=false;var t=D();t.text=O;j=-1}}E=a.XMLViewTemplate();J(I,y.debugMode,c);var K=h.indexOf(a.ID_ATTRIBUTE);if(e){var s=h.indexOf(">",K);z=a.XMLP(h.substring(s+1))}else{z=a.XMLP(h)}parseloop:while(true){var L=z.next();switch(L){case a.XMLP._ELM_B:n();d(false,"");break;case a.XMLP._ELM_E:n();r();break;case a.XMLP._ELM_EMP:n();d(true,"");break;case a.XMLP._PI:case a.XMLP._DTD:j=-1;continue;case a.XMLP._TEXT:case a.XMLP._ENTITY:case a.XMLP._CDATA:case a.XMLP._COMMENT:if(j===-1){j=z.m_cB}i=z.m_cE;break;case a.XMLP._ERROR:a.setLogging(true);var k="Error parsing template: "+z.m_cAlt+" at line "+z.getLineNumber();a.log(k);a.log("Just read: "+z.m_xml.substring(z.m_iP-30,z.m_iP));a.log("Still to read: "+z.m_xml.substring(z.m_iP,z.m_iP+30));a.fail(k);break parseloop;case a.XMLP._NONE:break parseloop}}n();var w=M.length-1;if(w){a.fail("Error parsing template - unclosed tag(s) of depth "+(w)+": "+a.transform(M.splice(1,w),function(t){return G(t)}).join(", "))}return E};a.debugLump=function(d){var c=d.text;c+=" at ";c+="lump line "+d.line+" column "+d.column+" index "+d.lumpindex;c+=d.parent.href===null?"":" in file "+d.parent.href;return c};a.ID_ATTRIBUTE="rsf:id";a.getPrefix=function(d){var c=d.indexOf(":");return c===-1?d:d.substring(0,c)};a.SplitID=function(e){var d={};var c=e.indexOf(":");if(c===-1){d.prefix=e}else{d.prefix=e.substring(0,c);d.suffix=e.substring(c+1)}return d};a.XMLViewTemplate=function(){return{globalmap:{},collectmap:{},lumps:[],firstdocumentindex:-1}};a.XMLEncode=function(c){return c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;")};a.dumpAttributes=function(c){var e="";for(var f in c){var d=c[f];if(d!==null&&d!==undefined){e+=" "+f+'="'+d+'"'}}return e};a.aggregateMMap=function(f,e){for(var c in e){var d=f[c];if(!d){f[c]=[]}f[c]=f[c].concat(e[c])}};a.parseTemplates=function(g,j,c){var e=[];c=c||{};e.globalmap={};for(var h=0;h<j.length;++h){var f=g[j[h]];var k=f.href.lastIndexOf("/");var d=k===-1?"":f.href.substring(0,k+1);var l=a.parseTemplate(f.resourceText,d,c.scanStart&&h===0,f.cutpoints,c);if(h===0){a.aggregateMMap(e.globalmap,l.globalmap)}l.href=f.href;l.baseURL=d;l.resourceKey=f.resourceKey;e[h]=l;a.aggregateMMap(e.globalmap,l.rootlump.downmap)}return e}})(jQuery,fluid_1_5);fluid_1_5=fluid_1_5||{};(function(h,j){function n(o){return"as child of "+(o.parent.fullID?"component with full ID "+o.parent.fullID:"root")}function i(r){var t="";var p=r;if(r.children===undefined){t=r.ID+(r.localID!==undefined?r.localID:"");p=r.parent}while(p.parent){var s=p.parent;if(p.fullID!==undefined){t=p.fullID+t;return t}if(p.noID===undefined){var o=p.ID;if(o===undefined){j.fail("Error in component tree - component found with no ID "+n(s)+": please check structure")}var q=o.indexOf(":");var u=q===-1?o:o.substring(0,q);t=u+":"+(p.localID===undefined?"":p.localID)+":"+t}p=s}return t}var k={};k.isBoundPrimitive=function(o){return j.isPrimitive(o)||j.isArrayable(o)&&(o.length===0||typeof(o[0])==="string")};var g;function c(q,p){if(k.isBoundPrimitive(q)){return{componentType:"UIBound",value:q,ID:p}}else{var o=g(q);if(o.ID){return{ID:p,componentType:"UIContainer",children:[o]}}else{o.ID=p;return o}}}function f(q){if(!j.isArrayable(q)){var r=[];for(var p in q){var s=q[p];if(j.isArrayable(s)){for(var o=0;o<s.length;++o){var t=c(s[o],p);r[r.length]=t}}else{r[r.length]=c(s,p)}}return r}else{return q}}function d(o,q,p){if(o.value===undefined&&o.valuebinding!==undefined){if(!q){j.fail("Cannot perform value fixup for valuebinding "+o.valuebinding+" since no model was supplied to rendering")}o.value=j.get(q,o.valuebinding,p)}}function m(q,r,p,o){if(q[r]!==undefined){if(k.isBoundPrimitive(q[r])){q[r]={value:q[r]}}else{if(q[r].messagekey){q[r].componentType="UIMessage"}}}else{q[r]={value:null}}d(q[r],p,o)}k.duckMap={children:"UIContainer",value:"UIBound",valuebinding:"UIBound",messagekey:"UIMessage",markup:"UIVerbatim",selection:"UISelect",target:"UILink",choiceindex:"UISelectChoice",functionname:"UIInitBlock"};var b={UISelect:["selection","optionlist","optionnames"],UILink:["target","linktext"],UIVerbatim:["markup"],UIMessage:["messagekey"]};k.boundMap=j.transform(b,j.arrayToHash);k.inferComponentType=function(o){for(var p in k.duckMap){if(o[p]!==undefined){return k.duckMap[p]}}};k.applyComponentType=function(o){o.componentType=k.inferComponentType(o);if(o.componentType===undefined&&o.ID!==undefined){o.componentType="UIBound"}};g=function(s,r,q){if(s){k.applyComponentType(s)}if(!s||s.componentType===undefined){var p=s.decorators;if(p){delete s.decorators}s={componentType:"UIContainer",children:s};s.decorators=p}var o=s.componentType;if(o==="UIContainer"){s.children=f(s.children)}else{var t=k.boundMap[o];if(t){j.each(t,function(v,u){m(s,u,r,q)})}}return s};function l(z,w,q){if(z.componentType===undefined){z=g(z,w,q)}if(z.componentType!=="UIContainer"&&!z.parent){z={children:[z]}}if(z.children){z.childmap={};for(var v=0;v<z.children.length;++v){var p=z.children[v];if(p.componentType===undefined){p=g(p,w,q);z.children[v]=p}p.parent=z;if(p.ID===undefined){j.fail("Error in component tree: component found with no ID "+n(p))}z.childmap[p.ID]=p;var s=p.ID.indexOf(":");if(s===-1){}else{var x=p.ID.substring(0,s);var o=z.childmap[x];if(!o){o=[];z.childmap[x]=o}if(p.localID===undefined&&o.length!==0){p.localID=o.length}o[o.length]=p}p.fullID=i(p);var r=p.componentType;if(r==="UISelect"){p.selection.fullID=p.fullID}else{if(r==="UIInitBlock"){var y=p.functionname+"(";var u=p["arguments"];for(var t=0;t<u.length;++t){if(u[t] instanceof j.ComponentReference){u[t]=p.parent.fullID+u[t].reference}y+=JSON.stringify(u[t]);if(t<u.length-1){y+=", "}}p.markup={value:y+")\n"};p.componentType="UIVerbatim"}else{if(r==="UIBound"){d(p,w,q)}}}l(p,w,q)}}return z}j.NULL_STRING="\u25a9null\u25a9";var e={a:"href",link:"href",img:"src",frame:"src",script:"src",style:"src",input:"src",embed:"src",form:"action",applet:"codebase",object:"codebase"};k.decoratorComponentPrefix="**-renderer-";k.IDtoComponentName=function(o,p){return k.decoratorComponentPrefix+o.replace(/\./g,"")+"-"+p};k.invokeFluidDecorator=function(v,s,o,r,q){var u;if(q.parentComponent){var t=q.parentComponent;var p=k.IDtoComponentName(o,r);j.set(t,j.path("options","components",p),{type:v});u=j.initDependent(q.parentComponent,p,s)}else{u=j.invokeGlobalFunction(v,s)}return u};j.renderer=function(q,O,Y,s){Y=Y||{};O=O||{};var aD=Y.debugMode;if(!Y.messageLocator&&Y.messageSource){Y.messageLocator=j.resolveMessageSource(Y.messageSource)}Y.document=Y.document||document;Y.jQuery=Y.jQuery||h;Y.fossils=Y.fossils||s||{};var ac={};var au={};var an={};var P={};var Q={};var am="";var Z=Y;var aj=[];var H={};var A={};var ak={options:Y};function aA(aF,aE,aG){return aF.resourceKey+aE.fullID+aG
}function N(aJ,aE,aG){var aK;var aI=aG?aG[aJ]:null;if(aI){for(var aF=0;aF<aI.length;++aF){var aH=aI[aF];if(!aK&&aH.rsfID===aE){aK=aH}if(aH.rsfID===aJ){return aH}}}return aK}function aw(aH,aJ){var aI=aJ.jointID?aJ.jointID:aJ.ID;var aG=j.SplitID(aI);var aE=aG.prefix+":";var aF=N(aI,aE,aH.downmap,aJ);if(aF){return aF}if(aJ.children){aF=N(aI,aE,ac,aJ);if(aF){return aF}}return null}function L(aE){if(!P[aE.href]){j.aggregateMMap(Q,aE.collectmap);P[aE.href]=true}}var ar;function S(aJ,aG){var aH;var aE;var aM;for(aH=0;aH<aJ.children.length;++aH){var aK=aJ.children[aH];if(aK.children){aM=aw(aG,aK);if(aM){au[aK.fullID]=aM;aE=aM.attributemap.id;if(aE!==undefined){an[aA(aG.parent,aJ,aE)]=aK.fullID}L(aM.parent);S(aK,aM)}}}if(aG.downmap){for(aE in aG.downmap){var aL=aG.downmap[aE];for(aH=0;aH<aL.length;++aH){var aI=aL[aH];var aN=aI.attributemap.id;if(aN!==undefined&&aI.rsfID!==undefined){aM=ar(aJ,aI.rsfID);if(aM!==null){var aF=aM.fullID;an[aA(aG.parent,aJ,aN)]=aF}}}}}}function M(aG,aF,aE){au={};an={};P={};Q={};ac=aG;au[aF.fullID]=aE;S(aF,aE)}function E(aF,aH,aE){for(;aH<aE;++aH){var aG=aF[aH].text;if(aG){am+=aF[aH].text}}}function ab(aG,aJ,aE,aI,aF){var aK=aJ;while(true){if(aJ===aG.length){break}var aH=aG[aJ];if(aH.nestingdepth<aE){break}if(aH.rsfID!==undefined){if(!aF){break}if(aF&&aH.nestingdepth>aE+(aI?0:1)){j.log("Error in component tree - leaf component found to contain further components - at "+aH.toString())}else{break}}++aJ}if(!aI&&(aJ===aG.length||!aG[aJ].rsfID)){--aJ}E(aG,aK,aJ);return aJ}function v(){return false}function w(aE){return aE!==null&&aE!==undefined&&!v(aE)}var J={};function x(){if(!J.iselide){am+="<"+J.uselump.tagname}}function av(){if(!J.iselide){am+="</"+J.uselump.tagname+">"}}function ae(){E(J.uselump.parent.lumps,J.uselump.lumpindex+1,J.close.lumpindex+(J.iselide?0:1))}function T(){return J.endopen.lumpindex===J.close.lumpindex&&j.XMLP.closedTags[J.uselump.tagname]}function ai(){if(T()){if(!J.iselide){am+="/>"}}else{if(!J.iselide){am+=">"}E(J.uselump.parent.lumps,J.endopen.lumpindex,J.close.lumpindex+(J.iselide?0:1))}}function al(){if(!J.iselide){am+=j.dumpAttributes(J.attrcopy)}ai()}function aq(){if(J.iselide){al()}else{am+=j.dumpAttributes(J.attrcopy);var aE=T();am+=aE?"/>":">";J.nextpos=aE?J.close.lumpindex+1:J.endopen.lumpindex}}function aB(aE){am+=j.dumpAttributes(J.attrcopy);if(!J.iselide){am+=">"}am+=j.XMLEncode(aE.toString());av()}function ag(aE){if(w(aE)){aB(aE)}else{al()}}function az(aE){if(J.iselide){ag(J.value)}else{if(w(aE)){aB(aE)}else{aq()}}}function o(aG,aE){if(Z.urlRewriter){var aH=Z.urlRewriter(aE);if(aH){return aH}}if(!Z.rebaseURLs){return aE}var aF=aE.indexOf(":/");if(aE.charAt(0)==="/"||aF!==-1&&aF<7){return aE}else{return Z.baseURL+aE}}function ay(aG){am+='<input type="hidden" ';var aF=aG.virtual;var aE={};aE[aF?"id":"name"]=aG.name;aE.value=aG.value;am+=j.dumpAttributes(aE);am+=" />\n"}var V;function r(aE,aF){if(!aF){return}var aJ=J.uselump.tagname;var aH=Z.applier;function aI(){j.applyBoundChange(j.byId(aF,Z.document),undefined,aH)}if(Z.autoBind&&/input|select|textarea/.test(aJ)&&!H[aF]){var aG=[{jQuery:["change",aI]}];if(h.browser.msie&&aJ==="input"&&/radio|checkbox/.test(J.attrcopy.type)){aG.push({jQuery:["click",aI]})}if(h.browser.safari&&aJ==="input"&&J.attrcopy.type==="radio"){aG.push({jQuery:["keyup",aI]})}V(aE,aG,J.attrcopy,aF)}}function K(aF,aH){if(aF){var aG=aH?aH:aF;if(Z.fossils&&aG.valuebinding){var aE=aG.submittingname||aF.finalID;Z.fossils[aE]={name:aE,EL:aG.valuebinding,oldvalue:aG.value};r(aF,aF.finalID)}if(aF.fossilizedbinding){ay(aF.fossilizedbinding)}if(aF.fossilizedshaper){ay(aF.fossilizedshaper)}}}function D(aE){if(!H[aE.selection.fullID]){H[aE.selection.fullID]=true;K(aE.selection);K(aE.optionlist);K(aE.optionnames)}}function X(aE,aG){var aF=aE.selection;return aF.value&&typeof(aF.value)!=="string"&&typeof(aF.value.length)==="number"?h.inArray(aG,aF.value)!==-1:aF.value===aG}function ao(aE,aF){aE=aE.parent;while(aF.indexOf("..::")===0){aF=aF.substring(4);aE=aE.parent}return aE.childmap[aF]}function ax(aF,aE){j.each(an,function(aH,aG){if(aH===aF){an[aG]=aE}})}function F(aH,aG,aF,aJ){if(!aF){delete aH["rsf:id"]}if(aG.finalID!==undefined){aH.id=aG.finalID}else{if(aJ!==undefined){aH.id=aJ}else{if(aH.id||aF){aH.id=aG.fullID}}}var aI=1;var aE=aH.id;while(Z.document.getElementById(aH.id)||A[aH.id]){aH.id=aE+"-"+(aI++)}if(aI!==1){ax(aE,aH.id)}aG.finalID=aH.id;return aH.id}function C(aF,aE,aG){var aH=aG||aE;F(aF,aE,true,aE.fullID);if(aH.submittingname===undefined&&aH.willinput!==false){aH.submittingname=aH.finalID||aH.fullID}return aH.submittingname}function at(aF){var aH=[];if(aF.type){aH[0]=aF}else{for(var aG in aF){if(aG==="$"){aG="jQuery"}var aI=aF[aG];var aE={type:aG};if(aG==="jQuery"){aE.func=aI[0];aE.args=aI.slice(1)}else{if(aG==="addClass"||aG==="removeClass"){aE.classes=aI}else{if(aG==="attrs"){aE.attributes=aI}else{if(aG==="identify"){aE.key=aI}}}}aH[aH.length]=aE}}return aH}V=function(aJ,aN,aG,aL){var aE;var aF=function(aQ,aP){if(aQ===null||aQ===undefined){delete aG[aP]}else{aG[aP]=j.XMLEncode(aQ)}};Z.idMap=Z.idMap||{};for(var aI=0;aI<aN.length;++aI){var aH=aN[aI];var aK=aH.type;if(!aK){var aM=at(aH);V(aJ,aM,aG,aL);continue}if(aK==="$"){aK=aH.type="jQuery"}if(aK==="jQuery"||aK==="event"||aK==="fluid"){aE=F(aG,aJ,true,aL);if(aH.ids===undefined){aH.ids=[];aj[aj.length]=aH}aH.ids.push(aE)}else{if(aK==="attrs"){j.each(aH.attributes,aF)}else{if(aK==="addClass"||aK==="removeClass"){var aO={nodeType:1,className:aG["class"]||""};Z.jQuery(aO)[aK](aH.classes);aG["class"]=aO.className}else{if(aK==="identify"){aE=F(aG,aJ,true,aL);Z.idMap[aH.key]=aE}else{if(aK!=="null"){j.log("Unrecognised decorator of type "+aK+" found at component of ID "+aL)}}}}}}};function I(aE,aF){if(!aE.decorators){return}if(aE.decorators.length===undefined){aE.decorators=at(aE.decorators)}V(aE,aE.decorators,aF)}function aa(aG,aE){if(aE.elide){return}var aF={};h.extend(true,aF,aE.attributemap);F(aF,aG);I(aG,aF);am+="<"+aE.tagname+" ";am+=j.dumpAttributes(aF);am+=">"}function af(aE){if(!aE){return aE}aE=j.copy(aE);return j.transform(aE,function(aF,aG){m(aE,aG,Z.model,Z.resolverGetConfig);return aE[aG].value})}function ap(aF){if(aF.componentType==="UIMessage"){aF.componentType="UIBound";if(!Z.messageLocator){aF.value="[No messageLocator is configured in options - please consult documentation on options.messageSource]"}else{m(aF,"messagekey",Z.model,Z.resolverGetConfig);var aE=af(aF.args);aF.value=Z.messageLocator(aF.messagekey.value,aE)}}}function R(aP){var aO;var aI=J.attrcopy;ap(aP);var aN=aP.componentType;var aS=J.uselump.tagname;I(aP,aI);function aF(aW,aX){j.fail("Error in component tree - UISelectChoice with id "+aW.fullID+aX)}if(aN==="UIBound"||aN==="UISelectChoice"){var aK;if(aP.choiceindex!==undefined){if(aP.parentRelativeID!==undefined){aK=ao(aP,aP.parentRelativeID);if(!aK){aF(aP," has parentRelativeID of "+aP.parentRelativeID+" which cannot be resolved")}}else{aF(aP," does not have parentRelativeID set")}C(aI,aP,aK.selection);D(aK)}var aH=aK?aK.selection.submittingname:aP.submittingname;if(!aK&&aP.valuebinding){aH=C(aI,aP)}if(aS==="input"||aS==="textarea"){if(aH!==undefined){aI.name=aH}}K(aP,aK?aK.selection:null);if(typeof(aP.value)==="boolean"||aI.type==="radio"||aI.type==="checkbox"){var aJ;var aR=aP.value;if(aP.choiceindex!==undefined){if(!aK.optionlist.value){j.fail("Error in component tree - selection control with full ID "+aK.fullID+" has no values")}aJ=aK.optionlist.value[aP.choiceindex];aR=X(aK,aJ)}if(w(aR)){if(aR){aI.checked="checked"}else{delete aI.checked}}aI.value=j.XMLEncode(aJ?aJ:"true");ag(null)}else{if(j.isArrayable(aP.value)){ae()}else{aO=aK?aK[aS==="textarea"||aS==="input"?"optionlist":"optionnames"].value[aP.choiceindex]:aP.value;if(aS==="textarea"){if(v(aO)&&aP.willinput){aO=""}ag(aO)}else{if(aS==="input"){if(aP.willinput||w(aO)){aI.value=j.XMLEncode(String(aO))}ag(null)}else{delete aI.name;az(aO)}}}}}else{if(aN==="UISelect"){var aV=aS==="select";var aG=false;if(j.isArrayable(aP.selection.value)){aG=true;if(aV){aI.multiple="multiple"}}C(aI,aP.selection);if(aV){if(aP.selection.willinput!==false){aI.name=aP.selection.submittingname}r(aP,aI.id)}am+=j.dumpAttributes(aI);if(aV){am+=">";var aE=aP.optionlist.value;var aM=aP.optionnames===null||aP.optionnames===undefined||!aP.optionnames.value?aE:aP.optionnames.value;if(!aM||!aM.length){j.fail("Error in component tree - UISelect component with fullID "+aP.fullID+" does not have optionnames set")}for(var aQ=0;aQ<aM.length;++aQ){am+='<option value="';aO=aE[aQ];if(aO===null){aO=j.NULL_STRING}am+=j.XMLEncode(aO);if(X(aP,aO)){am+='" selected="selected'}am+='">';am+=j.XMLEncode(aM[aQ]);am+="</option>\n"}av()}else{ai()}D(aP)}else{if(aN==="UILink"){var aL=e[aS];if(aL){ap(aP.target);var aU=aP.target.value;if(!w(aU)){aU=aI[aL]}aU=o(J.uselump.parent,aU);aI[aL]=j.XMLEncode(aU)}aO=undefined;if(aP.linktext){ap(aP.linktext);aO=aP.linktext.value}if(!w(aO)){aq()}else{ag(aO)}}else{if(aP.markup!==undefined){ap(aP.markup);var aT=aP.markup.value;if(aT===null){am+=j.dumpAttributes(aI);am+=">";ae()}else{if(!J.iselide){am+=j.dumpAttributes(aI);am+=">"}am+=aT;av()}}}}}if(aI.id!==undefined){A[aI.id]=true}}function u(aE){var aI;var aG=J.attrcopy["for"];if(aG!==undefined){aI="for"}else{aG=J.attrcopy.headers;if(aG!==undefined){aI="headers"}}if(!aI){return}var aH=J.uselump.tagname;if(aI==="for"&&aH!=="label"){return}if(aI==="headers"&&aH!=="td"&&aH!=="th"){return}var aF=an[aA(J.uselump.parent,aE,aG)];if(aF!==undefined){J.attrcopy[aI]=aF}}function ah(aE){am+=("<!-- "+j.XMLEncode(aE)+"-->")}function y(aE){am+='<span style="background-color:#FF466B;color:white;padding:1px;">';am+=aE;am+="</span><br/>"}function W(aE){var aF=aE.fullID;return !aF?"component tree root":"full path "+aF}function G(aF,aO,aK){var aM=aK.lumpindex;var aS=aK.parent.lumps;var aL=-1;var aN=aS[aM+1];var aE=aK.close_tag;aL=aE.lumpindex+1;var aJ=aK.downmap?aK.downmap["payload-component"]:null;var aR=aJ?aJ[0]:null;var aQ=aK.rsfID.charCodeAt(0)===126;var aI=aN;var aT=aE;var aH=aK;var aG={};
h.extend(true,aG,(aR===null?aK:aR).attributemap);J.attrcopy=aG;J.uselump=aH;J.endopen=aI;J.close=aT;J.nextpos=aL;J.iselide=aQ;u(aF);if(aO===null){if(aK.rsfID.indexOf("scr=")===(aQ?1:0)){var aP=aK.rsfID.substring(4+(aQ?1:0));if(aP==="ignore"){aL=J.close.lumpindex+1}else{if(aP==="rewrite-url"){aO={componentType:"UILink",target:{}}}else{x();aq();aL=J.endopen.lumpindex}}}}if(aO!==null){if(aR){J.endopen=aS[aR.lumpindex+1];J.close=aR.close_tag;J.uselump=aR;E(aS,aM,aR.lumpindex);aM=aR.lumpindex}F(aG,aO);x();R(aO);if(aR!==null){if(J.nextpos===aL){E(aS,J.close.lumpindex+1,aE.lumpindex+1)}}aL=J.nextpos}return aL}var ad;function B(aH,aE){var aG=aE.parent;var aF=aG.lumps[aE.lumpindex+1];if(aH.children!==undefined){aa(aH,aE)}else{G(aH.parent,aH,aE)}ad(aH,aE,aF)}ar=function(aG,aH){if(aH.indexOf("msg=")===0){var aE=aH.substring(4);return{componentType:"UIMessage",messagekey:aE}}while(aG){var aF=aG.childmap[aH];if(aF){return aF}aG=aG.parent}return null};function aC(aF,aG){var aE;while(aF){aE=aF.childmap[aG];if(aE){break}aF=aF.parent}return aE}function U(aG,aH){var aF=j.SplitID(aH.ID);var aE=aG.downmap[aH.ID];if(!aE){aE=aG.downmap[aF.prefix+":"]}return aE?aE[0]:null}ad=function(aJ,aY,aP){var aE;var aT;var aF;var aS=aP.lumpindex;var aV=aY.nestingdepth;var aK=aY.parent;var aW;if(aD){aW={}}while(true){aS=ab(aK.lumps,aS,aV,!aY.elide,false);if(aS===aK.lumps.length){break}var aN=aK.lumps[aS];var aO=aN.rsfID;if(aN.nestingdepth<aV||aO===undefined){break}if(aO.charCodeAt(0)===126){aO=aO.substring(1)}if(aO.indexOf(":")!==-1){var aQ=j.getPrefix(aO);aE=aC(aJ,aQ);var aG=aN.uplump.finallump[aQ];var aH=aG.close_tag;if(aE){for(var aR=0;aR<aE.length;++aR){aF=aE[aR];if(aF.children){if(aD){aW[aF.fullID]=true}aT=au[aF.fullID];if(aT){if(aD){ah("Branching for "+aF.fullID+" from "+j.debugLump(aN)+" to "+j.debugLump(aT))}B(aF,aT);if(aD){ah("Branch returned for "+aF.fullID+j.debugLump(aN)+" to "+j.debugLump(aT))}}else{if(aD){y("No matching template branch found for branch container with full ID "+aF.fullID+" rendering from parent template branch "+j.debugLump(aP))}}}else{aT=U(aY,aF);if(!aT){if(aD){y("Repetitive leaf with full ID "+aF.fullID+" could not be rendered from parent template branch "+j.debugLump(aP))}continue}var aU=G(aJ,aF,aT);var aM=aU<aK.lumps.lengtn&&aK.lumps[aU].nestingdepth>=aT.nestingdepth;var aI=aF.children?aF:aJ;if(aM){ad(aI,aT,aK.lumps[aU]);aU=aT.close_tag.lumpindex+1}if(aR!==aE.length-1){if(aU<aH.lumpindex){ab(aK.lumps,aU,aT.nestingdepth-1,false,false)}}else{ab(aK.lumps,aU,aT.nestingdepth,true,false)}}}}else{if(aD){y("No branch container with prefix "+aQ+": found in container "+W(aJ)+" rendering at template position "+j.debugLump(aP)+", skipping")}}aS=aH.lumpindex+1;if(aD){ah("Stack returned from branch for ID "+aO+" to "+j.debugLump(aP)+": skipping from "+j.debugLump(aN)+" to "+j.debugLump(aH))}}else{var aL;if(aO){aL=ar(aJ,aO,aN);if(aD&&aL){aW[aL.fullID]=true}}if(aL&&aL.children!==undefined){B(aL);aS=aN.close_tag.lumpindex+1}else{aS=G(aJ,aL,aN)}}if(aS===aK.lumps.length){break}}if(aD){aE=aJ.children;for(var aX=0;aX<aE.length;++aX){aF=aE[aX];if(!aW[aF.fullID]){y("Component "+aF.componentType+" with full ID "+aF.fullID+" could not be found within template "+j.debugLump(aP))}}}};function t(aE){E(aE.parent.lumps,aE.lumpindex,aE.close_tag.lumpindex+1)}function p(){for(var aG in Q){var aE=Q[aG];for(var aF=0;aF<aE.length;++aF){t(aE[aF])}}}function z(){for(var aJ=0;aJ<aj.length;++aJ){var aI=aj[aJ];for(var aH=0;aH<aI.ids.length;++aH){var aF=aI.ids[aH];var aG=j.byId(aF,Z.document);if(!aG){j.fail("Error during rendering - component with id "+aF+" which has a queued decorator was not found in the output markup")}if(aI.type==="jQuery"){var aE=Z.jQuery(aG);aE[aI.func].apply(aE,j.makeArray(aI.args))}else{if(aI.type==="fluid"){var aM=aI.args;if(!aM){var aK=Z.jQuery(aG);if(!aI.container){aI.container=aK}else{aI.container.push(aG)}aM=[aK,aI.options]}var aL=k.invokeFluidDecorator(aI.func,aM,aF,aJ,Y);aI.that=aL}else{if(aI.type==="event"){aG[aI.event]=aI.handler}}}}}}ak.renderTemplates=function(){O=l(O,Y.model,Y.resolverGetConfig);var aE=q[0];M(q.globalmap,O,aE.rootlump);H={};p();ad(O,aE.rootlump,aE.lumps[aE.firstdocumentindex]);return am};ak.processDecoratorQueue=function(){z()};return ak};jQuery.extend(true,j.renderer,k);j.ComponentReference=function(o){this.reference=o};j.explode=function(r,o){var q=[];for(var p in r){var s=o===undefined?p:o+"."+p;q[q.length]={ID:p,value:r[p],valuebinding:s}}return q};j.explodeSelectionToInputs=function(o,p){return j.transform(o,function(r,q){return{ID:p.rowID,children:[{ID:p.inputID,parentRelativeID:"..::"+p.selectID,choiceindex:q},{ID:p.labelID,parentRelativeID:"..::"+p.selectID,choiceindex:q}]}})};j.resolveMessageSource=function(o){if(o.type==="data"){if(o.url===undefined){return j.messageLocator(o.messages,o.resolveFunc)}else{}}else{if(o.type==="resolver"){return o.resolver.resolve}}};j.renderTemplates=function(r,o,p,q){var s=j.renderer(r,o,p,q);var t=s.renderTemplates();return t};j.reRender=function(u,q,w,v){v=v||{};var t=j.renderer(u,w,v,v.fossils);v=t.options;q=j.unwrap(q);var s=j.getLastFocusedElement?j.getLastFocusedElement():null;var o;if(s&&j.dom.isContainer(q,s)){o=s.id}if(h.browser.msie){v.jQuery(q).empty()}else{q.innerHTML=""}var p=t.renderTemplates();if(v.renderRaw){p=j.XMLEncode(p);p=p.replace(/\n/g,"<br/>")}if(v.model){j.bindFossils(q,v.model,v.fossils)}if(h.browser.msie){v.jQuery(q).html(p)}else{q.innerHTML=p}t.processDecoratorQueue();if(o){var r=j.byId(o,v.document);if(r){v.jQuery(r).focus()}}return u};function a(o){var p=j.dom.iterateDom(o,function(r){return r.nodeType===8||r.nodeType===4?"stop":null},true);var q=p.nodeValue;if(q.indexOf("[CDATA[")===0){return q.substring(6,q.length-2)}else{return q}}j.extractTemplate=function(p,o){if(!o){return p.innerHTML}else{return a(p)}};j.render=function(t,u,o,q){q=q||{};var s=t;if(typeof(t)==="object"){s=j.extractTemplate(j.unwrap(t.node),t.armouring)}u=j.unwrap(u);var p={base:{resourceText:s,href:".",resourceKey:".",cutpoints:q.cutpoints}};var r=j.parseTemplates(p,["base"],q);return j.reRender(r,u,o,q)};j.selfRender=function(q,o,p){p=p||{};return j.render({node:q,armouring:p.armouring},q,o,p)}})(jQuery,fluid_1_5);fluid_1_5=fluid_1_5||{};(function(c,b){if(!b.renderer){b.fail("fluidRenderer.js is a necessary dependency of RendererUtilities")}b.renderer.visitDecorators=function(e,f){b.visitComponentChildren(e,function(h,g){if(g.indexOf(b.renderer.decoratorComponentPrefix)===0){f(h,g)}},{flat:true})};b.renderer.clearDecorators=function(e){var f=b.getInstantiator(e);b.renderer.visitDecorators(e,function(h,g){f.clearComponent(e,g)})};b.renderer.getDecoratorComponents=function(f){var e={};b.renderer.visitDecorators(f,function(h,g){e[g]=h});return e};b.renderer.modeliseOptions=function(f,g,e){return c.extend({},g,b.filterKeys(e,["model","applier"]),f)};b.renderer.reverseMerge=function(g,e,f){f=b.makeArray(f);b.each(f,function(h){if(g[h]===undefined&&e[h]!==undefined){g[h]=e[h]}})};b.renderer.createRendererSubcomponent=function(f,m,n,j,h){n=n||{};var e=n.templateSource?n.templateSource:{node:c(f)};var l=b.renderer.modeliseOptions(n.rendererOptions,null,j);l.fossils=h||{};l.parentComponent=j;if(f.jquery){var i={document:f[0].ownerDocument,jQuery:f.constructor};b.renderer.reverseMerge(l,i,b.keys(i))}var g={};var k=null;g.render=function(o){var q=n.cutpointGenerator||"fluid.renderer.selectorsToCutpoints";l.cutpoints=l.cutpoints||b.invokeGlobalFunction(q,[m,n]);var p=c(n.renderTarget?n.renderTarget:f);if(k){b.clear(l.fossils);b.reRender(k,p,o,l)}else{if(typeof(e)==="function"){e=e()}k=b.render(e,p,o,l)}};return g};b.defaults("fluid.commonRendererComponent",{gradeNames:[],initFunction:"fluid.initRendererComponent",mergePolicy:{"rendererOptions.idMap":"nomerge","rendererOptions.model":"preserve",protoTree:"noexpand, replace",parentBundle:"nomerge","changeApplierOptions.resolverSetConfig":"resolverSetConfig"},invokers:{refreshView:{funcName:"fluid.rendererComponent.refreshView",args:"{that}"},produceTree:{funcName:"fluid.rendererComponent.produceTree",args:"{that}"}},rendererOptions:{autoBind:true},events:{prepareModelForRender:null,onRenderTree:null,afterRender:null},listeners:{onCreate:{funcName:"fluid.rendererComponent.renderOnInit",args:["{that}.options.renderOnInit","{that}"],priority:"last"}}});b.defaults("fluid.rendererComponent",{gradeNames:["fluid.commonRendererComponent","fluid.viewComponent","autoInit"]});b.defaults("fluid.rendererRelayComponent",{gradeNames:["fluid.commonRendererComponent","fluid.viewRelayComponent","autoInit"]});b.rendererComponent.renderOnInit=function(f,e){if(f||e.renderOnInit){e.refreshView()}};b.protoExpanderForComponent=function(e,g){var f=b.renderer.modeliseOptions(g.expanderOptions,{ELstyle:"${}"},e);b.renderer.reverseMerge(f,g,["resolverGetConfig","resolverSetConfig"]);var h=b.renderer.makeProtoExpander(f,e);return h};b.rendererComponent.refreshView=function(f){if(!f.renderer){f.renderOnInit=true;return}else{b.renderer.clearDecorators(f);f.events.prepareModelForRender.fire(f.model,f.applier,f);var e=f.produceTree(f);var g=f.renderer.rendererFnOptions;if(!g.noexpand){var h=b.protoExpanderForComponent(f,g);e=h(e)}f.events.onRenderTree.fire(f,e);f.renderer.render(e);f.events.afterRender.fire(f)}};b.rendererComponent.produceTree=function(f){var e=f.options.produceTree;return e?(typeof(e)==="string"?b.getGlobalValue(e):e)(f):f.options.protoTree};b.initRendererComponent=function(j,e,m){var h=b.initView(j,e,m,{gradeNames:["fluid.rendererComponent"]});b.getForComponent(h,"model");b.getForComponent(h,"applier");b.diagnoseFailedView(j,h,b.defaults(j),arguments);b.fetchResources(h.options.resources);var l=b.renderer.modeliseOptions(h.options.rendererOptions,null,h);var f;if(!l.messageSource&&h.options.strings){f=b.messageResolver({messageBase:h.options.strings,resolveFunc:h.options.messageResolverFunction,parents:b.makeArray(h.options.parentBundle)});l.messageSource={type:"resolver",resolver:f}}b.renderer.reverseMerge(l,h.options,["resolverGetConfig","resolverSetConfig"]);
h.rendererOptions=l;var g=c.extend({},h.options.rendererFnOptions,{rendererOptions:l,repeatingSelectors:h.options.repeatingSelectors,selectorsToIgnore:h.options.selectorsToIgnore,expanderOptions:{envAdd:{styles:h.options.styles}}});if(h.options.resources&&h.options.resources.template){g.templateSource=function(){return h.options.resources.template.resourceText}}b.renderer.reverseMerge(g,h.options,["resolverGetConfig","resolverSetConfig"]);if(g.rendererTargetSelector){e=function(){return h.dom.locate(g.rendererTargetSelector)}}var i={fossils:{},rendererFnOptions:g,boundPathForNode:function(n){return b.boundPathForNode(n,i.fossils)}};var k=b.renderer.createRendererSubcomponent(e,h.options.selectors,g,h,i.fossils);h.renderer=c.extend(i,k);if(f){h.messageResolver=f}i.refreshView=b.getForComponent(h,"refreshView");return h};var a=function(e,f){b.each(b.makeArray(f),function(g){delete e[g]});return e};var d=function(f,e){if(e){b.each(e,function(g){if(f===g){f=f+":"}})}return f};b.renderer.selectorsToCutpoints=function(f,e){var g=[];e=e||{};f=b.copy(f);if(e.selectorsToIgnore){f=a(f,e.selectorsToIgnore)}for(var h in f){g.push({id:d(h,e.repeatingSelectors),selector:f[h]})}return g};b.renderer.NO_COMPONENT={};b.renderer.mergeComponents=function(g,f){for(var e in f){g[e]=f[e]}return g};b.registerNamespace("fluid.renderer.selection");b.renderer.selection.inputs=function(g,e,h,f){b.expect("Selection to inputs expander",["selectID","inputID","labelID","rowID"],g);var i=f.expander(g.tree);var k=b.transform(i.optionlist.value,function(n,l){var o={};var m={parentRelativeID:"..::"+g.selectID,choiceindex:l};o[g.inputID]=m;o[g.labelID]=b.copy(m);return o});var j={};j[g.selectID]=i;j[g.rowID]={children:k};j=f.expander(j);return j};b.renderer.repeat=function(n,e,l,g){b.expect("Repetition expander",["controlledBy","tree"],n);var j=g.threadLocal();var m=b.extractContextualPath(n.controlledBy,{ELstyle:"ALL"},j);var k=b.get(g.model,m,g.resolverGetConfig);var f={};if(!k||k.length===0){return n.ifEmpty?g.expander(n.ifEmpty):f}var i=[];b.each(k,function(r,q){var s=b.model.composePath(m,q);var o={};if(n.pathAs){o[n.pathAs]="${"+s+"}"}if(n.valueAs){o[n.valueAs]=b.get(g.model,s,g.resolverGetConfig)}var p=b.withEnvironment(o,function(){return g.expander(n.tree)},j);if(b.isArrayable(p)){if(p.length>0){i.push({children:p})}}else{if(p!==b.renderer.NO_COMPONENT){i.push(p)}}});var h=n.repeatID;if(h.indexOf(":")===-1){h=h+":"}b.each(i,function(o){o.ID=h});return i};b.renderer.condition=function(i,f,j,h){b.expect("Selection to condition expander",["condition"],i);var k;if(i.condition.funcName){var g=h.expandLight(i.condition.args);k=b.invoke(i.condition.funcName,g)}else{if(i.condition.expander){k=h.expander(i.condition)}else{k=h.expandLight(i.condition)}}var e=(k?i.trueTree:i.falseTree);if(!e){e=b.renderer.NO_COMPONENT}return h.expander(e)};b.extractContextualPath=function(g,f,h,i){var e=b.extractELWithContext(g,f);if(e){if(e.context){return h[e.context]?b.transformContextPath(e,h).path:{value:i(e)}}else{return e.path}}};b.transformContextPath=function(e,f){if(e.context){var h=f[e.context];var g;if(typeof(h)==="string"){g=b.extractEL(h,{ELstyle:"${}"})}if(g){return{noDereference:e.path==="",path:b.model.composePath(g,e.path)}}}return e};b.renderer.makeExternalFetcher=function(e){return function(g){var f=b.resolveContext(g.context,e);return f?b.getForComponent(f,g.path):undefined}};b.renderer.makeProtoExpander=function(m,p){var t=c.extend({ELstyle:"${}"},m);if(p){t.externalFetcher=b.renderer.makeExternalFetcher(p)}var h;function n(u){var v=h();return b.extractContextualPath(u,t,v,t.externalFetcher)}var l=t.IDescape||"\\";var j=function(u){return b.expand(u,t)};var i=function(x,u){if(x.messagekey!==undefined){return{componentType:"UIMessage",messagekey:i(x.messagekey),args:j(x.args)}}var w;if(!b.isPrimitive(x)&&!b.isArrayable(x)){w=c.extend({},x);if(w.decorators){w.decorators=j(w.decorators)}x=w.value;delete w.value}else{w={}}var v;if(typeof(x)==="string"){var y=n(x);v=typeof(y)==="string"?y:null;x=b.get(y,"value")||x}if(v){w.valuebinding=v}else{if(x!==undefined){w.value=x}}if(t.model&&w.valuebinding&&w.value===undefined){w.value=b.get(t.model,w.valuebinding,t.resolverGetConfig)}if(u){w.componentType="UIBound"}return w};t.filter=b.expander.lightFilter;var g;var q;var o=function(v){var u=[];g(v,u);return{children:u}};var k=function(w){if(w===b.renderer.NO_COMPONENT){return w}var u;var x=[];var v=function(y){u=y};q(w,x,v);return u||x};var r={model:t.model,resolverGetConfig:t.resolverGetConfig,resolverSetConfig:t.resolverSetConfig,expander:k,expandLight:j};var s=function(u,v){var x={componentType:v};var y=b.renderer.boundMap[v]||{};for(var w in u){if(/decorators|args/.test(w)){x[w]=j(u[w]);continue}else{if(y[w]){x[w]=i(u[w])}else{x[w]=u[w]}}}return x};var f=function(z,y){var w=z.children;for(var v=0;v<w.length;++v){var A=[];var u={children:A};var B=w[v];var x=function(C){A[A.length]=C};q(B,A,x);if(u.children.length===1&&!u.children[0].ID){u=u.children[0]}y(u)}};function e(u){return b.find(u,function(w,v){return v==="decorators"})!==false}q=function(w,x,v){var u=b.renderer.inferComponentType(w);if(!u&&(b.isPrimitive(w)||e(w))){u="UIBound"}if(u){v(u==="UIBound"?i(w,true):s(w,u))}else{if(!x){b.fail("Illegal cond->cond transition")}g(w,x)}};g=function(y,z){var x=function(C){var B=b.invokeGlobalFunction(C.type,[C,y,v,r]);if(B!==b.renderer.NO_COMPONENT){b.each(B,function(D){z[z.length]=D})}};var A=function(B){B.ID=v;z[z.length]=B};for(var v in y){var w=y[v];if(v.charAt(0)===l){v=v.substring(1)}if(v==="expander"){var u=b.makeArray(w);b.each(u,x)}else{if(w){if(w.children){if(v.indexOf(":")===-1){v=v+":"}f(w,A)}else{if(b.renderer.isBoundPrimitive(w)){A(i(w,true))}else{q(w,null,A)}}}}}};return function(u){h=b.threadLocal(function(){return c.extend({},t.envAdd)});t.fetcher=b.makeEnvironmentFetcher(t.model,b.transformContextPath,h,t.externalFetcher);r.threadLocal=h;return o(u)}}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.overviewPanel");a.overviewPanel.makeBooleanListener=function(e,c,h,g,f){var d=e.locate(c);d[h](function(i){e.applier.change(g,f==="toggle"?!e.model[g]:f);i.preventDefault()})};a.defaults("fluid.overviewPanel",{gradeNames:["fluid.rendererComponent","autoInit"],resources:{template:{href:"../html/overviewPanelTemplate.html"}},listeners:{"onCreate.setVisibility":"{that}.setVisibility","onCreate.showTemplate":"fluid.overviewPanel.showTemplate","afterRender.registerToggleListener":{funcName:"fluid.overviewPanel.makeBooleanListener",args:["{that}","toggleControl","click","showPanel","toggle"]},"afterRender.registerCloseListener":{funcName:"fluid.overviewPanel.makeBooleanListener",args:["{that}","closeControl","click","showPanel",false]},"afterRender.setLinkHrefs":{funcName:"fluid.overviewPanel.setLinkHrefs",args:["{that}","{that}.options.links"]},"afterRender.setToggleControlAria":{"this":"{that}.dom.toggleControl",method:"attr",args:{role:"button","aria-controls":"{that}.containerId"}},"afterRender.setCloseControlAria":{"this":"{that}.dom.closeControl",method:"attr",args:{role:"button","aria-label":"{that}.options.strings.closePanelLabel","aria-controls":"{that}.containerId"}},"afterRender.setAriaStates":"{that}.setAriaStates"},model:{showPanel:true},modelListeners:{"showPanel.setVisibility":"{that}.setVisibility","showPanel.setAriaStates":"{that}.setAriaStates"},members:{containerId:{expander:{funcName:"fluid.allocateSimpleId",args:"{that}.container"}}},invokers:{setVisibility:{funcName:"fluid.overviewPanel.setVisibility",args:["{that}","{that}.model.showPanel"]},setAriaStates:{funcName:"fluid.overviewPanel.setAriaStates",args:["{that}","{that}.model.showPanel"]}},selectors:{toggleControl:".flc-overviewPanel-toggleControl",titleBegin:".flc-overviewPanel-title-begin",titleLink:".flc-overviewPanel-titleLink",titleLinkText:".flc-overviewPanel-title-linkText",titleEnd:".flc-overviewPanel-title-end",componentName:".flc-overviewPanel-componentName",description:".flc-overviewPanel-description",instructionsHeading:".flc-overviewPanel-instructionsHeading",instructions:".flc-overviewPanel-instructions",demoCodeLink:".flc-overviewPanel-demoCodeLink",demoCodeLinkText:".flc-overviewPanel-demoCodeLinkText",infusionCodeLink:".flc-overviewPanel-infusionCodeLink",infusionCodeLinkText:".flc-overviewPanel-infusionCodeLinkText",apiLink:".flc-overviewPanel-apiLink",apiLinkText:".flc-overviewPanel-apiLinkText",designLink:".flc-overviewPanel-designLink",designLinkText:".flc-overviewPanel-designLinkText",feedbackText:".flc-overviewPanel-feedbackText",feedbackLink:".flc-overviewPanel-feedbackLink",feedbackLinkText:".flc-overviewPanel-feedbackLinkText",closeControl:".flc-overviewPanel-closeControl",closeText:".flc-overviewPanel-closeText"},selectorsToIgnore:["toggleControl","titleLink","demoCodeLink","infusionCodeLink","apiLink","designLink","feedbackLink","closeControl"],protoTree:{titleBegin:{messagekey:"titleBegin"},titleLinkText:{messagekey:"titleLinkText"},titleEnd:{messagekey:"titleEnd"},componentName:{messagekey:"componentName"},description:{markup:"${{that}.options.markup.description}"},instructionsHeading:{messagekey:"instructionsHeading"},instructions:{markup:"${{that}.options.markup.instructions}"},demoCodeLinkText:{messagekey:"demoCodeLinkText"},infusionCodeLinkText:{messagekey:"infusionCodeLinkText"},apiLinkText:{messagekey:"apiLinkText"},designLinkText:{messagekey:"designLinkText"},feedbackText:{messagekey:"feedbackText"},feedbackLinkText:{messagekey:"feedbackLinkText"},closeText:{messagekey:"closeText"}},styles:{hidden:"fl-overviewPanel-hidden"},strings:{titleBegin:"An",titleLinkText:"Infusion",titleEnd:"component demo",componentName:"Component Name",instructionsHeading:"Instructions",demoCodeLinkText:"demo code",infusionCodeLinkText:"get Infusion",apiLinkText:"API",designLinkText:"design",feedbackText:"Found a bug? Have a question?",feedbackLinkText:"Let us know!",closeText:"close",openPanelLabel:"Open the overview panel",closePanelLabel:"Close the overview panel"},markup:{description:"A description of the component should appear here. It should say: <ul><li>What the component does.</li><li>Why it is interesting / useful.</li></ul>",instructions:"<p>Do this to do this. Do that to do that.</p>"},links:{titleLink:"http://fluidproject.org/products/infusion/",demoCodeLink:"#",infusionCodeLink:"https://github.com/fluid-project/infusion/",apiLink:"#",designLink:"#",feedbackLink:"#"}});
a.overviewPanel.setVisibility=function(c,d){c.container.toggleClass(c.options.styles.hidden,!d)};a.overviewPanel.showTemplate=function(c){a.fetchResources(c.options.resources,function(){c.refreshView()})};a.overviewPanel.setLinkHrefs=function(c,d){a.each(d,function(f,e){c.locate(e).attr("href",f)})};a.overviewPanel.setAriaStates=function(c,d){c.locate("toggleControl").attr("aria-pressed",!d);c.locate("toggleControl").attr("aria-expanded",d);c.locate("closeControl").attr("aria-expanded",d);if(d){c.locate("toggleControl").attr("aria-label",c.options.strings.closePanelLabel)}else{c.locate("toggleControl").attr("aria-label",c.options.strings.openPanelLabel)}}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.pager");a.pager.updateStyles=function(d,e,g){if(g&&g.pageIndex!==undefined){var f=d.pageLinks.eq(g.pageIndex);f.removeClass(d.options.styles.currentPage)}var c=d.pageLinks.eq(e.pageIndex);c.addClass(d.options.styles.currentPage)};a.pager.bindLinkClick=function(c,d,e){c.unbind("click.fluid.pager");c.bind("click.fluid.pager",function(){d.fire(e);return false})};a.pager.computePageCount=function(c){return Math.max(1,Math.floor((c.totalRange-1)/c.pageSize)+1)};a.pager.computePageLimit=function(c){return Math.min(c.totalRange,(c.pageIndex+1)*c.pageSize)};a.pager.bindLinkClicks=function(d,c){a.each(d,function(e,f){a.pager.bindLinkClick(b(e),c,{pageIndex:f})})};a.defaults("fluid.pager.pageList",{gradeNames:["fluid.viewRelayComponent"]});a.defaults("fluid.pager.directPageList",{gradeNames:["fluid.pager.pageList","autoInit"],listeners:{onCreate:{funcName:"fluid.pager.bindLinkClicks",args:["{that}.pageLinks","{pager}.events.initiatePageChange"]}},modelListeners:{"{pager}.model":"fluid.pager.updateStyles({that}, {change}.value, {change}.oldValue)"},members:{pageLinks:"{that}.dom.pageLinks",defaultModel:{totalRange:"{that}.pageLinks.length"}}});a.pager.everyPageStrategy=a.iota;a.pager.gappedPageStrategy=function(c,d){if(!c){c=3}if(!d){d=c}return function(l,m,f){var k=[];var e=0;var h=false;for(var g=0;g<l;++g){if(g<c||(l-g-1)<c||(g>=f-d&&g<=f+d)){k[e++]=g;h=false}else{if(!h){k[e++]=-1;h=true}}}return k}};a.pager.consistentGappedPageStrategy=function(c,d){if(!c){c=1}if(!d){d=c}var e=c+2+d;return function(k,j,o){var g=[];var i=o<e;var p=o>=k-e;var h=e+d;var f=o-d;var l=o+d;var n=false;for(var m=0;m<k;m++){if(m<c||k-m<=c||(i&&m<h)||(p&&m>=k-h)||(m>=f&&m<=l)){g.push(m);n=false}else{if(!n){g.push(-1);n=true}}}return g}};a.registerNamespace("fluid.pager.renderedPageList");a.pager.renderedPageList.assembleComponent=function(g,d,f,c,e){var h={ID:"page-link:link",localID:g+1,value:g+1,pageIndex:g,decorators:[{identify:"pageLink:"+g},{type:"jQuery",func:"click",args:function(i){f.fire({pageIndex:g});i.preventDefault()}}]};if(d){h.current=true;h.decorators=h.decorators.concat([{type:"addClass",classes:c},{type:"jQuery",func:"attr",args:["aria-label",e]}])}return h};a.pager.renderedPageList.onModelChange=function(e,d){function g(h){return function(i){return i===-1?{ID:"page-link:skip"}:e.assembleComponent(i,i===h)}}var c=e.options.pageStrategy(d.pageCount,0,d.pageIndex);var f=a.transform(c,g(d.pageIndex));if(f.length>1){f[f.length-1].value=f[f.length-1].value+e.options.strings.last}e.events.onRenderPageLinks.fire(f,d);e.pageTree=f;e.refreshView()};a.pager.renderedPageList.renderLinkBody=function(c,d){if(c){d.cutpoints.push({id:"payload-component",selector:c})}};a.defaults("fluid.pager.renderedPageList",{gradeNames:["fluid.rendererRelayComponent","fluid.pager.pageList","autoInit"],rendererOptions:{idMap:{},cutpoints:[{id:"page-link:link",selector:"{that}.options.selectors.pageLinks"},{id:"page-link:skip",selector:"{that}.options.selectors.pageLinkSkip"}]},rendererFnOptions:{noexpand:true,templateSource:{node:"{that}.dom.root"},renderTarget:"{that}.dom.root"},events:{onRenderPageLinks:"{pager}.events.onRenderPageLinks"},listeners:{onCreate:{funcName:"fluid.pager.renderedPageList.renderLinkBody",args:["{that}.options.linkBody","{that}.options.rendererOptions"]}},modelListeners:{"{pager}.model":"fluid.pager.renderedPageList.onModelChange({that}, {change}.value)"},invokers:{produceTree:{funcName:"fluid.identity",args:"{that}.pageTree",dynamic:true},assembleComponent:{funcName:"fluid.pager.renderedPageList.assembleComponent",args:["{arguments}.0","{arguments}.1","{pager}.events.initiatePageChange","{pagerBar}.options.styles.currentPage","{pagerBar}.options.strings.currentPageIndexMsg"]}},selectors:{root:".flc-pager-links",pageLinks:"{pagerBar}.options.selectors.pageLinks",pageLinkSkip:"{pagerBar}.options.selectors.pageLinkSkip"},strings:"{pager}.options.strings",linkBody:"a",pageStrategy:a.pager.everyPageStrategy});a.defaults("fluid.pager.previousNext",{gradeNames:["fluid.viewRelayComponent","autoInit"],members:{previous:"{that}.dom.previous",next:"{that}.dom.next"},selectors:{previous:".flc-pager-previous",next:".flc-pager-next"},listeners:{onCreate:[{funcName:"fluid.pager.bindLinkClick",args:["{that}.previous","{pager}.events.initiatePageChange",{relativePage:-1}]},{funcName:"fluid.pager.bindLinkClick",args:["{that}.next","{pager}.events.initiatePageChange",{relativePage:+1}]}]},modelListeners:{"{pager}.model":"fluid.pager.previousNext.update({that}, {that}.options.styles.disabled, {change}.value)"}});a.pager.previousNext.update=function(d,e,c){d.previous.toggleClass(e,c.pageIndex===0);d.next.toggleClass(e,c.pageIndex===c.pageCount-1)};a.defaults("fluid.pager.pagerBar",{gradeNames:["fluid.viewRelayComponent","autoInit"],components:{pageList:{type:"fluid.pager.pageList",container:"{pagerBar}.container",options:{selectors:{pageLinks:"{pagerBar}.options.selectors.pageLinks"},styles:"{pagerBar}.options.styles"}},previousNext:{type:"fluid.pager.previousNext",container:"{pagerBar}.container",options:{selectors:{previous:"{pagerBar}.options.selectors.previous",next:"{pagerBar}.options.selectors.next"},styles:"{pagerBar}.options.styles"}}},events:{initiatePageChange:null,onModelChange:null},selectors:{pageLinks:".flc-pager-pageLink",pageLinkSkip:".flc-pager-pageLink-skip",previous:".flc-pager-previous",next:".flc-pager-next"},styles:{currentPage:"fl-pager-currentPage",disabled:"fl-pager-disabled"},strings:{currentPageIndexMsg:"Current page"}});a.pager.summaryAria=function(c){c.attr({"aria-relevant":"all","aria-atomic":"false","aria-live":"assertive",role:"status"})};a.defaults("fluid.pager.summary",{gradeNames:["fluid.viewRelayComponent","autoInit"],listeners:{onCreate:{funcName:"fluid.pager.summaryAria",args:"{that}.container"}},modelListeners:{"{pager}.model":{funcName:"fluid.pager.summary.onModelChange",args:["{that}.container","{that}.options.strings.message","{change}.value"]}}});a.pager.summary.onModelChange=function(e,d,c){var f=a.stringTemplate(d,{first:c.pageIndex*c.pageSize+1,last:a.pager.computePageLimit(c),total:c.totalRange,currentPage:c.pageIndex+1});e.text(f)};a.defaults("fluid.pager.directPageSize",{gradeNames:["fluid.viewRelayComponent","autoInit"],listeners:{onCreate:{"this":"{that}.container",method:"change",args:{expander:{funcName:"fluid.pager.directPageSize.onChange",args:["{pager}.events.initiatePageSizeChange","{that}.container"]}}}},modelListeners:{"{pager}.model.pageSize":"fluid.pager.updateNodeValue({that}.container, {change}.value)"}});a.pager.directPageSize.onChange=function(c,d){return function(){c.fire(d.val()||1)}};a.pager.updateNodeValue=function(c,d){c.val(d)};a.pager.initiatePageChangeListener=function(e,c){var d=c.pageIndex;if(c.relativePage!==undefined){d=e.model.pageIndex+c.relativePage}e.applier.requestChange("pageIndex",d)};a.pager.initiatePageSizeChangeListener=function(d,c){d.applier.requestChange("pageSize",c)};a.defaults("fluid.pager",{gradeNames:["fluid.viewRelayComponent","autoInit"],events:{initiatePageChange:null,initiatePageSizeChange:null,onModelChange:null,onRenderPageLinks:null,afterRender:null},model:{pageIndex:0,pageSize:1,totalRange:{expander:{func:"{that}.acquireDefaultRange"}}},selectors:{pagerBar:".flc-pager-top, .flc-pager-bottom",summary:".flc-pager-summary",pageSize:".flc-pager-page-size"},strings:{last:" (last)"},markup:{rangeAnnotation:"<b> %first </b><br/>&mdash;<br/><b> %last </b>"},distributeOptions:{source:"{that}.options.pageList",removeSource:true,target:"{that fluid.pager.pageList}"},pageList:{type:"fluid.pager.renderedPageList",options:{pageStrategy:a.pager.gappedPageStrategy(3,1)}},modelRelay:[{target:"pageCount",singleTransform:{type:"fluid.transforms.free",args:{totalRange:"{that}.model.totalRange",pageSize:"{that}.model.pageSize"},func:"fluid.pager.computePageCount"}},{target:"pageIndex",singleTransform:{type:"fluid.transforms.limitRange",input:"{that}.model.pageIndex",min:0,max:"{that}.model.pageCount",excludeMax:1}}],modelListeners:{"":"{that}.events.onModelChange.fire({change}.value, {change}.oldValue, {that})"},listeners:{onCreate:{namespace:"containerRole","this":"{that}.container",method:"attr",args:["role","application"]},initiatePageChange:{funcName:"fluid.pager.initiatePageChangeListener",args:["{that}","{arguments}.0"]},initiatePageSizeChange:{funcName:"fluid.pager.initiatePageSizeChangeListener",args:["{that}","{arguments}.0"]}},invokers:{acquireDefaultRange:{funcName:"fluid.identity",args:"{that}.pagerBar.pageList.defaultModel.totalRange"}},dynamicComponents:{summary:{sources:"{that}.dom.summary",type:"fluid.pager.summary",container:"{source}",options:{strings:{message:"Viewing page %currentPage. Showing records %first - %last of %total items."},events:{onModelChange:"{pager}.events.onModelChange"}}},pageSize:{sources:"{that}.dom.pageSize",type:"fluid.pager.directPageSize",container:"{source}"},pagerBar:{sources:"{that}.dom.pagerBar",type:"fluid.pager.pagerBar",container:"{source}",options:{strings:"{pager}.options.strings",events:{initiatePageChange:"{pager}.events.initiatePageChange",onModelChange:"{pager}.events.onModelChange"}}}}})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.table");
a.table.findColumnDef=function(d,c){return a.find_if(d,function(e){return e.key===c})};a.table.getRoots=function(e,c,d){e.shortRoot=d;e.longRoot=a.pathUtil.composePath(c,e.shortRoot)};a.table.expandPath=function(d,e,c){if(d.charAt(0)==="*"){return c+d.substring(1)}else{return d.replace("*",e)}};a.table.fetchValue=function(c,f,e,h,d){a.table.getRoots(d,c,e);var g=a.table.expandPath(h,d.shortRoot,d.longRoot);return a.get(f,g)};a.table.rowComparator=function(c){return function(e,d){return(e.value>d.value?1:(e.value<d.value?-1:0))*c}};a.table.basicSorter=function(k,j,c,g){var d={};var e=a.table.findColumnDef(k,g.sortKey);var f=[];for(var h=0;h<g.totalRange;++h){f[h]={index:h,value:a.table.fetchValue(c,j,h,e.valuebinding,d)}}f.sort(a.table.rowComparator(g.sortDir));return a.getMembers(f,"index")};a.table.IDforColumn=function(e,h,d){var g=e.valuebinding;var f=e.key;if(!g){a.fail("Error in definition for column with key "+f+": valuebinding is not set")}if(!f){var c=a.model.parseEL(g);f=c[c.length-1]}return{ID:(h||"")+f,EL:a.table.expandPath(g,d.shortRoot,d.longRoot)}};a.table.bigHeaderForKey=function(d,c){var h=c.rendererOptions.idMap["header:"+d];var f=a.jById(h);if(f.length===0){return null}var g=c.selectors.headerSortStylisticOffset;var e=a.findAncestor(f,function(i){return b(i).is(g)});return e};a.table.setSortHeaderClass=function(e,d,c){d=b(d);d.removeClass(e.ascendingHeader);d.removeClass(e.descendingHeader);if(c!==0){d.addClass(c===1?e.ascendingHeader:e.descendingHeader);d.attr("aria-sort",c===1?"ascending":"descending")}};a.table.isCurrentColumnSortable=function(e,d){var c=d.sortKey?a.table.findColumnDef(e,d.sortKey):null;return c?c.sortable:false};a.table.setModelSortHeaderClass=function(g,e,c){var f=c.styles;var d=a.table.isCurrentColumnSortable(g,e)?e.sortDir:0;a.table.setSortHeaderClass(f,a.table.bigHeaderForKey(e.sortKey,c),d)};a.table.generateColumnClick=function(f,e,d,c){return function(){if(c.sortable===true){var g=f.model;var i=a.copy(g);var j=f.options.styles;var k=g.sortKey;if(c.key!==g.sortKey){i.sortKey=c.key;i.sortDir=1;var h=a.table.bigHeaderForKey(k,e);if(h){a.table.setSortHeaderClass(j,h,0)}}else{if(i.sortKey===c.key){i.sortDir=-1*i.sortDir}else{return false}}i.pageIndex=0;f.applier.requestChange("",i)}return false}};a.table.fetchHeaderDecorators=function(d,c){return d[c.sortable?"sortableHeader":"unsortableHeader"]};a.table.generateHeader=function(f,d,e){var c=d.strings.sortableColumnText;if(e.sortDir===1){c=d.strings.sortableColumnTextAsc}else{if(e.sortDir===-1){c=d.strings.sortableColumnTextDesc}}var g=f.options.columnDefs;return{children:a.transform(g,function(h){return{ID:a.table.IDforColumn(h,d.keyPrefix,{}).ID,value:h.label,decorators:[{jQuery:["click",a.table.generateColumnClick(f,d,e,h)]},{identify:"header:"+h.key},{type:"attrs",attributes:{title:(h.key===e.sortKey)?c:d.strings.sortableColumnText}}].concat(a.table.fetchHeaderDecorators(d.decorators,h))}})}};a.table.expandVariables=function(i,h){var g="";var d=0;while(true){var e=i.indexOf("${",d);if(e===-1){g+=i.substring(d);break}else{g+=i.substring(d,e);var c=i.indexOf("}",e+2);var f=i.substring(e+2,c);if(f==="VALUE"){f=h.EL}else{f=a.table.expandPath(f,h.shortRoot,h.longRoot)}var j=a.get(h.dataModel,f);g+=j;d=c+1}}return g};a.table.expandPaths=function(f,c,e){for(var d in c){var g=c[d];if(a.isMarker(g,a.VALUE)){if(d==="valuebinding"){f[d]=e.EL}else{f[d]={valuebinding:e.EL}}}else{if(d==="valuebinding"){f[d]=a.table.expandPath(c[d],e)}else{if(typeof(g)==="object"){f[d]=g.length!==undefined?[]:{};a.table.expandPaths(f[d],g,e)}else{if(typeof(g)==="string"){f[d]=a.table.expandVariables(g,e)}else{f[d]=c[d]}}}}}return f};a.table.expandColumnDefs=function(h,g,f,d,e){var c=a.transform(h,function(j){var i=a.table.IDforColumn(j,g,e);var l=b.extend({dataModel:f},e,i);var k;if(!j.components){return{ID:i.ID,valuebinding:i.EL}}else{if(typeof j.components==="function"){k=j.components(d.row,d.index)}else{k=j.components}}k=a.table.expandPaths({},k,l);k.ID=i.ID;return k});return c};a.table.fetchDataModel=function(d,c){return a.get(d,c)};a.table.produceTree=function(f,h){var e=h.options;var i=f.options.columnDefs;var d={};var c=a.transform(f.filtered,function(j){a.table.getRoots(d,f.options.dataOffset,j.index);if(i==="explode"){return a.explode(j.row,d.longRoot)}else{if(i.length){return a.table.expandColumnDefs(i,h.options.keyPrefix,f.dataModel,j,d)}}});var g={};g[e.row]=c;if(typeof(i)==="object"){g[e.header]=a.table.generateHeader(f,h.options,f.model)}return g};a.table.sortInvoker=function(e,d){var f=e.options.columnDefs;var c=a.table.isCurrentColumnSortable(f,d)?e.options.sorter(f,e.options.dataModel,e.options.dataOffset,d):null;e.permutation=c};a.table.onModelChange=function(d,e,c){e.sortInvoker(c);d.dataModel=d.fetchDataModel();d.filtered=d.options.modelFilter(d.dataModel,c,d.permutation)};a.defaults("fluid.table.selfRender",{gradeNames:["fluid.rendererRelayComponent","autoInit"],listeners:{onCreate:[{"this":"{that}.root",method:"addClass",args:"{that}.options.styles.root"}],onIndexModelChange:[{funcName:"fluid.table.onModelChange",namespace:"onModelChange",args:["{fluid.table}","{fluid.table.selfRender}","{arguments}.0","{arguments}.1"]},{func:"{that}.sortInvoker",namespace:"sortInvoker",args:"{arguments}.0"},{priority:"last",namespace:"refreshView",func:"{that}.refreshView"}],afterRender:{funcName:"fluid.table.setModelSortHeaderClass",args:["{that}.options.columnDefs","{fluid.table}.model","{that}.options"]}},modelListeners:{"{fluid.table}.model":"{that}.events.onIndexModelChange.fire({change}.value, {change}.oldValue)"},events:{onIndexModelChange:null},invokers:{sortInvoker:{funcName:"fluid.table.sortInvoker",args:["{fluid.table}","{arguments}.0"]},produceTree:{funcName:"fluid.table.produceTree",args:["{fluid.table}","{fluid.table.selfRender}"]}},selectors:{root:".flc-pager-body-template",headerSortStylisticOffset:"{table}.options.selectors.headerSortStylisticOffset",header:".flc-table-header",row:".flc-table-row"},repeatingSelectors:["header","row"],selectorsToIgnore:["root","headerSortStylisticOffset"],styles:{root:"fl-pager",ascendingHeader:"{table}.options.styles.ascendingHeader",descendingHeader:"{table}.options.styles.descendingHeader"},members:{root:"{that}.dom.root"},decorators:{sortableHeader:[],unsortableHeader:[]},keyStrategy:"id",keyPrefix:"",row:"row:",header:"header:",strings:"{table}.options.strings",columnDefs:"{table}.options.columnDefs",rendererFnOptions:{templateSource:{node:"{that}.dom.root"},renderTarget:"{that}.dom.root",noexpand:true},rendererOptions:{model:"{table}.options.dataModel",idMap:{}}});a.table.checkTotalRange=function(d,c){if(d===undefined&&!c){a.fail("Error in Pager configuration - cannot determine total range,  since not configured in model.totalRange and no PagerBar is configured")}};a.defaults("fluid.table",{gradeNames:["fluid.viewComponent","autoInit"],mergePolicy:{dataModel:"preserve",columnDefs:"noexpand"},components:{bodyRenderer:{type:"fluid.table.selfRender",container:"{table}.container"}},listeners:{onCreate:{funcName:"fluid.table.checkTotalRange",namespace:"checkTotalRange",args:["{that}.model.totalRange","{that}.pagerBar"]}},modelFilter:a.table.directModelFilter,sorter:a.table.basicSorter,members:{dataModel:{expander:{func:"{that}.fetchDataModel"}}},invokers:{fetchDataModel:{funcName:"fluid.table.fetchDataModel",args:["{that}.options.dataModel","{that}.options.dataOffset"]}},styles:{ascendingHeader:"fl-pager-asc",descendingHeader:"fl-pager-desc"},selectors:{headerSortStylisticOffset:".flc-pager-sort-header"},strings:{sortableColumnText:"Select to sort",sortableColumnTextDesc:"Select to sort in ascending, currently in descending order.",sortableColumnTextAsc:"Select to sort in descending, currently in ascending order."},dataOffset:"",columnDefs:[]})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.pagedTable");a.defaults("fluid.pagedTable.rangeAnnotator",{gradeNames:["fluid.eventedComponent","autoInit"]});a.pagedTable.rangeAnnotator.onRenderPageLinks=function(h,n,j,d){d.tooltip.close();var m={};var e=h.options.annotateColumnRange||(h.options.annotateSortedColumn?j.sortKey:null);if(!e){return}var i=h.options.dataModel;var f=h.options.columnDefs;var g=a.table.findColumnDef(f,e);function c(o){o=h.permutation?h.permutation[o]:o;return a.table.fetchValue(h.options.dataOffset,i,o,g.valuebinding,m)}var k={};a.model.copyModel(k,j);var l={};a.each(n,function(o){if(o.ID==="page-link:link"&&!o.current){var r=o.pageIndex;var t=r*k.pageSize;k.pageIndex=r;var p=a.pager.computePageLimit(k);var s=c(t);var q=c(p-1);l[r]={first:s,last:q}}});d.tooltipInfo=l};a.pagedTable.directModelFilter=function(f,e,h){var j=[];var c=a.pager.computePageLimit(e);for(var g=e.pageIndex*e.pageSize;g<c;++g){var d=h?h[g]:g;j[j.length]={index:d,row:f[d]}}return j};a.pagedTable.configureTooltip=function(g,d,c){var e=c.rendererOptions.idMap;var f={};a.each(d.tooltipInfo,function(i,h){f[e["pageLink:"+h]]=a.stringTemplate(g.options.markup.rangeAnnotation,i)});d.tooltip.applier.requestChange("idToContent",f)};a.defaults("fluid.pagedTable",{gradeNames:["fluid.pager","fluid.table","autoInit"],distributeOptions:[{target:"{that renderedPageList}.options.listeners.afterRender",record:{funcName:"fluid.pagedTable.configureTooltip",args:["{pagedTable}","{pagerBar}","{arguments}.0"]}},{target:"{that renderedPageList}.options.listeners.onRenderPageLinks",record:{funcName:"fluid.pagedTable.rangeAnnotator.onRenderPageLinks",args:["{pagedTable}","{arguments}.0","{arguments}.1","{pagerBar}"]}},{target:"{that pagerBar}.options.components.tooltip",source:"{that}.options.tooltip"}],annotateSortedColumn:false,annotateColumnRange:undefined,markup:{rangeAnnotation:"<b> %first </b><br/>&mdash;<br/><b> %last </b>"},tooltip:{type:"fluid.tooltip",container:"{that}.container",options:{}},invokers:{acquireDefaultRange:{funcName:"fluid.identity",args:"{that}.dataModel.length"}},modelFilter:a.pagedTable.directModelFilter,model:{pageSize:10}})
})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.progress");a.progress.animateDisplay=function(f,d,c,e){d=(d)?d:c;f.animate(d.params,d.duration,e)};a.progress.animateProgress=function(e,c,d){e.queue("fx",[]);e.animate({width:c,queue:false},d)};a.progress.showProgress=function(d,e){var c=d.events.onProgressBegin.fire;if(e===false){d.displayElement.show();c()}else{a.progress.animateDisplay(d.displayElement,e,d.options.showAnimation,c)}};a.progress.hideProgress=function(e,c,f){if(c){setTimeout(function(){a.progress.hideProgress(e,0,f)},c)}else{var d=e.events.afterProgressHidden.fire;if(f===false){e.displayElement.hide();d()}else{a.progress.animateDisplay(e.displayElement,f,e.options.hideAnimation,d)}}};a.progress.updateWidth=function(e,d,g){var c=e.indicator.width();var f=e.options.animate;if((d>c)&&(f==="both"||f==="forward")&&!g){a.progress.animateProgress(e.indicator,d,e.options.speed)}else{if((d<c)&&(f==="both"||f==="backward")&&!g){a.progress.animateProgress(e.indicator,d,e.options.speed)}else{e.indicator.width(d)}}};a.progress.percentToPixels=function(d,c){return Math.round((Math.min(c,100)*d.progressBar.innerWidth())/100)};a.progress.refreshRelativeWidth=function(c){var d=Math.max(a.progress.percentToPixels(c,parseFloat(c.storedPercent)),c.options.minWidth);a.progress.updateWidth(c,d,true)};a.progress.initARIA=function(c,d){c.attr("role","progressbar");c.attr("aria-valuemin","0");c.attr("aria-valuemax","100");c.attr("aria-valuenow","0");if(d){c.attr("aria-valuetext","")}c.attr("aria-busy","false")};a.progress.updateARIA=function(f,e){var g=f.options.strings;var d=e<100&&e>0;f.ariaElement.attr("aria-busy",d);f.ariaElement.attr("aria-valuenow",e);if(g.ariaBusyText){if(d){var c=a.stringTemplate(g.ariaBusyText,{percentComplete:e});f.ariaElement.attr("aria-valuetext",c)}else{if(e===100){f.ariaElement.attr("aria-valuetext",g.ariaDoneText)}}}};a.progress.updateText=function(c,d){c.html(d)};a.progress.repositionIndicator=function(c){c.indicator.css("top",c.progressBar.position().top).css("left",0).height(c.progressBar.height());a.progress.refreshRelativeWidth(c)};a.progress.updateProgress=function(e,d,c,g){a.progress.showProgress(e,g);if(d!==null){e.storedPercent=d;var f=Math.max(a.progress.percentToPixels(e,parseFloat(d)),e.options.minWidth);a.progress.updateWidth(e,f)}if(c!==null){a.progress.updateText(e.label,c)}if(e.ariaElement){a.progress.updateARIA(e,d)}};a.progress.hideElement=function(d,c){d.toggle(!c)};a.defaults("fluid.progress",{gradeNames:["fluid.viewComponent","autoInit"],members:{displayElement:"{that}.dom.displayElement",progressBar:"{that}.dom.progressBar",label:"{that}.dom.label",indicator:"{that}.dom.indicator",ariaElement:"{that}.dom.ariaElement",storedPercent:0},events:{onProgressBegin:null,afterProgressHidden:null},listeners:{onCreate:[{"this":"{that}.dom.indicator",method:"width",args:"{that}.options.minWidth"},{funcName:"fluid.progress.hideElement",args:["{that}.dom.displayElement","{that}.options.initiallyHidden"]},{funcName:"fluid.progress.initARIA",args:["{that}.ariaElement","{that}.options.strings.ariaBusyText"]}],onProgressBegin:{func:"{that}.options.showAnimation.callback"},afterProgressHidden:{func:"{that}.options.hideAnimation.callback"}},invokers:{show:{funcName:"fluid.progress.showProgress",args:["{that}","{arguments}.0"]},hide:{funcName:"fluid.progress.hideProgress",args:["{that}","{arguments}.0","{arguments}.1"]},update:{funcName:"fluid.progress.updateProgress",args:["{that}","{arguments}.0","{arguments}.1","{arguments}.2"]},refreshView:{funcName:"fluid.progress.repositionIndicator",args:"{that}"}},selectors:{displayElement:".flc-progress",progressBar:".flc-progress-bar",indicator:".flc-progress-indicator",label:".flc-progress-label",ariaElement:".flc-progress-bar"},strings:{ariaBusyText:"Progress is %percentComplete percent complete",ariaDoneText:"Progress is complete."},showAnimation:{params:{opacity:"show"},duration:"slow",callback:a.identity},hideAnimation:{params:{opacity:"hide"},duration:"slow",callback:a.identity},minWidth:5,delay:0,speed:200,animate:"forward",initiallyHidden:true,updatePosition:false})})(jQuery,fluid_1_5);if(!this.JSON){JSON=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}if(typeof value.toJSON==="function"){return stringify(value.toJSON())}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||"null")}return"["+a.join(",")+"]"}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}else{for(k in value){if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==="object"){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n}}}}return filter(k,v)}if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(:?[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof filter==="function"?walk("",j):j}throw new SyntaxError("parseJSON")}}}()}var fluid_1_5=fluid_1_5||{};(function(b,a){a.dom.computeAbsolutePosition=function(c){var e=0,d=0;if(c.offsetParent){do{e+=c.offsetLeft;d+=c.offsetTop;c=c.offsetParent}while(c);return[e,d]}};a.dom.cleanseScripts=function(c){var d=b.data(c,a.dom.cleanseScripts.MARKER);if(!d){a.dom.iterateDom(c,function(e){return e.tagName.toLowerCase()==="script"?"delete":null});b.data(c,a.dom.cleanseScripts.MARKER,true)}};a.dom.cleanseScripts.MARKER="fluid-scripts-cleansed";a.dom.insertAfter=function(c,d){var e=d.nextSibling;if(!e){d.parentNode.appendChild(c)}else{d.parentNode.insertBefore(c,e)}};a.dom.isWhitespaceNode=function(c){return !(/[^\t\n\r ]/.test(c.data))};a.dom.isIgnorableNode=function(c){return(c.nodeType===8)||((c.nodeType===3)&&a.dom.isWhitespaceNode(c))}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(d,b){b.orientation={HORIZONTAL:4,VERTICAL:1};b.rectSides={4:["left","right"],1:["top","bottom"],8:"top",12:"bottom",2:"left",3:"right"};b.position={BEFORE:-1,AFTER:1,INSIDE:2,REPLACE:3};b.direction={NEXT:1,PREVIOUS:-1,UP:8,DOWN:12,LEFT:2,RIGHT:3};b.directionSign=function(f){return f===b.direction.UP||f===b.direction.LEFT?b.direction.PREVIOUS:b.direction.NEXT};b.directionAxis=function(f){return f===b.direction.LEFT||f===b.direction.RIGHT?0:1};b.directionOrientation=function(f){return b.directionAxis(f)?b.orientation.VERTICAL:b.orientation.HORIZONTAL};b.keycodeDirection={up:b.direction.UP,down:b.direction.DOWN,left:b.direction.LEFT,right:b.direction.RIGHT};b.registerNamespace("fluid.dom");b.dom.moveDom=function(h,i,f){h=b.unwrap(h);i=b.unwrap(i);var g;if(f===b.position.INSIDE){i.appendChild(h)}else{if(f===b.position.BEFORE){for(g=i.previousSibling;;g=g.previousSibling){if(!g||!b.dom.isIgnorableNode(g)){if(g!==h){b.dom.cleanseScripts(h);i.parentNode.insertBefore(h,i)}break}}}else{if(f===b.position.AFTER){for(g=i.nextSibling;;g=g.nextSibling){if(!g||!b.dom.isIgnorableNode(g)){if(g!==h){b.dom.cleanseScripts(h);b.dom.insertAfter(h,i)}break}}}else{b.fail("Unrecognised position supplied to fluid.moveDom: "+f)}}}};b.dom.normalisePosition=function(g,i,f,h){if(g===b.position.REPLACE){g=i&&f>=h?b.position.AFTER:b.position.BEFORE}return g};b.dom.permuteDom=function(j,n,m,g,k){j=b.unwrap(j);n=b.unwrap(n);var l=d.inArray(j,g);if(l===-1){b.fail("Error in permuteDom: source element "+b.dumpEl(j)+" not found in source list "+b.dumpEl(g))}var r=d.inArray(n,k);if(r===-1){b.fail("Error in permuteDom: target element "+b.dumpEl(n)+" not found in source list "+b.dumpEl(k))}var f=g===k;m=b.dom.normalisePosition(m,f,r,l);var q={};q[b.position.AFTER]=j.nextSibling;q[b.position.BEFORE]=j.previousSibling;b.dom.moveDom(g[l],k[r],m);var p=f?r-1:g.length-2;var h;if(m===b.position.BEFORE&&f){p--}if(!f||r>l){for(h=p;h>l;--h){b.dom.moveDom(g[h+1],g[h],b.position.AFTER)}if(l+1<g.length){b.dom.moveDom(g[l+1],q[b.position.AFTER],b.position.BEFORE)}}var o=f?l-1:k.length-1;if(m===b.position.AFTER){r++}if(!f||r<l){for(h=r;h<o;++h){b.dom.moveDom(k[h],k[h+1],b.position.BEFORE)}if(o>=0&&o<k.length-1){b.dom.moveDom(k[o],q[b.position.BEFORE],b.position.AFTER)}}};var e=function(f,g){return window.getComputedStyle?window.getComputedStyle(f,null).getPropertyValue(g):f.currentStyle[g]};b.dom.isAttached=function(f){while(f&&f.nodeName){if(f.nodeName==="BODY"){return true}f=f.parentNode}return false};b.dom.generalHidden=function(f){return"hidden"===f.type||e(f,"display")==="none"||e(f,"visibility")==="hidden"||!b.dom.isAttached(f)};b.registerNamespace("fluid.geometricManager");b.geometricManager.computeGeometry=function(h,g,l){var j={};j.element=h;j.orientation=g;if(l===b.position.INSIDE){j.position=l}if(b.dom.generalHidden(h)){j.clazz="hidden"}var k=b.dom.computeAbsolutePosition(h)||[0,0];var i=h.offsetWidth;var f=h.offsetHeight;j.rect={left:k[0],top:k[1]};j.rect.right=k[0]+i;j.rect.bottom=k[1]+f;return j};var a=10000;b.geometricManager.dumprect=function(f){return"Rect top: "+f.top+" left: "+f.left+" bottom: "+f.bottom+" right: "+f.right};b.geometricManager.dumpelem=function(f){if(!f||!f.rect){return"null"
}else{return b.geometricManager.dumprect(f.rect)+" position: "+f.position+" for "+b.dumpEl(f.element)}};b.dropManager=function(){var g=[];var i={};var k={};var f;var h;var m,l;k.updateGeometry=function(u){h=u;g=[];i={};var n=u.elementMapper;var v=u.geometryComputor||b.geometricManager.computeGeometry;var o=function(D,H,B,y,z,G){var x=H.orientation;var A=b.rectSides[x];var C=v(D,x,z);C.owner=H;if(C.clazz!=="hidden"&&n){C.clazz=n(D)}i[b.dropManager.cacheKey(D)]=C;var F=b.dropManager.getRelativeClass(H.elements,G,b.position.BEFORE,C.clazz,n);var E=b.dropManager.getRelativeClass(H.elements,G,b.position.AFTER,C.clazz,n);if(z===b.position.INSIDE){g[g.length]=C}else{b.dropManager.splitElement(g,A,C,z,F,E)}if(B&&u.sentinelize){b.dropManager.sentinelizeElement(g,A,C,1,z,F)}if(y&&u.sentinelize){b.dropManager.sentinelizeElement(g,A,C,0,z,E)}return C};for(var t=0;t<u.extents.length;++t){var p=u.extents[t];var w=true;for(var q=0;q<p.elements.length;++q){var s=p.elements[q];var r=o(s,p,q===0,q===p.elements.length-1,b.position.INTERLEAVED,q);if(r.clazz!=="hidden"){w=false}}if(w&&p.parentElement){o(p.parentElement,p,true,true,b.position.INSIDE)}}b.dropManager.normalizeSentinels(g)};k.startDrag=function(s,r,p,q){var u=r[0]+p/2;var t=r[1]+q/2;var o=u-s.pageX;var n=t-s.pageY;k.updateGeometry(h);f=null;m=o;l=n;d("body").bind("mousemove.fluid-dropManager",k.mouseMove)};k.lastPosition=function(){return f};k.endDrag=function(){d("body").unbind("mousemove.fluid-dropManager")};k.mouseMove=function(o){var n=o.pageX+m;var q=o.pageY+l;var p=k.closestTarget(n,q,f);if(p&&p!==b.dropManager.NO_CHANGE){f=p;k.dropChangeFirer.fire(p)}};k.dropChangeFirer=b.event.getEventFirer();var j={element:null};k.closestTarget=function(w,u,r){var q=Number.MAX_VALUE;var o=j;var n=Number.MAX_VALUE;var v=j;for(var t=0;t<g.length;++t){var s=g[t];if(s.clazz==="hidden"){continue}var p=b.geom.minPointRectangle(w,u,s.rect);if(s.clazz==="locked"){if(p<n){n=p;v=s}}else{if(p<q){q=p;o=s}if(p===0){break}}}if(!o){return o}if(n>=q){v=j}if(r&&r.position===o.position&&b.unwrap(r.element)===b.unwrap(o.element)&&b.unwrap(r.lockedelem)===b.unwrap(v.element)){return b.dropManager.NO_CHANGE}return{position:o.position,element:o.element,lockedelem:v.element}};k.shuffleProjectFrom=function(o,r,q,n){var p=k.projectFrom(o,r,q,n);if(p){p.position=b.position.REPLACE}return p};k.projectFrom=function(r,t,s,q){k.updateGeometry(h);var p=i[b.dropManager.cacheKey(r)];var o=b.geom.projectFrom(p.rect,t,g,s,q);if(!o.cacheelem){return null}var n=o.cacheelem.position;return{element:o.cacheelem.element,position:n?n:b.position.BEFORE}};k.logicalFrom=function(p,r,q,o){var n=k.getOwningSpan(p,b.position.INTERLEAVED,q);return{element:b.dropManager.getRelativeElement(p,r,n,o),position:b.position.REPLACE}};k.lockedWrapFrom=function(q,u,t,p){var s=k.logicalFrom(q,u,t,p);var n=k.getOwningSpan(q,b.position.INTERLEAVED,t);var r=i[b.dropManager.cacheKey(q)].owner.elements;if(t||n[0]===r[0]){return s}var o=b.dropManager.getRelativeElement(q,u,r,p);if(h.elementMapper(o)==="locked"){s.element=null;s.clazz="locked"}return s};k.getOwningSpan=function(p,o,r){var n=i[b.dropManager.cacheKey(p)].owner;var q=o===b.position.INSIDE?[n.parentElement]:n.elements;if(!r&&h.elementMapper){q=b.makeArray(q);b.remove_if(q,function(s){return h.elementMapper(s)==="locked"})}return q};k.geometricMove=function(q,r,n){var o=k.getOwningSpan(q,null,true);var p=k.getOwningSpan(r,n,true);b.dom.permuteDom(q,r,n,o,p)};return k};b.dropManager.NO_CHANGE="no change";b.dropManager.cacheKey=function(f){return b.allocateSimpleId(f)};b.dropManager.sentinelizeElement=function(f,k,i,j,l,h){var g=d.extend(true,{},i);g.origRect=b.copy(g.rect);g.rect[k[j]]=g.rect[k[1-j]]+(j?1:-1);g.rect[k[1-j]]=(j?-1:1)*a;g.position=l===b.position.INSIDE?l:(j?b.position.BEFORE:b.position.AFTER);g.clazz=h;f[f.length]=g};b.dropManager.normalizeSentinels=function(f){for(var l=0;l<f.length;++l){for(var g=0;g<f.length;++g){var m=f[l],k=f[g];var h=k.origRect||k.rect;if(m.element!==k.element&&m.origRect&&b.geom.minRectRect(m.rect,h)===0){m.rect=m.origRect;delete m.origRect}}}};b.dropManager.splitElement=function(i,g,h,f,k,j){var n=d.extend(true,{},h);var l=d.extend(true,{},h);var m=(n.rect[g[0]]+n.rect[g[1]])/2;n.rect[g[1]]=m;n.position=b.position.BEFORE;l.rect[g[0]]=m;l.position=b.position.AFTER;n.clazz=k;l.clazz=j;i[i.length]=n;i[i.length]=l};b.dropManager.getRelativeClass=function(h,g,i,f,j){g+=i;if(g<0&&f==="locked"){return"locked"}if(g>=h.length||j===null){return null}else{i=h[g];return j(i)==="locked"&&f==="locked"?"locked":null}};b.dropManager.getRelativeElement=function(h,j,i,g){var k=b.directionSign(j);var f=d(i).index(h)+k;if(f<0){f+=i.length}if(g){if(f===i.length||f===(i.length+k)){return h}}f%=i.length;return i[f]};b.geom=b.geom||{};b.geom.minPointRectangle=function(f,j,i){var h=f<i.left?(i.left-f):(f>i.right?(f-i.right):0);var g=j<i.top?(i.top-j):(j>i.bottom?(j-i.bottom):0);return h*h+g*g};b.geom.minRectRect=function(i,g){var h=i.right<g.left?g.left-i.right:g.right<i.left?i.left-g.right:0;var f=i.bottom<g.top?g.top-i.bottom:g.bottom<i.top?i.top-g.bottom:0;return h*h+f*f};var c=function(){return{mindist:Number.MAX_VALUE,minrdist:Number.MAX_VALUE}};b.geom.projectFrom=function(k,x,y,r,m){var h=b.directionAxis(x);var u=b.rectSides[x];var s=b.rectSides[h*15+5-x];var o=b.directionSign(x);var f={left:(7*k.left+1*k.right)/8,right:(5*k.left+3*k.right)/8,top:(7*k.top+1*k.bottom)/8,bottom:(5*k.top+3*k.bottom)/8};f[u]=o*a;f[s]=-f[u];function z(C,A,D){var B=A.rect;var E=b.geom.minRectRect(f,B);var i=-o*D*(k[D===1?u:s]-B[D===1?s:u]);if(E<=C.mindist&&i>=0){if(E===C.mindist&&i*D>C.minrdist){return}C.minrdist=i*D;C.mindist=E;C.minelem=A}}var p=c();var t=c();var j=c();for(var v=0;v<y.length;++v){var w=y[v];var g=w.owner&&w.element===w.owner.parentElement;if(w.clazz==="hidden"||(r&&g)){continue}else{if(!r&&w.clazz==="locked"){z(j,w,1)}else{z(p,w,1);z(t,w,-1)}}}var n=!p.minelem||t.mindist<p.mindist;n=n&&!m;var q=n?t:p;var l={wrapped:n,cacheelem:q.minelem};if(j.mindist<q.mindist){l.lockedelem=j.minelem}return l}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(c,b){b.reorderer=b.registerNamespace("fluid.reorderer");b.reorderer.defaultAvatarCreator=function(h,e,f){b.dom.cleanseScripts(b.unwrap(h));var g=c(h).clone();b.dom.iterateDom(g.get(0),function(i){i.removeAttribute("id");if(i.tagName.toLowerCase()==="input"){i.setAttribute("disabled","disabled")}});g.removeProp("id");g.removeClass("ui-droppable");g.addClass(e);if(f){var d=c(document.createElement("div"));d.append(g);d.append(f);g=d}c("body").append(g);if(!c.browser.safari){g.css("display","block").width(h.offsetWidth).height(h.offsetHeight)}if(c.browser.opera){g.hide()}return g};b.reorderer.bindHandlersToContainer=function(d,f,g){var e=f;var h=false;if(c.browser.opera){d.keypress(function(i){if(h){h=false;i.preventDefault();return false}});e=function(j){var i=f(j);if(i===false){h=true}}}d.keydown(e);d.keyup(g)};b.reorderer.addRolesToContainer=function(d){d.container.attr("role",d.options.containerRole.container);d.container.attr("aria-multiselectable","false");d.container.attr("aria-readonly","false");d.container.attr("aria-disabled","false")};b.reorderer.createAvatarId=function(d){return d+"_avatar"};b.reorderer.keys={TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:19,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,i:73,j:74,k:75,m:77};b.reorderer.defaultKeysets=[{modifier:function(d){return d.ctrlKey},up:b.reorderer.keys.UP,down:b.reorderer.keys.DOWN,right:b.reorderer.keys.RIGHT,left:b.reorderer.keys.LEFT},{modifier:function(d){return d.ctrlKey},up:b.reorderer.keys.i,down:b.reorderer.keys.m,right:b.reorderer.keys.k,left:b.reorderer.keys.j}];b.defaults("fluid.reorderer",{gradeNames:["fluid.viewComponent","autoInit"],styles:{defaultStyle:"fl-reorderer-movable-default",selected:"fl-reorderer-movable-selected",dragging:"fl-reorderer-movable-dragging",mouseDrag:"fl-reorderer-movable-dragging",hover:"fl-reorderer-movable-hover",dropMarker:"fl-reorderer-dropMarker",avatar:"fl-reorderer-avatar"},selectors:{dropWarning:".flc-reorderer-dropWarning",movables:".flc-reorderer-movable",selectables:".flc-reorderer-movable",dropTargets:".flc-reorderer-movable",grabHandle:"",stylisticOffset:""},avatarCreator:b.reorderer.defaultAvatarCreator,keysets:b.reorderer.defaultKeysets,containerRole:"{that}.layoutHandler.options.containerRole",selectablesTabindex:"{that}.layoutHandler.options.selectablesTabindex",layoutHandler:"fluid.listLayoutHandler",members:{activeItem:null,kbDropWarning:"{that}.dom.dropWarning"},events:{onShowKeyboardDropWarning:null,onSelect:null,onBeginMove:"preventable",onMove:null,afterMove:null,onHover:null,onRefresh:null},listeners:{onCreate:[{funcName:"fluid.reorderer.bindHandlersToContainer",args:["{that}.container","{that}.handleKeyDown","{that}.handleKeyUp"]},{funcName:"fluid.reorderer.addRolesToContainer",args:"{that}"},{funcName:"fluid.tabbable",args:"{that}.container"},{funcName:"fluid.reorderer.processAfterMoveCallbackUrl",args:"{that}"},"{that}.refresh"],onRefresh:{listener:"fluid.reorderer.initItems",args:"{that}",priority:-1000},onHover:{funcName:"fluid.reorderer.hoverStyleHandler",args:["{that}.dom","{that}.options.styles","{arguments}.0","{arguments}.1"]}},invokers:{changeSelectedToDefault:{funcName:"fluid.reorderer.changeSelectedToDefault",args:["{arguments}.0","{that}.options.styles"]},setDropEffects:{funcName:"fluid.reorderer.setDropEffects",args:["{that}.dom","{arguments}.0"]},createDropMarker:{funcName:"fluid.reorderer.createDropMarker",args:["{arguments}.0","{that}.options.styles.dropMarker"]},refresh:{funcName:"fluid.reorderer.refresh",args:["{that}.dom","{that}.events","{that}.selectableContext","{that}.activeItem"],dynamic:true},selectItem:{funcName:"fluid.reorderer.selectItem",args:["{that}","{arguments}.0"]},initSelectables:{funcName:"fluid.reorderer.initSelectables",args:["{that}"]},initMovable:{funcName:"fluid.reorderer.initMovable",args:["{that}","{that}.dropManager","{arguments}.0"]},isMove:{funcName:"fluid.reorderer.isMove",args:["{that}.options.keysets","{arguments}.0"]},isActiveItemMovable:{funcName:"fluid.reorderer.isActiveItemMovable",args:["{that}.activeItem","{that}.dom"],dynamic:true},handleKeyDown:{funcName:"fluid.reorderer.handleKeyDown",args:["{that}","{that}.options.styles","{arguments}.0"]},handleDirectionKeyDown:{funcName:"fluid.reorderer.handleDirectionKeyDown",args:["{that}","{arguments}.0"]},handleKeyUp:{funcName:"fluid.reorderer.handleKeyUp",args:["{that}","{that}.options.styles","{arguments}.0"]},requestMovement:{funcName:"fluid.reorderer.requestMovement",args:["{that}","{arguments}.0","{arguments}.1"]}},mergePolicy:{keysets:"replace","selectors.labelSource":"selectors.grabHandle","selectors.selectables":"selectors.movables","selectors.dropTargets":"selectors.movables"},components:{layoutHandler:{type:"{that}.options.layoutHandler",container:"{reorderer}.container"},dropManager:{type:"fluid.dropManager"},labeller:{type:"fluid.reorderer.labeller",options:{members:{dom:"{reorderer}.dom"},getGeometricInfo:"{reorderer}.layoutHandler.getGeometricInfo",orientation:"{reorderer}.layoutHandler.options.orientation",layoutType:"{reorderer}.options.layoutHandler"}}},disableWrap:false});
b.reorderer.noModifier=function(d){return(!d.ctrlKey&&!d.altKey&&!d.shiftKey&&!d.metaKey)};b.reorderer.isMove=function(f,d){for(var e=0;e<f.length;e++){if(f[e].modifier(d)){return true}}return false};b.reorderer.isActiveItemMovable=function(e,d){return c.inArray(e,d.fastLocate("movables"))>=0};b.reorderer.handleKeyDown=function(e,f,d){if(!e.activeItem||e.activeItem!==d.target){return true}var g=c(e.activeItem);if(!g.hasClass(f.dragging)&&e.isMove(d)){if(e.isActiveItemMovable()){g.removeClass(f.selected);g.addClass(f.dragging);g.attr("aria-grabbed","true");e.setDropEffects("move")}return false}return e.handleDirectionKeyDown(d)};b.reorderer.handleDirectionKeyDown=function(p,m){var o=p.activeItem;if(!o){return true}var d=p.options.keysets;for(var h=0;h<d.length;h++){var f=d[h];var l=b.keyForValue(f,m.keyCode);if(!l){continue}var n=f.modifier(m);var e=b.keycodeDirection[l];var j=p.layoutHandler.getRelativePosition(o,e,!n);if(!j){continue}if(n){var k=p.events.onBeginMove.fire(o);if(k===false){return false}var g=p.kbDropWarning;if(g.length>0){if(j.clazz==="locked"){p.events.onShowKeyboardDropWarning.fire(o,g);g.show()}else{g.hide()}}if(j.element){p.requestMovement(j,o)}}else{if(b.reorderer.noModifier(m)){b.blur(o);b.focus(c(j.element))}}return false}return true};b.reorderer.handleKeyUp=function(e,f,d){if(!e.activeItem||e.activeItem!==d.target){return true}var g=c(e.activeItem);if(g.hasClass(f.dragging)&&!e.isMove(d)){if(e.kbDropWarning){e.kbDropWarning.hide()}g.removeClass(f.dragging);g.addClass(f.selected);g.attr("aria-grabbed","false");e.setDropEffects("none");return false}return false};b.reorderer.requestMovement=function(d,f,e){e=b.unwrap(e);if(!f||b.unwrap(f.element)===e){return}var g=c(d.activeItem);g.unbind("blur.fluid.reorderer");d.events.onMove.fire(e,f);d.dropManager.geometricMove(e,f.element,f.position);b.focus(g);d.refresh();d.dropManager.updateGeometry(d.layoutHandler.getGeometricInfo());d.events.afterMove.fire(e,f,d.dom.fastLocate("movables"))};b.reorderer.hoverStyleHandler=function(g,e,d,f){g.fastLocate("grabHandle",d)[f?"addClass":"removeClass"](e.hover)};b.reorderer.processAfterMoveCallbackUrl=function(d){var e=d.options;if(e.afterMoveCallbackUrl){d.events.afterMove.addListener(function(){var f=d.layoutHandler;var g=f.getModel?f.getModel():e.acquireModel(d);c.post(e.afterMoveCallbackUrl,JSON.stringify(g))},"postModel")}};b.reorderer.postInit=function(d){if(d.kbDropWarning){d.mouseDropWarning=d.kbDropWarning.clone()}d.options.keysets=b.makeArray(d.options.keysets)};b.reorderer.setDropEffects=function(e,d){e.fastLocate("dropTargets").attr("aria-dropeffect",d)};b.reorderer.createDropMarker=function(e,f){var d=c(document.createElement(e));d.addClass(f);d.hide();return d};b.reorderer.changeSelectedToDefault=function(d,e){d.removeClass(e.selected);d.removeClass(e.dragging);d.addClass(e.defaultStyle);d.attr("aria-selected","false")};b.reorderer.initSelectables=function(f){var j=function(i){f.changeSelectedToDefault(c(this));return i.stopPropagation()};var k=function(i){f.selectItem(this);return i.stopPropagation()};var e=function(i){var l=b.unwrap(f.dom.fastLocate("grabHandle",this));if(b.dom.isContainer(l,i.target)){c(this).focus()}};var d=f.dom.fastLocate("selectables");for(var h=0;h<d.length;++h){var g=c(d[h]);if(!c.data(g[0],"fluid.reorderer.selectable-initialised")){g.addClass(f.options.styles.defaultStyle);g.bind("blur.fluid.reorderer",j);g.focus(k);g.click(e);g.attr("role",f.options.containerRole.item);g.attr("aria-selected","false");g.attr("aria-disabled","false");c.data(g[0],"fluid.reorderer.selectable-initialised",true)}}if(!f.selectableContext){f.selectableContext=b.selectable(f.container,{selectableElements:d,selectablesTabindex:f.options.selectablesTabindex,direction:null})}};b.reorderer.selectItem=function(e,g){e.events.onSelect.fire(g);if(e.activeItem&&e.activeItem!==g){e.changeSelectedToDefault(c(e.activeItem))}e.activeItem=g;var d=c(g);var f=e.options.styles;d.removeClass(f.defaultStyle);d.addClass(f.selected);d.attr("aria-selected","true")};b.reorderer.initMovable=function(e,d,i){var g=e.options;var h=g.styles;i.attr("aria-grabbed","false");i.mouseover(function(){e.events.onHover.fire(i,true)});i.mouseout(function(){e.events.onHover.fire(i,false)});var f;var j=e.dom.fastLocate("grabHandle",i);i.draggable({refreshPositions:false,scroll:true,helper:function(){var k;if(e.mouseDropWarning){k=e.mouseDropWarning[0]}f=c(g.avatarCreator(i[0],h.avatar,k));f.prop("id",b.reorderer.createAvatarId(e.container.id));return f},start:function(p){var l=e.events.onBeginMove.fire(i);if(l===false){return false}var o=e.dom.fastLocate("grabHandle",i)[0];var n=b.dom.computeAbsolutePosition(o);var k=o.offsetWidth;var m=o.offsetHeight;i.focus();i.removeClass(g.styles.selected);i.addClass(g.styles.mouseDrag);i.attr("aria-grabbed","true");e.setDropEffects("move");d.startDrag(p,n,k,m);f.show()},stop:function(m,l){i.removeClass(g.styles.mouseDrag);i.addClass(g.styles.selected);c(e.activeItem).attr("aria-grabbed","false");var k=b.unwrap(e.dropMarker);if(k.parentNode){k.parentNode.removeChild(k)}f.hide();l.helper=null;e.setDropEffects("none");d.endDrag();e.requestMovement(d.lastPosition(),i);e.activeItem.focus()},handle:j===i?null:j})};b.reorderer.initItems=function(d){var j=d.dom.fastLocate("movables");var h=d.dom.fastLocate("dropTargets");d.initSelectables();for(var e=0;e<j.length;e++){var f=j[e];if(!c.data(f,"fluid.reorderer.movable-initialised")){d.initMovable(c(f));c.data(f,"fluid.reorderer.movable-initialised",true)}}if(j.length>0&&!d.dropMarker){d.dropMarker=d.createDropMarker(j[0].tagName)}d.dropManager.updateGeometry(d.layoutHandler.getGeometricInfo());var g=function(i){b.dom.moveDom(d.dropMarker,i.element,i.position);d.dropMarker.css("display","");if(d.mouseDropWarning){if(i.lockedelem){d.mouseDropWarning.show()}else{d.mouseDropWarning.hide()}}};d.dropManager.dropChangeFirer.addListener(g,"fluid.reorderer");h.attr("aria-dropeffect","none")};b.reorderer.refresh=function(g,e,d,f){g.refresh("movables");g.refresh("selectables");g.refresh("grabHandle",g.fastLocate("movables"));g.refresh("stylisticOffset",g.fastLocate("movables"));g.refresh("dropTargets");if(d){d.selectables=g.fastLocate("selectables");d.selectablesUpdated(f)}e.onRefresh.fire()};b.reorderer.roles={GRID:{container:"grid",item:"gridcell"},LIST:{container:"list",item:"listitem"},REGIONS:{container:"main",item:"article"}};var a=function(d,e,f){f=f||{};f.layoutHandler=e;return b.reorderer(d,f)};b.reorderList=function(d,e){return a(d,"fluid.listLayoutHandler",e)};b.reorderGrid=function(d,e){return a(d,"fluid.gridLayoutHandler",e)};b.reorderer.SHUFFLE_GEOMETRIC_STRATEGY="shuffleProjectFrom";b.reorderer.GEOMETRIC_STRATEGY="projectFrom";b.reorderer.LOGICAL_STRATEGY="logicalFrom";b.reorderer.WRAP_LOCKED_STRATEGY="lockedWrapFrom";b.reorderer.NO_STRATEGY=null;b.reorderer.relativeInfoGetter=function(e,h,f,d,g){return function(j,l,i){var k=b.directionOrientation(l);var m=k===e?h:f;return m!==null?d[m](j,l,i,g):null}};b.reorderer.makeGeometricInfoGetter=function(d,f,e){return function(){var g={sentinelize:f,extents:[{orientation:d,elements:e.fastLocate("dropTargets")}],elementMapper:function(h){return c.inArray(h,e.fastLocate("movables"))===-1?"locked":null},elementIndexer:function(i){var h=e.fastLocate("selectables");return{elementClass:g.elementMapper(i),index:c.inArray(i,h),length:h.length}}};return g}};b.defaults("fluid.layoutHandler",{gradeNames:["fluid.viewComponent"],disableWrap:"{reorderer}.options.disableWrap",members:{reordererDom:"{reorderer}.dom"},components:{dropManager:"{reorderer}.dropManager"}});b.defaults("fluid.listLayoutHandler",{gradeNames:["fluid.layoutHandler","autoInit"],orientation:b.orientation.VERTICAL,containerRole:b.reorderer.roles.LIST,selectablesTabindex:-1,sentinelize:true});b.listLayoutHandler.finalInit=function(e){var d=e.options;e.getRelativePosition=b.reorderer.relativeInfoGetter(d.orientation,b.reorderer.LOGICAL_STRATEGY,null,e.dropManager,d.disableWrap);e.getGeometricInfo=b.reorderer.makeGeometricInfoGetter(d.orientation,d.sentinelize,e.reordererDom)};b.defaults("fluid.gridLayoutHandler",{gradeNames:["fluid.layoutHandler","autoInit"],orientation:b.orientation.HORIZONTAL,containerRole:b.reorderer.roles.GRID,selectablesTabindex:-1,sentinelize:false});b.gridLayoutHandler.finalInit=function(e){var d=e.options;e.getRelativePosition=b.reorderer.relativeInfoGetter(d.orientation,d.disableWrap?b.reorderer.SHUFFLE_GEOMETRIC_STRATEGY:b.reorderer.LOGICAL_STRATEGY,b.reorderer.SHUFFLE_GEOMETRIC_STRATEGY,e.dropManager,d.disableWrap);e.getGeometricInfo=b.reorderer.makeGeometricInfoGetter(d.orientation,d.sentinelize,e.reordererDom)};b.defaults("fluid.reorderer.labeller",{gradeNames:["fluid.eventedComponent","autoInit"],members:{movedMap:{},moduleCell:{expander:{funcName:"fluid.reorderer.labeller.computeModuleCell",args:["{that}.resolver","{that}.options.orientation"]}},layoutType:{expander:{funcName:"fluid.computeNickName",args:"{that}.options.layoutType"}},positionTemplate:{expander:{funcName:"fluid.reorderer.labeller.computePositionTemplate",args:["{that}.resolver","{that}.layoutType"]}}},strings:{overallTemplate:"%recentStatus %item %position %movable",position:"%index of %length",position_moduleLayoutHandler:"%index of %length in %moduleCell %moduleIndex of %moduleLength",moduleCell_0:"row",moduleCell_1:"column",movable:"movable",fixed:"fixed",recentStatus:"moved from position %position"},components:{resolver:{type:"fluid.messageResolver",options:{messageBase:"{labeller}.options.strings"}}},invokers:{renderLabel:{funcName:"fluid.reorderer.labeller.renderLabel",args:["{labeller}","{arguments}.0","{arguments}.1"]}},listeners:{"{reorderer}.events.onRefresh":{listener:"fluid.reorderer.labeller.onRefresh",args:"{that}"},"{reorderer}.events.onMove":{listener:"fluid.reorderer.labeller.onMove",args:["{that}","{arguments}.0","{arguments}.1"]}}});b.reorderer.labeller.computeModuleCell=function(e,d){return e.resolve("moduleCell_"+d)};b.reorderer.labeller.computePositionTemplate=function(e,d){return e.lookup(["position_"+d,"position"])
};b.reorderer.labeller.onRefresh=function(f){var d=f.dom.locate("selectables");var e=f.movedMap;b.each(d,function(j){var g={};var l=b.allocateSimpleId(j);var k=e[l];var i=f.renderLabel(j);var h=i;if(k){k.newRender=h;i=f.renderLabel(j,k.oldRender.position);c(j).one("focusout.ariaLabeller",function(){if(e[l]){var m=e[l].newRender.label;delete e[l];b.updateAriaLabel(j,m)}});g.dynamicLabel=true}b.updateAriaLabel(j,i.label,g)})};b.reorderer.labeller.onMove=function(f,e){b.clear(f.movedMap);c(e).unbind("focusout.ariaLabeller");var d=b.allocateSimpleId(e);f.movedMap[d]={oldRender:f.renderLabel(e)}};b.reorderer.indexRebaser=function(d){d.index++;if(d.moduleIndex!==undefined){d.moduleIndex++}return d};b.reorderer.labeller.renderLabel=function(d,h,f){var g=d.options.getGeometricInfo();var l=b.reorderer.indexRebaser(g.elementIndexer(h));l.moduleCell=d.moduleCell;var m=g.elementMapper(h);var j=d.dom.locate("labelSource",h);var e;if(f){e=d.resolver.resolve("recentStatus",{position:f})}var n={item:typeof(j)==="string"?j:b.dom.getElementText(b.unwrap(j)),position:d.positionTemplate.resolveFunc(d.positionTemplate.template,l),movable:d.resolver.resolve(m==="locked"?"fixed":"movable"),recentStatus:e||""};var k=d.resolver.lookup(["overallTemplate"]);var i=k.resolveFunc(k.template,n);return{position:n.position,label:i}}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.reorderImages");a.reorderImages.deriveLightboxCellBase=function(c,d){return c+"lightbox-cell:"+d+":"};a.reorderImages.addThumbnailActivateHandler=function(c){var d=function(e){if(e.which===a.reorderer.keys.ENTER){var f=b("a",e.target);document.location=f.attr("href")}};c.keypress(d)};a.reorderImages.seekNodesById=function(g,j,e){var c=g.getElementsByTagName(j);var h=[];for(var f=0;f<c.length;f+=1){var d=c[f];var k=d.id;if(k&&k.match(e)){h.push(d)}}return h};a.reorderImages.createImageCellFinder=function(c,d){d=d||c.prop("id");c=a.unwrap(c);var e="^"+a.reorderImages.deriveLightboxCellBase(d,"[0-9]+")+"$";return function(){return a.reorderImages.seekNodesById(c,"div",e)}};a.reorderImages.seekForm=function(c){return a.findAncestor(c,function(d){return b(d).is("form")})};a.reorderImages.seekInputs=function(c,d){return a.reorderImages.seekNodesById(d,"input","^"+a.reorderImages.deriveLightboxCellBase(c.prop("id"),"[^:]*")+"reorder-index$")};a.reorderImages.mapIdsToNames=function(d,h){var c=a.reorderImages.seekInputs(d,h);for(var g=0;g<c.length;g++){var e=c[g];var f=e.name;e.name=f||e.id}};a.reorderImages.createIDAfterMoveListener=function(c){var d=a.reorderImages.seekForm(c);a.reorderImages.mapIdsToNames(c,d);return function(){var f,g;f=a.reorderImages.seekInputs(c,d);for(g=0;g<f.length;g+=1){f[g].value=g}if(d&&d.action){var e=b(d).serialize();b.post(d.action,e,function(){})}}};a.defaults("fluid.reorderImages",{gradeNames:["fluid.reorderer","autoInit"],layoutHandler:"fluid.gridLayoutHandler",listeners:{"afterMove.postModel":{expander:{funcName:"fluid.reorderImages.createIDAfterMoveListener",args:"{that}.container"}}},selectors:{movables:{expander:{funcName:"fluid.reorderImages.createImageCellFinder",args:"{that}.container"}},labelSource:".flc-reorderer-imageTitle"}});a.lightbox=a.reorderImages})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.moduleLayout");a.moduleLayout.findColumnAndItemIndices=function(d,c){return a.find(c.columns,function(g,f){var e=b.inArray(d,g.elements);return e===-1?undefined:{columnIndex:f,itemIndex:e}},{columnIndex:-1,itemIndex:-1})};a.moduleLayout.findColIndex=function(d,c){return a.find(c.columns,function(f,e){return d===f.container?e:undefined},-1)};a.moduleLayout.updateLayout=function(f,h,d,e){f=a.unwrap(f);h=a.unwrap(h);var c=a.moduleLayout.findColumnAndItemIndices(f,e);e.columns[c.columnIndex].elements.splice(c.itemIndex,1);var j;if(d===a.position.INSIDE){j=e.columns[a.moduleLayout.findColIndex(h,e)].elements;j.splice(j.length,0,f)}else{var i=a.moduleLayout.findColumnAndItemIndices(h,e);j=e.columns[i.columnIndex].elements;d=a.dom.normalisePosition(d,c.columnIndex===i.columnIndex,i.itemIndex,c.itemIndex);var g=d===a.position.BEFORE?0:1;j.splice(i.itemIndex+g,0,f)}};a.moduleLayout.layoutFromFlat=function(c,e,d){var f={};f.container=c;f.columns=a.transform(e,function(g){return{container:g,elements:a.makeArray(d.filter(function(){return a.dom.isContainer(g,this)}))}});return f};a.moduleLayout.layoutFromIds=function(c){return{container:a.byId(c.id),columns:a.transform(c.columns,function(d){return{container:a.byId(d.id),elements:a.transform(d.children,a.byId)}})}};a.moduleLayout.layoutToIds=function(c){return{id:a.getId(c.container),columns:a.transform(c.columns,function(d){return{id:a.getId(d.container),children:a.transform(d.elements,a.getId)}})}};a.moduleLayout.defaultOnShowKeyboardDropWarning=function(d,c){if(c){var e=b(d).offset();c=b(c);c.css("position","absolute");c.css("top",e.top);c.css("left",e.left)}};a.defaults("fluid.moduleLayoutHandler",{gradeNames:["fluid.layoutHandler","autoInit"],orientation:a.orientation.VERTICAL,containerRole:a.reorderer.roles.REGIONS,selectablesTabindex:-1,sentinelize:true,events:{onMove:"{reorderer}.events.onMove",onRefresh:"{reorderer}.events.onRefresh",onShowKeyboardDropWarning:"{reorderer}.events.onShowKeyboardDropWarning"},listeners:{"onShowKeyboardDropWarning.setPosition":"fluid.moduleLayout.defaultOnShowKeyboardDropWarning",onRefresh:{priority:"first",listener:"{that}.computeLayout"},onMove:{priority:"last",listener:"fluid.moduleLayout.onMoveListener",args:["{arguments}.0","{arguments}.1","{that}.layout"]}},members:{layout:{expander:{func:"{that}.computeLayout"}}},invokers:{computeLayout:{funcName:"fluid.moduleLayout.computeLayout",args:["{that}","{reorderer}.options.selectors.modules","{that}.dom"],dynamic:true},computeModules:{funcName:"fluid.moduleLayout.computeModules",args:["{that}.layout","{that}.isLocked","{arguments}.0"],dynamic:true},makeComputeModules:{funcName:"fluid.moduleLayout.makeComputeModules",args:["{that}","{arguments}.0"]},isLocked:{funcName:"fluid.moduleLayout.isLocked",args:["{arguments}.0","{reorderer}.options.selectors.lockedModules","{that}.reordererDom"]}},selectors:{modules:"{reorderer}.options.selectors.modules",columns:"{reorderer}.options.selectors.columns"},distributeOptions:{target:"{reorderer}.options",record:{selectors:{movables:{expander:{func:"{that}.makeComputeModules",args:[false]}},dropTargets:{expander:{func:"{that}.makeComputeModules",args:[false]}},selectables:{expander:{func:"{that}.makeComputeModules",args:[true]}}}}}});a.moduleLayout.computeLayout=function(e,f,g){var d;if(f){d=a.moduleLayout.layoutFromFlat(e.container,g.locate("columns"),g.locate("modules"))}if(!d){var c=a.get(e.options,"moduleLayout.layout");d=a.moduleLayout.layoutFromIds(c)}e.layout=d;return d};a.moduleLayout.computeModules=function(e,f,d){var c=a.accumulate(e.columns,function(g,h){return h.concat(g.elements)},[]);if(!d){a.remove_if(c,f)}return c};a.moduleLayout.makeComputeModules=function(d,c){return function(){return d.computeModules(c)}};a.moduleLayout.isLocked=function(c,d,f){var e=d?f.fastLocate("lockedModules"):[];return b.inArray(c,e)!==-1};a.moduleLayout.onMoveListener=function(d,e,c){a.moduleLayout.updateLayout(d,e.element,e.position,c)};a.moduleLayoutHandler.finalInit=function(d){var c=d.options;d.getRelativePosition=a.reorderer.relativeInfoGetter(c.orientation,a.reorderer.WRAP_LOCKED_STRATEGY,a.reorderer.GEOMETRIC_STRATEGY,d.dropManager,c.disableWrap);d.getGeometricInfo=function(){var i=[];var h={extents:i,sentinelize:c.sentinelize};h.elementMapper=function(j){return d.isLocked(j)?"locked":null};h.elementIndexer=function(j){var k=a.moduleLayout.findColumnAndItemIndices(j,d.layout);return{index:k.itemIndex,length:d.layout.columns[k.columnIndex].elements.length,moduleIndex:k.columnIndex,moduleLength:d.layout.columns.length}};for(var e=0;e<d.layout.columns.length;e++){var g=d.layout.columns[e];var f={orientation:c.orientation,elements:a.makeArray(g.elements),parentElement:g.container};i.push(f)}return h};d.getModel=function(){return a.moduleLayout.layoutToIds(d.layout)}}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.reorderLayout=function(c,f){var e={layoutHandler:"fluid.moduleLayoutHandler",selectors:{columns:".flc-reorderer-column",modules:".flc-reorderer-module"}};var d=b.extend(true,e,f);return a.reorderer(c,d)}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.slidingPanel",{gradeNames:["fluid.viewComponent","autoInit"],selectors:{panel:".flc-slidingPanel-panel",toggleButton:".flc-slidingPanel-toggleButton",toggleButtonLabel:".flc-slidingPanel-toggleButton"},strings:{showText:"show",hideText:"hide"},events:{onPanelHide:null,onPanelShow:null,afterPanelHide:null,afterPanelShow:null},listeners:{"onCreate.bindClick":{"this":"{that}.dom.toggleButton",method:"click",args:["{that}.togglePanel"]},"onCreate.bindModelChange":{listener:"{that}.applier.modelChanged.addListener",args:["isShowing","{that}.refreshView"]},"onCreate.setInitialState":{listener:"{that}.refreshView"},"onPanelHide.setText":{"this":"{that}.dom.toggleButtonLabel",method:"text",args:["{that}.options.strings.showText"],priority:"first"},"onPanelShow.setText":{"this":"{that}.dom.toggleButtonLabel",method:"text",args:["{that}.options.strings.hideText"],priority:"first"},"onPanelHide.operate":{listener:"{that}.operateHide"},"onPanelShow.operate":{listener:"{that}.operateShow"}},invokers:{operateHide:{"this":"{that}.dom.panel",method:"slideUp",args:["{that}.options.animationDurations.hide","{that}.events.afterPanelHide.fire"]},operateShow:{"this":"{that}.dom.panel",method:"slideDown",args:["{that}.options.animationDurations.show","{that}.events.afterPanelShow.fire"]},hidePanel:{func:"{that}.applier.requestChange",args:["isShowing",false]},showPanel:{func:"{that}.applier.requestChange",args:["isShowing",true]},togglePanel:{funcName:"fluid.slidingPanel.togglePanel",args:["{that}"]},refreshView:{funcName:"fluid.slidingPanel.refreshView",args:["{that}"]}},model:{isShowing:false},animationDurations:{hide:400,show:400}});
a.slidingPanel.togglePanel=function(c){c.applier.requestChange("isShowing",!c.model.isShowing)};a.slidingPanel.refreshView=function(c){c.events[c.model.isShowing?"onPanelShow":"onPanelHide"].fire()}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.tableOfContents");a.tableOfContents.insertAnchor=function(d,f,e){var c=b("<a></a>",f.ownerDocument);c.prop({"class":e,name:d,id:d});c.insertBefore(f)};a.tableOfContents.headingTextToAnchorInfo=function(f,c){var d=c();var e={id:d,url:"#"+d};return e};a.tableOfContents.refreshView=function(c){var d=c.locate("headings");c.locate("tocAnchors").remove();c.anchorInfo=a.transform(d,function(g){var f=c.headingTextToAnchorInfo(g);c.insertAnchor(f.id,g,c.options.anchorClass);return f});var e=c.modelBuilder.assembleModel(d,c.anchorInfo);c.applier.requestChange("",e);c.events.onRefresh.fire()};a.defaults("fluid.tableOfContents",{gradeNames:["fluid.viewComponent","autoInit"],components:{levels:{type:"fluid.tableOfContents.levels",createOnEvent:"onCreate",container:"{tableOfContents}.dom.tocContainer",options:{model:{headings:"{tableOfContents}.model"},events:{afterRender:"{tableOfContents}.events.afterRender"},listeners:{"{tableOfContents}.events.onRefresh":"{that}.refreshView"}}},modelBuilder:{type:"fluid.tableOfContents.modelBuilder"}},model:[],invokers:{headingTextToAnchorInfo:{funcName:"fluid.tableOfContents.headingTextToAnchorInfo",args:["{arguments}.0","{that}.generateGUID"]},insertAnchor:"fluid.tableOfContents.insertAnchor",generateGUID:"fluid.allocateSimpleId",refreshView:{funcName:"fluid.tableOfContents.refreshView",args:["{that}"]},hide:{"this":"{that}.dom.tocContainer",method:"hide"},show:{"this":"{that}.dom.tocContainer",method:"show"}},selectors:{headings:":header:visible:not(.flc-toc-tocContainer :header)",tocContainer:".flc-toc-tocContainer",tocAnchors:".flc-toc-anchors"},anchorClass:"flc-toc-anchors",events:{onRefresh:null,afterRender:null,onReady:{events:{onCreate:"onCreate",afterRender:"afterRender"},args:["{that}"]}},listeners:{"onCreate.refreshView":"{that}.refreshView"}});a.registerNamespace("fluid.tableOfContents.modelBuilder");a.tableOfContents.modelBuilder.toModel=function(d,e){var f=a.copy(d);var c=function(j,k){var h=[];while(j.length>0){var i=j[0];if(i.level<k){break}if(i.level>k){var g=c(j,k+1);if(h.length>0){h[h.length-1].headings=g}else{h=e(h,g)}}if(i.level===k){h.push(i);j.shift()}}return h};return c(f,1)};a.tableOfContents.modelBuilder.gradualModelLevelFn=function(e,d){var c=a.copy(d);c[0].level--;return c};a.tableOfContents.modelBuilder.skippedModelLevelFn=function(d,c){d.push({headings:c});return d};a.tableOfContents.modelBuilder.finalInit=function(c){c.convertToHeadingObjects=function(e,d){e=b(e);return a.transform(e,function(g,f){return{level:c.headingCalculator.getHeadingLevel(g),text:b(g).text(),url:d[f].url}})};c.assembleModel=function(f,e){var d=c.convertToHeadingObjects(f,e);return c.toModel(d)}};a.defaults("fluid.tableOfContents.modelBuilder",{gradeNames:["fluid.littleComponent","autoInit"],finalInitFunction:"fluid.tableOfContents.modelBuilder.finalInit",components:{headingCalculator:{type:"fluid.tableOfContents.modelBuilder.headingCalculator"}},invokers:{toModel:{funcName:"fluid.tableOfContents.modelBuilder.toModel",args:["{arguments}.0","{modelBuilder}.modelLevelFn"]},modelLevelFn:"fluid.tableOfContents.modelBuilder.gradualModelLevelFn"}});a.registerNamespace("fluid.tableOfContents.modelBuilder.headingCalculator");a.tableOfContents.modelBuilder.headingCalculator.finalInit=function(c){c.getHeadingLevel=function(d){return b.inArray(d.tagName,c.options.levels)+1}};a.defaults("fluid.tableOfContents.modelBuilder.headingCalculator",{gradeNames:["fluid.littleComponent","autoInit"],finalInitFunction:"fluid.tableOfContents.modelBuilder.headingCalculator.finalInit",levels:["H1","H2","H3","H4","H5","H6"]});a.registerNamespace("fluid.tableOfContents.levels");a.tableOfContents.levels.finalInit=function(c){a.fetchResources(c.options.resources,function(){c.container.append(c.options.resources.template.resourceText);c.refreshView()})};a.tableOfContents.levels.objModel=function(d,c){var e={ID:d+c+":",children:[]};return e};a.tableOfContents.levels.handleEmptyItemObj=function(c){c.decorators=[{type:"addClass",classes:"fl-tableOfContents-hide-bullet"}]};a.tableOfContents.levels.generateTree=function(f,d){d=d||0;var e=a.tableOfContents.levels.objModel("level",d);if(f.headings.length===0){return[]}if(d===0){var c={children:[a.tableOfContents.levels.generateTree(f,d+1)]};return c}b.each(f.headings,function(i,h){var g=a.tableOfContents.levels.objModel("items",d);var j={ID:"link"+d,target:h.url,linktext:h.text};if(!h.level){a.tableOfContents.levels.handleEmptyItemObj(g)}else{g.children.push(j)}if(h.headings){g.children.push(a.tableOfContents.levels.generateTree(h,d+1))}e.children.push(g)});return e};a.tableOfContents.levels.produceTree=function(c){return a.tableOfContents.levels.generateTree(c.model)};a.defaults("fluid.tableOfContents.levels",{gradeNames:["fluid.rendererComponent","autoInit"],finalInitFunction:"fluid.tableOfContents.levels.finalInit",produceTree:"fluid.tableOfContents.levels.produceTree",selectors:{level1:".flc-toc-levels-level1",level2:".flc-toc-levels-level2",level3:".flc-toc-levels-level3",level4:".flc-toc-levels-level4",level5:".flc-toc-levels-level5",level6:".flc-toc-levels-level6",items1:".flc-toc-levels-items1",items2:".flc-toc-levels-items2",items3:".flc-toc-levels-items3",items4:".flc-toc-levels-items4",items5:".flc-toc-levels-items5",items6:".flc-toc-levels-items6",link1:".flc-toc-levels-link1",link2:".flc-toc-levels-link2",link3:".flc-toc-levels-link3",link4:".flc-toc-levels-link4",link5:".flc-toc-levels-link5",link6:".flc-toc-levels-link6"},repeatingSelectors:["level1","level2","level3","level4","level5","level6","items1","items2","items3","items4","items5","items6"],model:{headings:[]},resources:{template:{forceCache:true,url:"../html/TableOfContents.html"}},rendererFnOptions:{noexpand:true},rendererOptions:{debugMode:false}})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.tabs",{gradeNames:["fluid.viewComponent","autoInit"],tabOptions:{},events:{tabsselect:"preventable",tabsload:null,tabsshow:null},listeners:{"onCreate.initTabs":{"this":"{that}.container",method:"tabs",args:"{that}.options.tabOptions"}},finalInitFunction:"fluid.tabs.finalInit"});a.tabs.finalInit=function(c){c.container.tabs(c.options.tabOptions);a.each(c.options.events,function(e,d){c.container.bind(d,function(f,g){return c.events[d].fire(c,f,g)})})}})(jQuery,fluid_1_5);
/*!
 * jQuery UI Touch Punch 0.2.2
 *
 * Copyright 2011, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
(function(b){b.support.touch="ontouchend" in document;if(!b.support.touch){return}var c=b.ui.mouse.prototype,e=c._mouseInit,a;function d(g,h){if(g.originalEvent.touches.length>1){return}g.preventDefault();var i=g.originalEvent.changedTouches[0],f=document.createEvent("MouseEvents");f.initMouseEvent(h,true,true,window,1,i.screenX,i.screenY,i.clientX,i.clientY,false,false,false,false,0,null);g.target.dispatchEvent(f)}c._touchStart=function(g){var f=this;if(a||!f._mouseCapture(g.originalEvent.changedTouches[0])){return}a=true;f._touchMoved=false;d(g,"mouseover");d(g,"mousemove");d(g,"mousedown")};c._touchMove=function(f){if(!a){return}this._touchMoved=true;d(f,"mousemove")};c._touchEnd=function(f){if(!a){return}d(f,"mouseup");d(f,"mouseout");if(!this._touchMoved){d(f,"click")}a=false};c._mouseInit=function(){var f=this;f.element.bind("touchstart",b.proxy(f,"_touchStart")).bind("touchmove",b.proxy(f,"_touchMove")).bind("touchend",b.proxy(f,"_touchEnd"));e.call(f)}})(jQuery);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.textfieldSlider",{gradeNames:["fluid.viewComponent","fluid.prefs.modelRelay","autoInit"],components:{textfield:{type:"fluid.textfieldSlider.textfield",container:"{textfieldSlider}.dom.textfield",options:{model:"{textfieldSlider}.model",range:"{textfieldSlider}.options.range",members:{applier:"{textfieldSlider}.applier"}}},slider:{type:"fluid.textfieldSlider.slider",container:"{textfieldSlider}.dom.slider",options:{model:"{textfieldSlider}.model",range:"{textfieldSlider}.options.range",members:{applier:"{textfieldSlider}.applier"},sliderOptions:"{textfieldSlider}.options.sliderOptions"}}},selectors:{textfield:".flc-textfieldSlider-field",slider:".flc-textfieldSlider-slider"},events:{modelChanged:null,afterRender:null},listeners:{modelChanged:"{that}.refreshView"},model:{value:null},range:{min:0,max:100},sliderOptions:{orientation:"horizontal",step:1},invokers:{refreshView:{funcName:"fluid.textfieldSlider.refreshView",args:["{that}"]}},finalInitFunction:"fluid.textfieldSlider.finalInit",renderOnInit:true});a.textfieldSlider.finalInit=function(d){d.applier.modelChanged.addListener("value",function(e){d.events.modelChanged.fire(e.value)});if(d.options.renderOnInit){d.refreshView()}};a.textfieldSlider.refreshView=function(d){d.textfield.container.val(d.model.value);d.events.afterRender.fire(d)};a.defaults("fluid.textfieldSlider.textfield",{gradeNames:["fluid.viewComponent","autoInit"],listeners:{onCreate:{listener:"fluid.textfieldSlider.textfield.init",args:"{that}"}},range:{}});a.textfieldSlider.validateValue=function(f,d,g){var e=f.value;var h=g.value;if(!isNaN(parseInt(h,10))){if(h<d.min){h=d.min}else{if(h>d.max){h=d.max}}g.value=Number(h)}else{g.value=e}};a.textfieldSlider.textfield.init=function(d){d.applier.guards.addListener({path:"value",transactional:true},function(e,f){a.textfieldSlider.validateValue(e,d.options.range,f)});d.container.change(function(e){d.applier.requestChange("value",e.target.value)})};a.defaults("fluid.textfieldSlider.slider",{gradeNames:["fluid.viewComponent","autoInit"],selectors:{thumb:".ui-slider-handle"},events:{modelChanged:null},listeners:{onCreate:{listener:"fluid.textfieldSlider.slider.init",args:"{that}"}},range:{}});
var c=function(d,f){var e={role:"slider","aria-valuenow":f.value,"aria-valuemin":f.min,"aria-valuemax":f.max};d.attr(e)};a.textfieldSlider.slider.init=function(d){var e=b.extend(true,{},d.options.sliderOptions,d.model,d.options.range);d.slider=d.container.slider(e);c(d.locate("thumb"),e);d.setSliderValue=function(f){d.slider.slider("value",f)};d.setSliderAria=function(f){d.locate("thumb").attr("aria-valuenow",f)};d.slider.bind("slide",function(g,f){d.applier.requestChange("value",f.value)});d.applier.modelChanged.addListener("value",function(f){d.setSliderValue(f.value);d.setSliderAria(f.value);d.events.modelChanged.fire(f.value)})}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.enhance");a.enhance.isBrowser=function(){return typeof(window)!=="undefined"&&window.document};a.enhance.supportsBinaryXHR=function(){return window.FormData||(window.XMLHttpRequest&&window.XMLHttpRequest.prototype&&window.XMLHttpRequest.prototype.sendAsBinary)};a.enhance.supportsFormData=function(){return !!window.FormData};a.enhance.checked={};a.enhance.sep="--";a.enhance.typeToKey=function(c){return c.replace(/[.]/gi,a.enhance.sep)};a.enhance.check=function(c){a.each(c,function(g,e){var f=a.enhance.typeToKey(e);if(a.enhance.checked[f]===undefined){var d=typeof(g)==="boolean"?g:(typeof(g)==="string"?a.invokeGlobalFunction(g):g());a.enhance.checked[f]=!!d;if(d){a.staticEnvironment[f]=a.typeTag(e)}}})};a.enhance.forget=function(c){var d=a.enhance.typeToKey(c);if(a.enhance.checked[d]!==undefined){delete a.staticEnvironment[d];delete a.enhance.checked[d]}};a.enhance.forgetAll=function(){a.each(a.enhance.checked,function(d,c){a.enhance.forget(c)})};a.defaults("fluid.progressiveChecker",{gradeNames:["fluid.typeFount","fluid.littleComponent","autoInit","{that}.check"],checks:[],defaultContextName:undefined,invokers:{check:{funcName:"fluid.progressiveChecker.check",args:["{that}.options.checks","{that}.options.defaultContextName"]}}});a.progressiveChecker.check=function(d,c){return a.find(d,function(e){if(e.feature){return e.contextName}},c)};a.progressiveChecker.forComponent=function(f,d){var h=a.defaults(d);var e=a.expandOptions(a.copy(h.progressiveCheckerOptions),f);var g=a.progressiveChecker.check(e.checks,e.defaultContextName);var c=d+".progressiveCheck";return[c,g]};a.defaults("fluid.progressiveCheckerForComponent",{gradeNames:["fluid.typeFount","fluid.littleComponent","autoInit","{that}.check"],invokers:{check:{funcName:"fluid.progressiveChecker.forComponent",args:["{that}","{that}.options.componentName"]}}});a.enhance.check({"fluid.browser":"fluid.enhance.isBrowser"});if(a.enhance.isBrowser()&&b.fn){b("head").append("<style type='text/css'>.fl-progEnhance-basic, .fl-ProgEnhance-basic { display: none; } .fl-progEnhance-enhanced, .fl-ProgEnhance-enhanced { display: block; }</style>")}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.url");a.url.generateDepth=function(c){return a.generate(c,"../").join("")};a.url.parsePathInfo=function(g){var d={};var c=g.split("/");if(c.length>0){var e=c.length-1;var f=c[e].indexOf(".");if(f!==-1){d.extension=c[e].substring(f+1);c[e]=c[e].substring(0,f)}}d.pathInfo=c;return d};a.url.parsePathInfoTrim=function(d){var c=a.url.parsePathInfo(d);if(c.pathInfo[c.pathInfo.length-1]===""){c.pathInfo.length--}return c};a.url.collapseSegs=function(c,g,f){var e="";if(g===undefined){g=0}if(f===undefined){f=c.length}for(var d=g;d<f-1;++d){e+=c[d]+"/"}if(f>g){e+=c[f-1]}return e};a.url.makeRelPath=function(c,d){var e=a.kettle.collapseSegs(c.pathInfo,d);if(c.extension){e+="."+c.extension}return e};a.url.cononocolosePath=function(e){var c=0;for(var d=0;d<e.length;++d){if(e[d]===".."){++c}else{if(c!==0){e.splice(d-c*2,c*2);d-=c*2;c=0}}}return e};a.url.parseUri=function(g){var f=a.url.parseUri.options,c=f.parser[f.strictMode?"strict":"loose"].exec(g),e={},d=14;while(d--){e[f.key[d]]=c[d]||""}e[f.q.name]={};e[f.key[12]].replace(f.q.parser,function(i,h,j){if(h){e[f.q.name][h]=j}});return e};a.url.parseUri.options={strictMode:true,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};a.url.parseSegs=function(e){var c=a.url.parseUri(e);var d=a.url.parsePathInfoTrim(c.directory);return d.pathInfo};a.url.isAbsoluteUrl=function(c){var d=a.url.parseUri(c);return(d.host||d.protocol||d.directory.charAt(0)==="/")};a.url.computeRelativePrefix=function(l,i,k){if(a.url.isAbsoluteUrl(k)){return k}var m=a.url.parsePathInfo(k).pathInfo;var d=a.url.parseSegs(l);var f=d.concat(m);a.url.cononocolosePath(f);var e=a.url.parseSegs(i);var g=0;for(;g<f.length;++g){if(f[g]!==e[g]){break}}var j=e.length-g;var h=a.url.generateDepth(j);var c=a.url.collapseSegs(f,g);return h+c}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.prefs.dataSource",{gradeNames:["fluid.littleComponent"],invokers:{get:"fluid.prefs.dataSource.get",set:"fluid.prefs.dataSource.set"}});a.defaults("fluid.cookieStore",{gradeNames:["fluid.prefs.dataSource","autoInit"],cookie:{name:"fluid-ui-settings",path:"/",expires:""}});a.demands("fluid.prefs.dataSource.get","fluid.cookieStore",{funcName:"fluid.cookieStore.get",args:"{that}.options.cookie.name"});a.demands("fluid.prefs.dataSource.set","fluid.cookieStore",{funcName:"fluid.cookieStore.set",args:["{arguments}.0","{that}.options.cookie"]});a.cookieStore.get=function(h){var d=document.cookie;if(d.length<=0){return}var c=h+"=";var g=d.indexOf(c);if(g<0){return}g=g+c.length;var f=d.indexOf(";",g);if(f<g){f=d.length}var e=JSON.parse(decodeURIComponent(d.substring(g,f)));return e};a.cookieStore.assembleCookie=function(d){var c=d.name+"="+d.data;if(d.expires){c+="; expires="+d.expires}if(d.path){c+="; path="+d.path}return c};a.cookieStore.set=function(c,d){d.data=encodeURIComponent(JSON.stringify(c));document.cookie=a.cookieStore.assembleCookie(d)};a.defaults("fluid.tempStore",{gradeNames:["fluid.prefs.dataSource","fluid.modelComponent","autoInit"]});a.demands("fluid.prefs.dataSource.get","fluid.tempStore",{funcName:"fluid.identity",args:"{that}.model"});a.demands("fluid.prefs.dataSource.set","fluid.tempStore",{funcName:"fluid.tempStore.set",args:["{arguments}.0","{that}.applier"]});a.tempStore.set=function(d,c){c.requestChange("",d)};a.defaults("fluid.globalSettingsStore",{gradeNames:["autoInit","fluid.littleComponent"],components:{settingsStore:{type:"fluid.prefs.store"}}});a.globalSettingsStore.finalInit=function(c){a.staticEnvironment.settingsStore=c.settingsStore};a.demands("fluid.prefs.store",["fluid.globalSettingsStore"],{funcName:"fluid.cookieStore"})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.prefs.rootModel",{gradeNames:["fluid.littleComponent","autoInit"],members:{rootModel:{}}});a.defaults("fluid.uiEnhancer",{gradeNames:["fluid.viewComponent","autoInit"],invokers:{updateModel:{funcName:"fluid.uiEnhancer.updateModel",args:["{arguments}.0","{uiEnhancer}.applier"]}}});a.uiEnhancer.updateModel=function(d,c){c.requestChange("",d)};a.defaults("fluid.pageEnhancer",{gradeNames:["fluid.eventedComponent","fluid.originalEnhancerOptions","fluid.prefs.rootModel","fluid.prefs.settingsGetter","autoInit"],components:{uiEnhancer:{type:"fluid.uiEnhancer",container:"body"}},distributeOptions:{source:"{that}.options.uiEnhancer",target:"{that > uiEnhancer}.options"},invokers:{init:{funcName:"fluid.pageEnhancer.init",args:"{that}"}},listeners:{onCreate:[{listener:"{that}.init"}]}});a.pageEnhancer.init=function(c){c.options.originalUserOptions=b.extend(true,c.uiEnhancer.options,a.copy(c.options.uiEnhancer));a.staticEnvironment.originalEnhancerOptions=c;c.uiEnhancer.updateModel(c.getSettings());a.staticEnvironment.uiEnhancer=c.uiEnhancer}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.prefs.prefsEditorLoader",{gradeNames:["fluid.viewComponent","autoInit"],components:{prefsEditor:{priority:"last",type:"fluid.prefs.prefsEditor",createOnEvent:"onCreatePrefsEditorReady"},templateLoader:{type:"fluid.prefs.resourceLoader",options:{events:{onResourcesLoaded:"{prefsEditorLoader}.events.onPrefsEditorTemplatesLoaded"}}},messageLoader:{type:"fluid.prefs.resourceLoader",options:{events:{onResourcesLoaded:"{prefsEditorLoader}.events.onPrefsEditorMessagesLoaded"}}}},events:{onPrefsEditorTemplatesLoaded:null,onPrefsEditorMessagesLoaded:null,onMsgResolverReady:null,onCreatePrefsEditorReady:{events:{templateLoaded:"onPrefsEditorTemplatesLoaded",msgResolverReady:"onMsgResolverReady"}}},listeners:{onPrefsEditorMessagesLoaded:{funcName:"fluid.prefs.prefsEditorLoader.createMsgResolver",args:["{arguments}.0","{that}"]}},distributeOptions:[{source:"{that}.options.templateLoader",removeSource:true,target:"{that > templateLoader}.options"},{source:"{that}.options.messageLoader",removeSource:true,target:"{that > messageLoader}.options"},{source:"{that}.options.templatePrefix",target:"{that > templateLoader > resourcePath}.options.value"},{source:"{that}.options.messagePrefix",target:"{that > messageLoader > resourcePath}.options.value"},{source:"{that}.options.prefsEditor",removeSource:true,target:"{that > prefsEditor}.options"}]});a.prefs.prefsEditorLoader.createMsgResolver=function(d,e){var c;a.each(d,function(g){var h=JSON.parse(g.resourceText);c=b.extend({},c,h)});var f=a.messageResolver({messageBase:c});e.msgResolver=a.messageResolver({messageBase:{},parents:[f]});e.events.onMsgResolverReady.fire()};a.defaults("fluid.prefs.transformDefaultPanelsOptions",{gradeNames:["fluid.viewComponent","autoInit"],distributeOptions:[{source:"{that}.options.textSize",removeSource:true,target:"{that textSize}.options"},{source:"{that}.options.lineSpace",removeSource:true,target:"{that lineSpace}.options"},{source:"{that}.options.textFont",removeSource:true,target:"{that textFont}.options"},{source:"{that}.options.contrast",removeSource:true,target:"{that contrast}.options"},{source:"{that}.options.layoutControls",removeSource:true,target:"{that layoutControls}.options"},{source:"{that}.options.linksControls",removeSource:true,target:"{that linksControls}.options"}]});
a.defaults("fluid.prefs.resourceLoader",{gradeNames:["fluid.eventedComponent","autoInit"],listeners:{onCreate:{listener:"fluid.prefs.resourceLoader.loadTemplates",args:["{that}",{expander:{func:"{that}.resolveTemplates"}}]}},templates:{},components:{resourcePath:{type:"fluid.prefs.resourcePath"}},invokers:{transformURL:{funcName:"fluid.stringTemplate",args:["{arguments}.0",{"prefix/":"{that}.resourcePath.options.value"}]},resolveTemplates:{funcName:"fluid.prefs.resourceLoader.resolveTemplates",args:"{that}"}},events:{onResourcesLoaded:null}});a.prefs.resourceLoader.resolveTemplates=function(d){var c=a.transform(d.options.templates,d.transformURL);return a.transform(c,function(e){return{url:e,forceCache:true}})};a.prefs.resourceLoader.loadTemplates=function(c,d){delete d.expander;a.fetchResources(d,function(){c.resources=d;c.events.onResourcesLoaded.fire(d)})};a.defaults("fluid.prefs.resourcePath",{gradeNames:["fluid.littleComponent","autoInit"],value:"../html/"});a.defaults("fluid.prefs.settingsGetter",{gradeNames:["fluid.littleComponent","autoInit"],members:{getSettings:"{settingsStore}.get"}});a.defaults("fluid.prefs.settingsSetter",{gradeNames:["fluid.littleComponent","autoInit"],invokers:{setSettings:{funcName:"fluid.prefs.settingsSetter.setSettings",args:["{arguments}.0","{settingsStore}.set"]}}});a.prefs.settingsSetter.setSettings=function(c,e){var d=a.copy(c);e(d)};a.defaults("fluid.prefs.uiEnhancerRelay",{gradeNames:["autoInit","fluid.eventedComponent"],listeners:{onCreate:"{that}.addListener",onDestroy:"{that}.removeListener"},events:{updateEnhancerModel:"{fluid.prefs.prefsEditor}.events.onUpdateEnhancerModel"},invokers:{addListener:{funcName:"fluid.prefs.uiEnhancerRelay.addListener",args:["{that}.events.updateEnhancerModel","{that}.updateEnhancerModel"]},removeListener:{funcName:"fluid.prefs.uiEnhancerRelay.removeListener",args:["{that}.events.updateEnhancerModel","{that}.updateEnhancerModel"]},updateEnhancerModel:{funcName:"fluid.prefs.uiEnhancerRelay.updateEnhancerModel",args:["{uiEnhancer}","{fluid.prefs.prefsEditor}.model"]}}});a.prefs.uiEnhancerRelay.addListener=function(c,d){c.addListener(d)};a.prefs.uiEnhancerRelay.removeListener=function(c,d){c.removeListener(d)};a.prefs.uiEnhancerRelay.updateEnhancerModel=function(d,c){d.updateModel(c)};a.defaults("fluid.prefs.prefsEditor",{gradeNames:["fluid.viewComponent","fluid.prefs.settingsGetter","fluid.prefs.settingsSetter","fluid.prefs.rootModel","autoInit"],invokers:{updateModel:{funcName:"fluid.fireSourcedChange",args:["{that}.applier","","{arguments}.0","{arguments}.1"]},fetch:{funcName:"fluid.prefs.prefsEditor.fetch",args:["{that}"]},applyChanges:{funcName:"fluid.prefs.prefsEditor.applyChanges",args:["{that}"]},save:{funcName:"fluid.prefs.prefsEditor.save",args:["{that}"]},saveAndApply:{funcName:"fluid.prefs.prefsEditor.saveAndApply",args:["{that}"]},reset:{funcName:"fluid.prefs.prefsEditor.reset",args:["{that}"]},cancel:{funcName:"fluid.prefs.prefsEditor.cancel",args:["{that}"]}},selectors:{cancel:".flc-prefsEditor-cancel",reset:".flc-prefsEditor-reset",save:".flc-prefsEditor-save",previewFrame:".flc-prefsEditor-preview-frame"},events:{onSave:null,onCancel:null,onReset:null,onAutoSave:null,modelChanged:null,onPrefsEditorRefresh:null,onUpdateEnhancerModel:null,onPrefsEditorMarkupReady:null,onReady:null},listeners:{onCreate:"fluid.prefs.prefsEditor.init",onAutoSave:"{that}.save"},resources:{template:"{templateLoader}.resources.prefsEditor"},autoSave:false});a.prefs.prefsEditor.applyChanges=function(c){c.events.onUpdateEnhancerModel.fire()};a.prefs.prefsEditor.fetch=function(c){var d=c.getSettings();d=b.extend(true,{},c.rootModel,d);c.updateModel(d,"settingsStore");c.events.onPrefsEditorRefresh.fire();c.applyChanges()};a.prefs.prefsEditor.save=function(d){var c=a.copy(d.model);a.each(c,function(f,e){if(a.get(d.rootModel,e)===f){delete c[e]}});d.events.onSave.fire(c);d.setSettings(c)};a.prefs.prefsEditor.saveAndApply=function(c){c.save();c.events.onPrefsEditorRefresh.fire();c.applyChanges()};a.prefs.prefsEditor.reset=function(c){c.updateModel(a.copy(c.rootModel));c.events.onPrefsEditorRefresh.fire();c.events.onReset.fire(c)};a.prefs.prefsEditor.cancel=function(c){c.events.onCancel.fire();c.fetch()};a.prefs.prefsEditor.finishInit=function(d){var c=function(f){var g=f.locate("save");if(g.length>0){g.click(f.saveAndApply);var e=a.findForm(g);b(e).submit(function(){f.saveAndApply()})}f.locate("reset").click(f.reset);f.locate("cancel").click(f.cancel)};d.container.append(d.options.resources.template.resourceText);c(d);d.events.onPrefsEditorMarkupReady.fire(d);d.fetch();d.events.onReady.fire(d)};a.prefs.prefsEditor.init=function(c){c.applier.modelChanged.addListener("",function(d,f,e){c.events.modelChanged.fire(d,f,e[0].source);if(c.options.autoSave){c.events.onAutoSave.fire()}});setTimeout(function(){if(!a.isDestroyed(c)){a.prefs.prefsEditor.finishInit(c)}},1)};a.defaults("fluid.prefs.preview",{gradeNames:["fluid.viewComponent","autoInit"],components:{enhancer:{type:"fluid.uiEnhancer",container:"{preview}.enhancerContainer",createOnEvent:"onReady"},templateLoader:"{templateLoader}"},invokers:{updateModel:{funcName:"fluid.prefs.preview.updateModel",args:["{preview}","{prefsEditor}.model"]}},finalInitFunction:"fluid.prefs.preview.finalInit",events:{onReady:null},listeners:{"{prefsEditor}.events.modelChanged":"{that}.updateModel",onReady:"{that}.updateModel"},templateUrl:"%prefix/PrefsEditorPreview.html"});a.prefs.preview.updateModel=function(d,c){setTimeout(function(){if(d.enhancer){d.enhancer.updateModel(c)}},0)};a.prefs.preview.finalInit=function(c){var d=c.templateLoader.transformURL(c.options.templateUrl);c.container.load(function(){c.enhancerContainer=b("body",c.container.contents());c.events.onReady.fire()});c.container.attr("src",d)}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.prefs.msgLookup",{gradeNames:["fluid.littleComponent","autoInit"],members:{msgLookup:{expander:{funcName:"fluid.prefs.stringLookup",args:["{that}.messageResolver","{that}.options.stringArrayIndex"]}}},stringArrayIndex:{}});a.prefs.stringLookup=function(d,c){var e={id:a.allocateGuid()};e.singleLookup=function(f){var g=d.lookup([f]);return a.get(g,"template")};e.multiLookup=function(f){return a.transform(f,function(g){return e.singleLookup(g)})};e.lookup=function(h){var f=a.get(c,h)||h;var g=a.isArrayable(f)?"multiLookup":"singleLookup";return e[g](f)};e.resolvePathSegment=e.lookup;return e};a.defaults("fluid.prefs.panel",{gradeNames:["fluid.rendererComponent","fluid.prefs.msgLookup","fluid.prefs.modelRelay","autoInit"],events:{onDomBind:null},listeners:{"onCreate.onDomBind":"{that}.events.onDomBind"}});a.defaults("fluid.prefs.subPanel",{gradeNames:["fluid.prefs.panel","{that}.getDomBindGrade","autoInit"],mergePolicy:{sourceApplier:"nomerge"},sourceApplier:"{compositePanel}.applier",listeners:{"{compositePanel}.events.afterRender":{listener:"{that}.events.afterRender",args:["{that}"]},"onCreate.onDomBind":null,"afterRender.onDomBind":"{that}.resetDomBinder"},rules:{expander:{func:"fluid.prefs.subPanel.generateRules",args:["{that}.options.preferenceMap"]}},model:{expander:{func:"fluid.prefs.subPanel.getInitialModel",args:["{compositePanel}.model","{that}.options.preferenceMap"]}},invokers:{refreshView:"{compositePanel}.refreshView",resetDomBinder:{funcName:"fluid.prefs.subPanel.resetDomBinder",args:["{that}"]},getDomBindGrade:{funcName:"fluid.prefs.subPanel.getDomBindGrade",args:["{prefsEditor}"]}},strings:{},parentBundle:"{compositePanel}.messageResolver",renderOnInit:false});a.defaults("fluid.prefs.subPanel.domBind",{gradeNames:["fluid.eventedComponent","autoInit"],listeners:{"onDomBind.domChange":{listener:"{prefsEditor}.events.onSignificantDOMChange"}}});a.prefs.subPanel.getDomBindGrade=function(d){var c=a.get(d,"options.events.onSignificantDOMChange")!==undefined;if(c){return"fluid.prefs.subPanel.domBind"}};a.prefs.subPanel.resetDomBinder=function(c){c.container=b(c.container.selector);a.initDomBinder(c,c.options.selectors);c.events.onDomBind.fire(c)};a.prefs.subPanel.safePrefKey=function(c){return c.replace(/[.]/g,"_")};a.prefs.subPanel.generateRules=function(c){var d={};a.each(c,function(e,f){b.each(e,function(g){if(g.indexOf("model.")===0){d[a.prefs.subPanel.safePrefKey(f)]=g.slice(6)}})});return d};a.prefs.subPanel.getInitialModel=function(d,c){var e={};a.each(c,function(f,g){b.each(f,function(h){if(h.indexOf("model.")===0){a.set(e,h.slice(6),a.get(d,a.prefs.subPanel.safePrefKey(g)))}})});return e};a.registerNamespace("fluid.prefs.compositePanel");a.prefs.compositePanel.arrayMergePolicy=function(d,c){d=a.makeArray(d);c=a.makeArray(c);a.each(c,function(e){if(b.inArray(e,d)<0){d.push(e)}});return d};a.defaults("fluid.prefs.compositePanel",{gradeNames:["fluid.prefs.panel","autoInit","{that}.getDistributeOptionsGrade","{that}.getSubPanelLifecycleBindings"],mergePolicy:{subPanelOverrides:"noexpand",selectorsToIgnore:a.prefs.compositePanel.arrayMergePolicy},selectors:{},selectorsToIgnore:[],repeatingSelectors:[],events:{onRefreshView:null,initSubPanels:null},listeners:{"onCreate.combineResources":"{that}.combineResources","onCreate.appendTemplate":{"this":"{that}.container",method:"append",args:["{that}.options.resources.template.resourceText"]},"onCreate.initSubPanels":"{that}.events.initSubPanels","onCreate.hideInactive":"{that}.hideInactive","onCreate.surfaceSubpanelRendererSelectors":"{that}.surfaceSubpanelRendererSelectors","afterRender.hideInactive":"{that}.hideInactive"},invokers:{getDistributeOptionsGrade:{funcName:"fluid.prefs.compositePanel.assembleDistributeOptions",args:["{that}.options.components"]},getSubPanelLifecycleBindings:{funcName:"fluid.prefs.compositePanel.subPanelLifecycleBindings",args:["{that}.options.components"]},combineResources:{funcName:"fluid.prefs.compositePanel.combineTemplates",args:["{that}.options.resources","{that}.options.selectors"]},surfaceSubpanelRendererSelectors:{funcName:"fluid.prefs.compositePanel.surfaceSubpanelRendererSelectors",args:["{that}","{that}.options.components","{that}.options.selectors"]},produceSubPanelTrees:{funcName:"fluid.prefs.compositePanel.produceSubPanelTrees",args:["{that}"]},expandProtoTree:{funcName:"fluid.prefs.compositePanel.expandProtoTree",args:["{that}"]},produceTree:{funcName:"fluid.prefs.compositePanel.produceTree",args:["{that}"]},hideInactive:{funcName:"fluid.prefs.compositePanel.hideInactive",args:["{that}"]},handleRenderOnPreference:{funcName:"fluid.prefs.compositePanel.handleRenderOnPreference",args:["{that}","{arguments}.0","{arguments}.1","{arguments}.2"]},conditionalCreateEvent:{funcName:"fluid.prefs.compositePanel.conditionalCreateEvent"}},subPanelOverrides:{gradeNames:["fluid.prefs.subPanel"]},rendererFnOptions:{noexpand:true,cutpointGenerator:"fluid.prefs.compositePanel.cutpointGenerator",subPanelRepeatingSelectors:{expander:{funcName:"fluid.prefs.compositePanel.surfaceRepeatingSelectors",args:["{that}.options.components"]}}},components:{},resources:{}});
a.prefs.compositePanel.prefetchComponentOptions=function(e,d){var c=a.getGradedDefaults(e,a.get(d,"gradeNames"));return a.merge(c.mergePolicy,c,d)};a.prefs.compositePanel.isPanel=function(d,c){var e=a.prefs.compositePanel.prefetchComponentOptions(d,c);return a.hasGrade(e,"fluid.prefs.panel")};a.prefs.compositePanel.isActivePanel=function(c){return c&&a.hasGrade(c.options,"fluid.prefs.panel")};a.prefs.compositePanel.assembleDistributeOptions=function(c){var d="fluid.prefs.compositePanel.distributeOptions_"+a.allocateGuid();var e=[];b.each(c,function(f,g){if(a.prefs.compositePanel.isPanel(g.type,g.options)){e.push({source:"{that}.options.subPanelOverrides",target:"{that > "+f+"}.options"})}});a.defaults(d,{gradeNames:["fluid.littleComponent","autoInit"],distributeOptions:e});return d};a.prefs.compositePanel.conditionalCreateEvent=function(d,c){if(d){c()}};a.prefs.compositePanel.handleRenderOnPreference=function(d,f,e,c){c=a.makeArray(c);d.conditionalCreateEvent(f,e);a.each(c,function(g){var h=d[g];if(!f&&h){h.destroy()}});d.refreshView()};a.prefs.compositePanel.creationEventName=function(c){return"initOn_"+c};a.prefs.compositePanel.generateModelListeners=function(c){return a.transform(c,function(f,d){var e=a.prefs.compositePanel.creationEventName(d);return{func:"{that}.handleRenderOnPreference",args:["{change}.value","{that}.events."+e+".fire",f]}})};a.prefs.compositePanel.subPanelLifecycleBindings=function(g){var i="fluid.prefs.compositePanel.subPanelCreationTimingDistibution_"+a.allocateGuid();var d=[];var f={"default":"initSubPanels"};var h={};var e={};var c={};b.each(g,function(k,n){if(a.prefs.compositePanel.isPanel(n.type,n.options)){var m="default";var o=a.get(n,"options.renderOnPreference");if(o){var j=a.prefs.subPanel.safePrefKey(o);var l="onCreate."+j;m=a.prefs.compositePanel.creationEventName(j);f[m]=m;c[m]=null;h[j]=h[j]||[];h[j].push(k);e[l]={listener:"{that}.conditionalCreateEvent",args:["{that}.model."+j,"{that}.events."+m+".fire"]}}d.push({source:"{that}.options.subPanelCreationOpts."+m,target:"{that}.options.components."+k+".createOnEvent"})}});a.defaults(i,{gradeNames:["fluid.eventedComponent","autoInit"],events:c,listeners:e,modelListeners:a.prefs.compositePanel.generateModelListeners(h),subPanelCreationOpts:f,distributeOptions:d});return i};a.prefs.compositePanel.hideInactive=function(c){a.each(c.options.components,function(e,d){if(a.prefs.compositePanel.isPanel(e.type,e.options)&&!a.prefs.compositePanel.isActivePanel(c[d])){c.locate(d).hide()}})};a.prefs.compositePanel.combineTemplates=function(i,g){var d=[];var c={children:[]};a.each(i,function(k,j){if(j!=="template"){c.children.push({ID:j,markup:k.resourceText});d.push({id:j,selector:g[j]})}});var e={base:{resourceText:i.template.resourceText,href:".",resourceKey:".",cutpoints:d}};var f=a.parseTemplates(e,["base"]);var h=a.renderer(f,c,{cutpoints:d,debugMode:true});i.template.resourceText=h.renderTemplates()};a.prefs.compositePanel.rebaseSelectorName=function(d,c){return d+"_"+c};a.prefs.compositePanel.surfaceSubpanelRendererSelectors=function(e,d,c){a.each(d,function(h,f){if(a.prefs.compositePanel.isPanel(h.type,h.options)){var g=a.prefs.compositePanel.prefetchComponentOptions(h.type,h.options);a.each(g.selectors,function(i,j){if(!g.selectorsToIgnore||b.inArray(j,g.selectorsToIgnore)<0){a.set(c,a.prefs.compositePanel.rebaseSelectorName(f,j),c[f]+" "+i)}})}})};a.prefs.compositePanel.surfaceRepeatingSelectors=function(d){var c=[];a.each(d,function(h,e){if(a.prefs.compositePanel.isPanel(h.type,h.options)){var f=a.prefs.compositePanel.prefetchComponentOptions(h.type,h.options);var g=a.transform(f.repeatingSelectors,function(i){return a.prefs.compositePanel.rebaseSelectorName(e,i)});c=c.concat(g)}});return c};a.prefs.compositePanel.cutpointGenerator=function(d,c){var e={selectorsToIgnore:c.selectorsToIgnore,repeatingSelectors:c.repeatingSelectors.concat(c.subPanelRepeatingSelectors)};return a.renderer.selectorsToCutpoints(d,e)};a.prefs.compositePanel.rebaseID=function(d,c){return c+"_"+d};a.prefs.compositePanel.rebaseParentRelativeID=function(e,d){var c="..::".length;return e.slice(0,c)+a.prefs.compositePanel.rebaseID(e.slice(c),d)};a.prefs.compositePanel.rebaseValueBinding=function(c,d){return a.find(d,function(f,e){if(c===f){return e}else{if(c.indexOf(f)===0){return c.replace(f,e)}}})||c};a.prefs.compositePanel.rebaseTree=function(d,c,e,g){var f=a.transform(c,function(k,i){if(i==="children"){return a.transform(k,function(l){return a.prefs.compositePanel.rebaseTree(d,l,e,g)})}else{if(i==="selection"){return a.prefs.compositePanel.rebaseTree(d,k,e,g)}else{if(i==="ID"){return a.prefs.compositePanel.rebaseID(k,e)}else{if(i==="parentRelativeID"){return a.prefs.compositePanel.rebaseParentRelativeID(k,e)}else{if(i==="valuebinding"){return a.prefs.compositePanel.rebaseValueBinding(k,g)}else{if(i==="value"&&c.valuebinding){var j=c.valuebinding;var h=a.get(d,a.prefs.compositePanel.rebaseValueBinding(j,g));return h!==undefined?h:k}else{return k}}}}}}});return f};a.prefs.compositePanel.produceTree=function(f){var e=f.options.produceTree;var g=e?(typeof(e)==="string"?a.getGlobalValue(e):e)(f):f.expandProtoTree();var d=f.produceSubPanelTrees();var c={children:g.children.concat(d.children)};return c};a.prefs.compositePanel.expandProtoTree=function(d){var c=a.renderer.modeliseOptions(d.options.expanderOptions,{ELstyle:"${}"},d);var e=a.renderer.makeProtoExpander(c,d);return e(d.options.protoTree||{})};a.prefs.compositePanel.produceSubPanelTrees=function(d){var c={children:[]};a.each(d.options.components,function(h,f){var e=d[f];if(a.prefs.compositePanel.isActivePanel(e)){var g=a.renderer.modeliseOptions(e.options.expanderOptions,{ELstyle:"${}"},e);var k=a.renderer.makeProtoExpander(g,e);var j=e.produceTree();j=a.get(e.options,"rendererFnOptions.noexpand")?j:k(j);var i=a.prefs.compositePanel.rebaseTree(d.model,j,f,e.options.rules);c.children=c.children.concat(i.children)}});return c};a.defaults("fluid.prefs.prefsEditorConnections",{gradeNames:["fluid.eventedComponent","autoInit"],mergePolicy:{sourceApplier:"nomerge"},sourceApplier:"{fluid.prefs.prefsEditor}.applier",listeners:{"{fluid.prefs.prefsEditor}.events.onPrefsEditorRefresh":"{fluid.prefs.panel}.refreshView"},strings:{},parentBundle:"{fluid.prefs.prefsEditorLoader}.msgResolver"});a.defaults("fluid.prefs.panel.textSize",{gradeNames:["fluid.prefs.panel","autoInit"],preferenceMap:{"fluid.prefs.textSize":{"model.textSize":"default","range.min":"minimum","range.max":"maximum"}},range:{min:1,max:2},selectors:{textSize:".flc-prefsEditor-min-text-size",label:".flc-prefsEditor-min-text-size-label",smallIcon:".flc-prefsEditor-min-text-size-smallIcon",largeIcon:".flc-prefsEditor-min-text-size-largeIcon",multiplier:".flc-prefsEditor-multiplier"},protoTree:{label:{messagekey:"textSizeLabel"},smallIcon:{messagekey:"textSizeSmallIcon"},largeIcon:{messagekey:"textSizeLargeIcon"},multiplier:{messagekey:"multiplier"},textSize:{decorators:{type:"fluid",func:"fluid.textfieldSlider",options:{rules:{textSize:"value"},model:{value:"{that}.model.textSize"},sourceApplier:"{that}.applier",range:"{that}.options.range",sliderOptions:"{that}.options.sliderOptions"}}}},sliderOptions:{orientation:"horizontal",step:0.1,range:"min"}});a.defaults("fluid.prefs.panel.textFont",{gradeNames:["fluid.prefs.panel","autoInit"],preferenceMap:{"fluid.prefs.textFont":{"model.value":"default","controlValues.textFont":"enum"}},selectors:{textFont:".flc-prefsEditor-text-font",label:".flc-prefsEditor-text-font-label"},stringArrayIndex:{textFont:["textFont-default","textFont-times","textFont-comic","textFont-arial","textFont-verdana"]},protoTree:{label:{messagekey:"textFontLabel"},textFont:{optionnames:"${{that}.msgLookup.textFont}",optionlist:"${{that}.options.controlValues.textFont}",selection:"${value}",decorators:{type:"fluid",func:"fluid.prefs.selectDecorator",options:{styles:"{that}.options.classnameMap.textFont"}}}},classnameMap:null,controlValues:{textFont:["default","times","comic","arial","verdana"]}});a.defaults("fluid.prefs.panel.lineSpace",{gradeNames:["fluid.prefs.panel","autoInit"],preferenceMap:{"fluid.prefs.lineSpace":{"model.lineSpace":"default","range.min":"minimum","range.max":"maximum"}},range:{min:1,max:2},selectors:{lineSpace:".flc-prefsEditor-line-space",label:".flc-prefsEditor-line-space-label",narrowIcon:".flc-prefsEditor-line-space-narrowIcon",wideIcon:".flc-prefsEditor-line-space-wideIcon",multiplier:".flc-prefsEditor-multiplier"},protoTree:{label:{messagekey:"lineSpaceLabel"},narrowIcon:{messagekey:"lineSpaceNarrowIcon"},wideIcon:{messagekey:"lineSpaceWideIcon"},multiplier:{messagekey:"multiplier"},lineSpace:{decorators:{type:"fluid",func:"fluid.textfieldSlider",options:{rules:{lineSpace:"value"},model:{value:"{that}.model.lineSpace"},sourceApplier:"{that}.applier",range:"{that}.options.range",sliderOptions:"{that}.options.sliderOptions"}}}},sliderOptions:{orientation:"horizontal",step:0.1,range:"min"}});a.defaults("fluid.prefs.panel.contrast",{gradeNames:["fluid.prefs.panel","autoInit"],preferenceMap:{"fluid.prefs.contrast":{"model.value":"default","controlValues.theme":"enum"}},listeners:{afterRender:"{that}.style"},selectors:{themeRow:".flc-prefsEditor-themeRow",themeLabel:".flc-prefsEditor-theme-label",themeInput:".flc-prefsEditor-themeInput",label:".flc-prefsEditor-contrast-label"},stringArrayIndex:{theme:["contrast-default","contrast-bw","contrast-wb","contrast-by","contrast-yb","contrast-lgdg"]},repeatingSelectors:["themeRow"],protoTree:{label:{messagekey:"contrastLabel"},expander:{type:"fluid.renderer.selection.inputs",rowID:"themeRow",labelID:"themeLabel",inputID:"themeInput",selectID:"theme-radio",tree:{optionnames:"${{that}.msgLookup.theme}",optionlist:"${{that}.options.controlValues.theme}",selection:"${value}"}}},controlValues:{theme:["default","bw","wb","by","yb","lgdg"]},markup:{label:'<span class="fl-preview-A">A</span><span class="fl-hidden-accessible">%theme</span><div class="fl-crossout"></div>'},invokers:{style:{funcName:"fluid.prefs.panel.contrast.style",args:["{that}.dom.themeLabel","{that}.msgLookup.theme","{that}.options.markup.label","{that}.options.controlValues.theme","{that}.options.classnameMap.theme"],dynamic:true}}});
a.prefs.panel.contrast.style=function(g,c,d,f,e){a.each(g,function(i,h){i=b(i);i.html(a.stringTemplate(d,{theme:c[h]}));i.addClass(e[f[h]])})};a.defaults("fluid.prefs.panel.layoutControls",{gradeNames:["fluid.prefs.panel","autoInit"],preferenceMap:{"fluid.prefs.tableOfContents":{"model.toc":"default"}},selectors:{toc:".flc-prefsEditor-toc",label:".flc-prefsEditor-toc-label",choiceLabel:".flc-prefsEditor-toc-choice-label"},protoTree:{label:{messagekey:"tocLabel"},choiceLabel:{messagekey:"tocChoiceLabel"},toc:"${toc}"}});a.defaults("fluid.prefs.panel.emphasizeLinks",{gradeNames:["fluid.prefs.panel","autoInit"],preferenceMap:{"fluid.prefs.emphasizeLinks":{"model.links":"default"}},selectors:{links:".flc-prefsEditor-links",linksChoiceLabel:".flc-prefsEditor-links-choice-label"},protoTree:{linksChoiceLabel:{messagekey:"linksChoiceLabel"},links:"${links}"}});a.defaults("fluid.prefs.panel.inputsLarger",{gradeNames:["fluid.prefs.panel","autoInit"],preferenceMap:{"fluid.prefs.inputsLarger":{"model.inputsLarger":"default"}},selectors:{inputsLarger:".flc-prefsEditor-inputs-larger",inputsChoiceLabel:".flc-prefsEditor-links-inputs-choice-label"},protoTree:{inputsChoiceLabel:{messagekey:"inputsChoiceLabel"},inputsLarger:"${inputsLarger}"}});a.defaults("fluid.prefs.panel.linksControls",{gradeNames:["fluid.prefs.compositePanel","autoInit"],selectors:{label:".flc-prefsEditor-linksControls-label"},protoTree:{label:{messagekey:"linksControlsLabel"}}});a.defaults("fluid.prefs.selectDecorator",{gradeNames:["fluid.viewComponent","autoInit"],listeners:{onCreate:"fluid.prefs.selectDecorator.decorateOptions"},styles:{preview:"fl-preview-theme"}});a.prefs.selectDecorator.decorateOptions=function(c){a.each(b("option",c.container),function(d){var e=c.options.styles;b(d).addClass(e.preview+" "+e[a.value(d)])})}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.prefs.modelRelay",{gradeNames:["fluid.modelComponent","fluid.eventedComponent","autoInit"],listenerNamespaces:[],mergePolicy:{sourceApplier:"nomerge"},listeners:{onCreate:"{that}.addListeners",onDestroy:"{that}.removeListeners"},invokers:{addListeners:{funcName:"fluid.prefs.modelRelay.addListeners",args:["{that}.options.rules","{that}.applier","{that}.options.sourceApplier","{that}.options.listenerNamespaces"]},removeListeners:{funcName:"fluid.prefs.modelRelay.removeListeners",args:["{that}.options.sourceApplier.modelChanged","{that}.options.listenerNamespaces"]}},rules:{}});a.prefs.modelRelay.removeListeners=function(c,d){a.each(d,function(e){c.removeListener(e)})};a.prefs.modelRelay.addListeners=function(e,d,c,f){a.each(e,function(h,i){var g=a.allocateGuid();f.push(g);a.addSourceGuardedListener(d,h,i,function(j){a.fireSourcedChange(c,i,a.get(j,h),h)});a.addSourceGuardedListener(c,i,h,function(j){a.fireSourcedChange(d,h,a.get(j,i),i)},null,g)})}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.prefs.enactor",{gradeNames:["fluid.modelComponent","fluid.eventedComponent","fluid.prefs.modelRelay","autoInit"]});a.defaults("fluid.prefs.uiEnhancerConnections",{gradeNames:["fluid.eventedComponent","autoInit"],mergePolicy:{sourceApplier:"nomerge"},sourceApplier:"{uiEnhancer}.applier"});a.defaults("fluid.prefs.enactor.styleElements",{gradeNames:["fluid.prefs.enactor","autoInit"],cssClass:null,invokers:{applyStyle:{funcName:"fluid.prefs.enactor.styleElements.applyStyle",args:["{arguments}.0","{arguments}.1"]},resetStyle:{funcName:"fluid.prefs.enactor.styleElements.resetStyle",args:["{arguments}.0","{arguments}.1"]},handleStyle:{funcName:"fluid.prefs.enactor.styleElements.handleStyle",args:["{arguments}.0",{expander:{func:"{that}.getElements"}},"{that}"],dynamic:true},getElements:"fluid.prefs.enactor.getElements"},listeners:{onCreate:{listener:"{that}.handleStyle",args:["{that}.model.value"]}}});a.prefs.enactor.styleElements.applyStyle=function(d,c){d.addClass(c)};a.prefs.enactor.styleElements.resetStyle=function(d,c){b(d,"."+c).andSelf().removeClass(c)};a.prefs.enactor.styleElements.handleStyle=function(e,d,c){if(e){c.applyStyle(d,c.options.cssClass)}else{c.resetStyle(d,c.options.cssClass)}};a.prefs.enactor.styleElements.finalInit=function(c){c.applier.modelChanged.addListener("value",function(d){c.handleStyle(d.value)})};a.defaults("fluid.prefs.enactor.classSwapper",{gradeNames:["fluid.viewComponent","fluid.prefs.enactor","autoInit"],classes:{},invokers:{clearClasses:{funcName:"fluid.prefs.enactor.classSwapper.clearClasses",args:["{that}.container","{that}.classStr"]},swap:{funcName:"fluid.prefs.enactor.classSwapper.swap",args:["{arguments}.0","{that}"]}},listeners:{onCreate:{listener:"{that}.swap",args:["{that}.model.value"]}},members:{classStr:{expander:{func:"fluid.prefs.enactor.classSwapper.joinClassStr",args:"{that}.options.classes"}}}});a.prefs.enactor.classSwapper.clearClasses=function(c,d){c.removeClass(d)};a.prefs.enactor.classSwapper.swap=function(d,c){c.clearClasses();c.container.addClass(c.options.classes[d])};a.prefs.enactor.classSwapper.joinClassStr=function(c){var d="";a.each(c,function(e){if(e){d+=d?" "+e:e}});return d};a.prefs.enactor.classSwapper.finalInit=function(c){c.applier.modelChanged.addListener("value",function(d){c.swap(d.value)})};a.defaults("fluid.prefs.enactor.emphasizeLinks",{gradeNames:["fluid.viewComponent","fluid.prefs.enactor.styleElements","autoInit"],preferenceMap:{"fluid.prefs.emphasizeLinks":{"model.value":"default"}},cssClass:null,invokers:{getElements:{funcName:"fluid.prefs.enactor.emphasizeLinks.getLinks",args:"{that}.container"}}});a.prefs.enactor.emphasizeLinks.getLinks=function(c){return b("a",c)};a.defaults("fluid.prefs.enactor.inputsLarger",{gradeNames:["fluid.viewComponent","fluid.prefs.enactor.styleElements","autoInit"],preferenceMap:{"fluid.prefs.inputsLarger":{"model.value":"default"}},cssClass:null,invokers:{getElements:{funcName:"fluid.prefs.enactor.inputsLarger.getInputs",args:"{that}.container"}}});a.prefs.enactor.inputsLarger.getInputs=function(c){return b("input, button",c)};a.defaults("fluid.prefs.enactor.textFont",{gradeNames:["fluid.prefs.enactor.classSwapper","autoInit"],preferenceMap:{"fluid.prefs.textFont":{"model.value":"default"}}});a.defaults("fluid.prefs.enactor.contrast",{gradeNames:["fluid.prefs.enactor.classSwapper","autoInit"],preferenceMap:{"fluid.prefs.contrast":{"model.value":"default"}}});a.prefs.enactor.getTextSizeInPx=function(c,d){var e=c.css("font-size");if(d[e]){e=d[e]}return parseFloat(e)};a.defaults("fluid.prefs.enactor.textSize",{gradeNames:["fluid.viewComponent","fluid.prefs.enactor","autoInit"],preferenceMap:{"fluid.prefs.textSize":{"model.value":"default"}},members:{root:{expander:{"this":"{that}.container",method:"closest",args:["html"]}}},fontSizeMap:{},invokers:{set:{funcName:"fluid.prefs.enactor.textSize.set",args:["{arguments}.0","{that}"]},getTextSizeInPx:{funcName:"fluid.prefs.enactor.getTextSizeInPx",args:["{that}.container","{that}.options.fontSizeMap"]}},listeners:{onCreate:{listener:"{that}.set",args:"{that}.model.value"}}});a.prefs.enactor.textSize.set=function(e,d){e=e||1;if(!d.initialSize){d.initialSize=d.getTextSizeInPx()}if(d.initialSize){var c=e*d.initialSize;d.root.css("font-size",c+"px")}};a.prefs.enactor.textSize.finalInit=function(c){c.applier.modelChanged.addListener("value",function(d){c.set(d.value)})};a.defaults("fluid.prefs.enactor.lineSpace",{gradeNames:["fluid.viewComponent","fluid.prefs.enactor","autoInit"],preferenceMap:{"fluid.prefs.lineSpace":{"model.value":"default"}},fontSizeMap:{},invokers:{set:{funcName:"fluid.prefs.enactor.lineSpace.set",args:["{arguments}.0","{that}"]},getTextSizeInPx:{funcName:"fluid.prefs.enactor.getTextSizeInPx",args:["{that}.container","{that}.options.fontSizeMap"]},getLineHeight:{funcName:"fluid.prefs.enactor.lineSpace.getLineHeight",args:"{that}.container"},getLineHeightMultiplier:{funcName:"fluid.prefs.enactor.lineSpace.getLineHeightMultiplier",args:[{expander:{func:"{that}.getLineHeight"}},{expander:{func:"{that}.getTextSizeInPx"}}],dynamic:true}},listeners:{onCreate:{listener:"{that}.set",args:"{that}.model.value"}}});a.prefs.enactor.lineSpace.getLineHeight=function(c){return c.css("line-height")};a.prefs.enactor.lineSpace.getLineHeightMultiplier=function(c,d){if(!c){return 0}if(c==="normal"){return 1.2}if(c.match(/[0-9]$/)){return c}return Math.round(parseFloat(c)/d*100)/100};a.prefs.enactor.lineSpace.set=function(e,d){if(!d.initialSize){d.initialSize=d.getLineHeightMultiplier()}if(d.initialSize){var c=e*d.initialSize;d.container.css("line-height",c)}};a.prefs.enactor.lineSpace.finalInit=function(c){c.applier.modelChanged.addListener("value",function(d){c.set(d.value)})};a.defaults("fluid.prefs.enactor.tableOfContents",{gradeNames:["fluid.viewComponent","fluid.prefs.enactor","autoInit"],preferenceMap:{"fluid.prefs.tableOfContents":{"model.value":"default"}},tocTemplate:null,components:{tableOfContents:{type:"fluid.tableOfContents",container:"{fluid.prefs.enactor.tableOfContents}.container",createOnEvent:"onCreateTOCReady",options:{components:{levels:{type:"fluid.tableOfContents.levels",options:{resources:{template:{forceCache:true,url:"{fluid.prefs.enactor.tableOfContents}.options.tocTemplate"}}}}},listeners:{afterRender:"{fluid.prefs.enactor.tableOfContents}.events.afterTocRender"}}}},invokers:{applyToc:{funcName:"fluid.prefs.enactor.tableOfContents.applyToc",args:["{arguments}.0","{that}"]}},events:{onCreateTOCReady:null,afterTocRender:null,onLateRefreshRelay:null},listeners:{onCreate:{listener:"{that}.applyToc",args:"{that}.model.value"}}});a.prefs.enactor.tableOfContents.applyToc=function(e,d){var c=false;if(e){if(d.tableOfContents){d.tableOfContents.show()}else{d.events.onCreateTOCReady.fire();c=true}}else{if(d.tableOfContents){d.tableOfContents.hide()}}if(!c){d.events.onLateRefreshRelay.fire(d)}};a.prefs.enactor.tableOfContents.finalInit=function(c){c.applier.modelChanged.addListener("value",function(d){c.applyToc(d.value)})};a.defaults("fluid.prefs.tocWithEmphasizeLinks",{gradeNames:["fluid.eventedComponent","autoInit"],listeners:{afterTocRender:{listener:"{uiEnhancer}.emphasizeLinks.handleStyle",args:"{uiEnhancer}.model.links"},onLateRefreshRelay:{listener:"{uiEnhancer}.emphasizeLinks.handleStyle",args:"{uiEnhancer}.model.links"}}});
a.defaults("fluid.prefs.tocWithInputsLarger",{gradeNames:["fluid.eventedComponent","autoInit"],listeners:{afterTocRender:{listener:"{uiEnhancer}.inputsLarger.handleStyle",args:"{uiEnhancer}.model.inputsLarger"},onLateRefreshRelay:{listener:"{uiEnhancer}.inputsLarger.handleStyle",args:"{uiEnhancer}.model.inputsLarger"}}});a.demands("fluid.prefs.enactor.tableOfContents","fluid.prefs.enactor.emphasizeLinks",{options:{gradeNames:"fluid.prefs.tocWithEmphasizeLinks"}});a.demands("fluid.prefs.enactor.tableOfContents","fluid.prefs.enactor.inputsLarger",{options:{gradeNames:"fluid.prefs.tocWithInputsLarger"}})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.prefs.rootModel.starter",{gradeNames:["fluid.prefs.rootModel","autoInit"],members:{rootModel:{textFont:"default",theme:"default",textSize:1,lineSpace:1,toc:false,links:false,inputsLarger:false}}});a.defaults("fluid.uiEnhancer.cssClassEnhancerBase",{gradeNames:["fluid.littleComponent","autoInit"],classnameMap:{textFont:{"default":"",times:"fl-font-prefsEditor-times",comic:"fl-font-prefsEditor-comic-sans",arial:"fl-font-prefsEditor-arial",verdana:"fl-font-prefsEditor-verdana"},theme:{"default":"fl-theme-prefsEditor-default",bw:"fl-theme-prefsEditor-bw fl-theme-bw",wb:"fl-theme-prefsEditor-wb fl-theme-wb",by:"fl-theme-prefsEditor-by fl-theme-by",yb:"fl-theme-prefsEditor-yb fl-theme-yb",lgdg:"fl-theme-prefsEditor-lgdg fl-theme-lgdg"},links:"fl-link-enhanced",inputsLarger:"fl-text-larger"}});a.defaults("fluid.uiEnhancer.browserTextEnhancerBase",{gradeNames:["fluid.littleComponent","autoInit"],fontSizeMap:{"xx-small":"9px","x-small":"11px",small:"13px",medium:"15px",large:"18px","x-large":"23px","xx-large":"30px"}});a.defaults("fluid.uiEnhancer.starterEnactors",{gradeNames:["fluid.uiEnhancer","fluid.uiEnhancer.cssClassEnhancerBase","fluid.uiEnhancer.browserTextEnhancerBase","autoInit"],connectionsGrade:"fluid.prefs.uiEnhancerConnections",distributeOptions:{source:"{that}.options.connectionsGrade",removeSource:true,target:"{that > fluid.prefs.enactor}.options.gradeNames"},components:{textSize:{type:"fluid.prefs.enactor.textSize",container:"{uiEnhancer}.container",options:{fontSizeMap:"{uiEnhancer}.options.fontSizeMap",rules:{textSize:"value"},model:{value:"{fluid.prefs.rootModel}.rootModel.textSize"}}},textFont:{type:"fluid.prefs.enactor.textFont",container:"{uiEnhancer}.container",options:{classes:"{uiEnhancer}.options.classnameMap.textFont",rules:{textFont:"value"},model:{value:"{fluid.prefs.rootModel}.rootModel.textFont"}}},lineSpace:{type:"fluid.prefs.enactor.lineSpace",container:"{uiEnhancer}.container",options:{fontSizeMap:"{uiEnhancer}.options.fontSizeMap",rules:{lineSpace:"value"},model:{value:"{fluid.prefs.rootModel}.rootModel.lineSpace"}}},contrast:{type:"fluid.prefs.enactor.contrast",container:"{uiEnhancer}.container",options:{classes:"{uiEnhancer}.options.classnameMap.theme",rules:{theme:"value"},model:{value:"{fluid.prefs.rootModel}.rootModel.theme"}}},emphasizeLinks:{type:"fluid.prefs.enactor.emphasizeLinks",container:"{uiEnhancer}.container",options:{cssClass:"{uiEnhancer}.options.classnameMap.links",rules:{links:"value"},model:{links:"{fluid.prefs.rootModel}.rootModel.links"}}},inputsLarger:{type:"fluid.prefs.enactor.inputsLarger",container:"{uiEnhancer}.container",options:{cssClass:"{uiEnhancer}.options.classnameMap.inputsLarger",rules:{inputsLarger:"value"},model:{inputsLarger:"{fluid.prefs.rootModel}.rootModel.inputsLarger"}}},tableOfContents:{type:"fluid.prefs.enactor.tableOfContents",container:"{uiEnhancer}.container",options:{tocTemplate:"{uiEnhancer}.options.tocTemplate",rules:{toc:"value"},model:{toc:"{fluid.prefs.rootModel}.rootModel.toc"}}}}});a.defaults("fluid.prefs.starterPanels",{gradeNames:["fluid.prefs.prefsEditor","autoInit"],selectors:{textSize:".flc-prefsEditor-text-size",textFont:".flc-prefsEditor-text-font",lineSpace:".flc-prefsEditor-line-space",contrast:".flc-prefsEditor-contrast",textControls:".flc-prefsEditor-text-controls",layoutControls:".flc-prefsEditor-layout-controls",linksControls:".flc-prefsEditor-links-controls"},components:{textSize:{type:"fluid.prefs.panel.textSize",container:"{prefsEditor}.dom.textSize",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",rules:{textSize:"textSize"},model:{value:"{fluid.prefs.rootModel}.rootModel.textSize"},resources:{template:"{templateLoader}.resources.textSize"}}},lineSpace:{type:"fluid.prefs.panel.lineSpace",container:"{prefsEditor}.dom.lineSpace",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",rules:{lineSpace:"lineSpace"},model:{value:"{fluid.prefs.rootModel}.rootModel.lineSpace"},resources:{template:"{templateLoader}.resources.lineSpace"}}},textFont:{type:"fluid.prefs.panel.textFont",container:"{prefsEditor}.dom.textFont",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",classnameMap:"{uiEnhancer}.options.classnameMap",rules:{textFont:"value"},model:{value:"{fluid.prefs.rootModel}.rootModel.textFont"},resources:{template:"{templateLoader}.resources.textFont"}}},contrast:{type:"fluid.prefs.panel.contrast",container:"{prefsEditor}.dom.contrast",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",classnameMap:"{uiEnhancer}.options.classnameMap",rules:{theme:"value"},model:{value:"{fluid.prefs.rootModel}.rootModel.theme"},resources:{template:"{templateLoader}.resources.contrast"}}},layoutControls:{type:"fluid.prefs.panel.layoutControls",container:"{prefsEditor}.dom.layoutControls",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",rules:{toc:"toc"},model:{toc:"{fluid.prefs.rootModel}.rootModel.toc"},resources:{template:"{templateLoader}.resources.layoutControls"}}},linksControls:{type:"fluid.prefs.panel.linksControls",container:"{prefsEditor}.dom.linksControls",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",rules:{links:"fluid_prefs_emphasizeLinks",inputsLarger:"fluid_prefs_inputsLarger"},selectors:{emphasizeLinks:".flc-prefsEditor-emphasizeLinks",inputsLarger:".flc-prefsEditor-inputsLarger"},selectorsToIgnore:["emphasizeLinks","inputsLarger"],model:{fluid_prefs_emphasizeLinks:"{fluid.prefs.rootModel}.rootModel.links",fluid_prefs_inputsLarger:"{fluid.prefs.rootModel}.rootModel.inputsLarger"},components:{emphasizeLinks:{type:"fluid.prefs.panel.emphasizeLinks",container:"{that}.dom.emphasizeLinks",createOnEvent:"initSubPanels"},inputsLarger:{type:"fluid.prefs.panel.inputsLarger",container:"{that}.dom.inputsLarger",createOnEvent:"initSubPanels"}},resources:{template:"{templateLoader}.resources.linksControls",emphasizeLinks:"{templateLoader}.resources.emphasizeLinks",inputsLarger:"{templateLoader}.resources.inputsLarger"}}}}});a.defaults("fluid.prefs.starterTemplateLoader",{gradeNames:["fluid.prefs.resourceLoader","autoInit"],templates:{textSize:"%prefix/PrefsEditorTemplate-textSize.html",textFont:"%prefix/PrefsEditorTemplate-textFont.html",lineSpace:"%prefix/PrefsEditorTemplate-lineSpace.html",contrast:"%prefix/PrefsEditorTemplate-contrast.html",layoutControls:"%prefix/PrefsEditorTemplate-layout.html",linksControls:"%prefix/PrefsEditorTemplate-linksControls.html",emphasizeLinks:"%prefix/PrefsEditorTemplate-emphasizeLinks.html",inputsLarger:"%prefix/PrefsEditorTemplate-inputsLarger.html"}});a.defaults("fluid.prefs.starterSeparatedPanelTemplateLoader",{gradeNames:["fluid.prefs.starterTemplateLoader","autoInit"],templates:{prefsEditor:"%prefix/SeparatedPanelPrefsEditor.html"}});a.defaults("fluid.prefs.starterFullPreviewTemplateLoader",{gradeNames:["fluid.prefs.starterTemplateLoader","autoInit"],templates:{prefsEditor:"%prefix/FullPreviewPrefsEditor.html"}});a.defaults("fluid.prefs.starterFullNoPreviewTemplateLoader",{gradeNames:["fluid.prefs.starterTemplateLoader","autoInit"],templates:{prefsEditor:"%prefix/FullNoPreviewPrefsEditor.html"}});a.defaults("fluid.prefs.starterMessageLoader",{gradeNames:["fluid.prefs.resourceLoader","autoInit"],templates:{prefsEditor:"%prefix/prefsEditor.json",textSize:"%prefix/textSize.json",textFont:"%prefix/textFont.json",lineSpace:"%prefix/lineSpace.json",contrast:"%prefix/contrast.json",layoutControls:"%prefix/tableOfContents.json",linksControls:"%prefix/linksControls.json",emphasizeLinks:"%prefix/emphasizeLinks.json",inputsLarger:"%prefix/inputsLarger.json"}})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.dom");a.dom.getDocumentHeight=function(d){var c=b("body",d)[0];return c.offsetHeight};a.defaults("fluid.prefs.separatedPanel",{gradeNames:["fluid.prefs.prefsEditorLoader","autoInit"],events:{afterRender:null,onReady:null,onCreateSlidingPanelReady:{events:{iframeRendered:"afterRender",onMsgResolverReady:"onMsgResolverReady"}},templatesAndIframeReady:{events:{iframeReady:"afterRender",templatesLoaded:"onPrefsEditorTemplatesLoaded",messagesLoaded:"onPrefsEditorMessagesLoaded"}}},listeners:{onReady:{listener:"fluid.prefs.separatedPanel.bindEvents",args:["{separatedPanel}.prefsEditor","{iframeRenderer}.iframeEnhancer","{separatedPanel}"]},onCreate:{listener:"fluid.prefs.separatedPanel.hideReset",args:["{separatedPanel}"]}},selectors:{reset:".flc-prefsEditor-reset",iframe:".flc-prefsEditor-iframe"},invokers:{bindReset:{funcName:"fluid.bind",args:["{separatedPanel}.dom.reset","click","{arguments}.0"]}},components:{pageEnhancer:"{uiEnhancer}",slidingPanel:{type:"fluid.slidingPanel",container:"{separatedPanel}.container",createOnEvent:"onCreateSlidingPanelReady",options:{gradeNames:["fluid.prefs.msgLookup"],members:{messageResolver:"{separatedPanel}.msgResolver"},strings:{showText:"{that}.msgLookup.slidingPanelShowText",hideText:"{that}.msgLookup.slidingPanelHideText"},invokers:{operateShow:{funcName:"fluid.prefs.separatedPanel.showPanel",args:["{that}.dom.panel","{that}.events.afterPanelShow.fire"],"this":null,method:null},operateHide:{funcName:"fluid.prefs.separatedPanel.hidePanel",args:["{that}.dom.panel","{iframeRenderer}.iframe","{that}.events.afterPanelHide.fire"],"this":null,method:null}}}},iframeRenderer:{type:"fluid.prefs.separatedPanel.renderIframe",container:"{separatedPanel}.dom.iframe",options:{markupProps:{src:"%templatePrefix/SeparatedPanelPrefsEditorFrame.html"},events:{afterRender:"{separatedPanel}.events.afterRender"},components:{iframeEnhancer:{type:"fluid.uiEnhancer",container:"{iframeRenderer}.renderPrefsEditorContainer",createOnEvent:"afterRender",options:{gradeNames:["{pageEnhancer}.options.gradeNames"],jQuery:"{iframeRenderer}.jQuery",tocTemplate:"{pageEnhancer}.options.tocTemplate"}}}}},prefsEditor:{createOnEvent:"templatesAndIframeReady",container:"{iframeRenderer}.renderPrefsEditorContainer",options:{gradeNames:["fluid.prefs.uiEnhancerRelay"],model:"{separatedPanel}.model",applier:"{separatedPanel}.applier",events:{onSignificantDOMChange:null,updateEnhancerModel:"{that}.events.modelChanged"},listeners:{modelChanged:"{that}.save",onCreate:{listener:"{separatedPanel}.bindReset",args:["{that}.reset"]},onReset:"{that}.applyChanges",onReady:{listener:"{separatedPanel}.events.onReady",args:"{separatedPanel}"}}}}},outerEnhancerOptions:"{originalEnhancerOptions}.options.originalUserOptions",distributeOptions:[{source:"{that}.options.slidingPanel",removeSource:true,target:"{that > slidingPanel}.options"},{source:"{that}.options.iframeRenderer",removeSource:true,target:"{that > iframeRenderer}.options"},{source:"{that}.options.iframe",removeSource:true,target:"{that}.options.selectors.iframe"},{source:"{that}.options.outerEnhancerOptions",removeSource:true,target:"{that iframeEnhancer}.options"},{source:"{that}.options.templatePrefix",target:"{that > iframeRenderer}.options.templatePrefix"}]});
a.prefs.separatedPanel.hideReset=function(c){c.locate("reset").hide()};a.defaults("fluid.prefs.separatedPanel.renderIframe",{gradeNames:["fluid.viewComponent","autoInit"],events:{afterRender:null},styles:{containerFlex:"fl-container-flex",container:"fl-prefsEditor-separatedPanel-iframe"},templatePrefix:"./",markupProps:{"class":"flc-iframe",src:"%templatePrefix/prefsEditorIframe.html"}});a.prefs.separatedPanel.renderIframe.finalInit=function(d){var c=d.options.styles;d.options.markupProps.src=a.stringTemplate(d.options.markupProps.src,{"templatePrefix/":d.options.templatePrefix});d.iframeSrc=d.options.markupProps.src;d.iframe=b("<iframe/>");d.iframe.load(function(){var e=d.iframe[0].contentWindow;d.iframeDocument=e.document;d.jQuery=e.jQuery;d.renderPrefsEditorContainer=d.jQuery("body",d.iframeDocument);d.jQuery(d.iframeDocument).ready(d.events.afterRender.fire)});d.iframe.attr(d.options.markupProps);d.iframe.addClass(c.containerFlex);d.iframe.addClass(c.container);d.iframe.hide();d.iframe.appendTo(d.container)};a.prefs.separatedPanel.updateView=function(c){c.events.onPrefsEditorRefresh.fire();c.events.onSignificantDOMChange.fire()};a.prefs.separatedPanel.bindEvents=function(e,c,d){d.slidingPanel.events.afterPanelShow.addListener(function(){a.prefs.separatedPanel.updateView(e)});e.events.onPrefsEditorRefresh.addListener(function(){c.updateModel(e.model)});e.events.onReset.addListener(function(f){a.prefs.separatedPanel.updateView(f)});e.events.onSignificantDOMChange.addListener(function(){var j=e.container[0].ownerDocument;var f=a.dom.getDocumentHeight(j);var i=d.iframeRenderer.iframe;var h={height:f+15};var g=d.slidingPanel.locate("panel");g.css({height:""});i.animate(h,400)});d.slidingPanel.events.afterPanelHide.addListener(function(){d.iframeRenderer.iframe.height(0);d.iframeRenderer.iframe.hide()});d.slidingPanel.events.onPanelShow.addListener(function(){d.iframeRenderer.iframe.show();d.locate("reset").show()});d.slidingPanel.events.onPanelHide.addListener(function(){d.locate("reset").hide()})};a.prefs.separatedPanel.hidePanel=function(c,d,e){d.clearQueue();b(c).animate({height:0},{duration:400,complete:e})};a.prefs.separatedPanel.showPanel=function(c,d){setTimeout(d,1)}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.prefs.fullNoPreview",{gradeNames:["fluid.prefs.prefsEditorLoader","autoInit"],components:{prefsEditor:{container:"{that}.container",options:{listeners:{onReset:[{listener:"{that}.applyChanges"},{listener:"{that}.save"}],onReady:{listener:"{fullNoPreview}.events.onReady",args:"{fullNoPreview}"}}}}},events:{onReady:null}})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.defaults("fluid.prefs.fullPreview",{gradeNames:["fluid.prefs.prefsEditorLoader","autoInit"],outerPreviewEnhancerOptions:"{originalEnhancerOptions}.options.originalUserOptions",components:{prefsEditor:{container:"{that}.container",options:{components:{preview:{type:"fluid.prefs.preview",createOnEvent:"onReady",container:"{prefsEditor}.dom.previewFrame",options:{listeners:{onReady:"{fullPreview}.events.onPreviewReady"}}}},listeners:{onReady:"{fullPreview}.events.onPrefsEditorReady"},distributeOptions:{source:"{that}.options.preview",removeSource:true,target:"{that > preview}.options"}}}},events:{onPrefsEditorReady:null,onPreviewReady:null,onReady:{events:{onPrefsEditorReady:"onPrefsEditorReady",onPreviewReady:"onPreviewReady"},args:"{that}"}},distributeOptions:[{source:"{that}.options.outerPreviewEnhancerOptions",removeSource:true,target:"{that enhancer}.options"},{source:"{that}.options.preview",target:"{that preview}.options"},{source:"{that}.options.previewEnhancer",removeSource:true,target:"{that enhancer}.options"}]})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.prefs.schemas");a.prefs.schemas.merge=function(d,c){if(!d){d={type:"object",properties:{}}}c=c.properties||c;b.extend(true,d.properties,c);return d};a.defaults("fluid.prefs.primaryBuilder",{gradeNames:["fluid.littleComponent","autoInit","{that}.buildPrimary"],schemaIndex:{expander:{func:"fluid.indexDefaults",args:["schemaIndex",{gradeNames:"fluid.prefs.schemas",indexFunc:"fluid.prefs.primaryBuilder.defaultSchemaIndexer"}]}},primarySchema:{},typeFilter:[],invokers:{buildPrimary:{funcName:"fluid.prefs.primaryBuilder.buildPrimary",args:["{that}.options.schemaIndex","{that}.options.typeFilter","{that}.options.primarySchema"]}}});a.prefs.primaryBuilder.buildPrimary=function(c,f,e){var g="fluid.prefs.schemas.suppliedPrimary"+a.allocateGuid();a.defaults(g,{gradeNames:["autoInit","fluid.prefs.schemas"],schema:a.filterKeys(e.properties||e,f,false)});var d=[];a.each(f,function h(i){var j=c[i];if(j){d.push.apply(d,j)}});d.push(g);return d};a.prefs.primaryBuilder.defaultSchemaIndexer=function(c){if(c.schema){return a.keys(c.schema.properties)}};a.defaults("fluid.prefs.schemas",{gradeNames:["autoInit","fluid.littleComponent"],mergePolicy:{schema:a.prefs.schemas.merge}})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.prefs");a.defaults("fluid.prefs.auxSchema",{gradeNames:["fluid.littleComponent","autoInit"],auxiliarySchema:{}});a.prefs.expandSchemaValue=function(c,d){if(d.charAt(0)!=="@"){return d}return a.get(c,d.substring(1))};a.prefs.addAtPath=function(d,f,e){var c=a.get(d,f);a.set(d,f,b.extend(true,{},c,e));return d};a.prefs.removeKey=function(c,d){var e=c[d];delete c[d];return e};a.prefs.rearrangeDirect=function(d,g,f){var c={};var e=a.prefs.removeKey(d,f);if(e){a.set(c,g,e)}return c};a.prefs.addCommonOptions=function(c,i,h,g){g=g||{};var d=a.get(c,i);if(!d){return c}var f={},e={};a.each(h,function(l,k){if(k==="container"){var j=a.get(c,[i,"type"]);var m=a.defaults(j);if(a.get(m,["argumentMap","container"])===undefined){return false}}if(k.indexOf("gradeNames")!==-1){e[k]=a.arrayConcatPolicy}k=a.stringTemplate(k,g);l=typeof(l)==="string"?a.stringTemplate(l,g):l;a.set(f,k,l)});a.set(c,i,a.merge(e,d,f));return c};a.prefs.containerNeeded=function(c,e){var d=a.get(c,[e,"type"]);var f=a.defaults(d);return(a.hasGrade(f,"fluid.viewComponent")||a.hasGrade(f,"fluid.rendererComponent"))};a.prefs.checkPrimarySchema=function(c,d){if(!c){a.fail("The primary schema for "+d+" is not defined.")}return !!c};a.prefs.expandSchemaComponents=function(j,d,p,g,i,q,m){var s=a.copy(g)||{};var o={};var h={};var l=a.prefs.removeKey(s,"type");var v=new RegExp("\\.","g");var e=l.replace(v,"_");var r=p.replace(v,"_");if(l){o[e]={type:l,options:s};var f=a.prefs.rearrangeDirect(s,e,"container");var c=a.prefs.rearrangeDirect(s,e,"template");var t=a.prefs.rearrangeDirect(s,e,"message");var k=a.defaults(l).preferenceMap;var u=k[p];var n=m[p];a.each(u,function(w,z){if(a.prefs.checkPrimarySchema(n,p)){var x={};if(z.indexOf("model.")===0){var y=z.slice(6);a.set(x,["rules",r],y);a.set(x,["model",y],n[w]);a.set(h,["members","rootModel",r],n[w])}else{a.set(x,z,n[w])}b.extend(true,s,x)}});a.prefs.addCommonOptions(o,e,q,{prefKey:e});a.prefs.addAtPath(j,[d,"components"],o);a.prefs.addAtPath(j,[d,"selectors"],f);a.prefs.addAtPath(j,["templateLoader","templates"],c);a.prefs.addAtPath(j,["messageLoader","templates"],t);a.prefs.addAtPath(j,"rootModel",h)}return j};a.prefs.expandSchemaDirectOption=function(c,d,f){var e=c[d];if(e){delete c[d];a.set(c,f,e)}};a.prefs.expandSchemaImpl=function(c,d){var e=a.copy(c);d=d||e;a.each(e,function(g,f){if(typeof g==="object"){e[f]=a.prefs.expandSchemaImpl(g,d)}else{if(typeof g==="string"){var h=a.prefs.expandSchemaValue(d,g);if(h!==undefined){e[f]=h}else{delete e[f]}}}});return e};a.prefs.expandCompositePanels=function(d,i,h,c,g,j,f){var e=[];a.each(i,function(l,u){var o={};var r={};var p={};var v={};var t={};var n={};var k=[];var q=a.copy(l);a.set(o,"type",q.type);delete q.type;v=a.prefs.rearrangeDirect(q,u,"container");t=a.prefs.rearrangeDirect(q,u,"template");n=a.prefs.rearrangeDirect(q,u,"message");var w=[];var s={};var m={};if(!a.isPrimitive(q.panels)){a.each(q.panels,function(y,x){w=w.concat(y);if(x!=="always"){a.each(y,function(z){a.set(m,z,x)})}})}else{w=q.panels}a.each(w,function(E){e.push(E);var y=a.get(d,[E,"type"]);var A=a.prefs.subPanel.safePrefKey(y);k.push(A);var D=a.copy(a.get(d,[E,"panel"]));var C=a.get(D,"type");a.set(s,[A,"type"],C);var x=a.get(m,E);if(x){a.set(s,[A,"options","renderOnPreference"],x)}var B=a.defaults(C).preferenceMap[y];var z=f[y];a.each(B,function(F,H){if(a.prefs.checkPrimarySchema(z,y)){var G;if(H.indexOf("model.")===0){a.set(o,["options","rules",A],A);a.set(o,["options","model",A],z[F]);a.set(p,["members","rootModel",A],z[F])}else{G=G||{options:{}};a.set(G,"options."+H,z[F])}b.extend(true,s[A],G)}});a.set(t,A,a.get(D,"template"));a.set(n,A,a.get(D,"message"));a.set(o,["options","selectors",A],a.get(D,"container"));a.set(o,["options","resources"],a.get(o,["options","resources"])||{});a.prefs.addCommonOptions(o.options,"resources",j,{subPrefKey:A});delete D.type;delete D.template;delete D.message;delete D.container;a.set(s,[A,"options"],b.extend(true,{},a.get(s,[A,"options"]),D));a.prefs.addCommonOptions(s,A,g,{compositePanel:u,prefKey:A})});delete q.panels;a.set(o,["options"],b.extend(true,{},o.options,q));a.set(o,["options","selectorsToIgnore"],k);a.set(o,["options","components"],s);r[u]=o;a.prefs.addCommonOptions(r,u,c,{prefKey:u});a.prefs.addAtPath(d,["panels","components"],r);a.prefs.addAtPath(d,["panels","selectors"],v);a.prefs.addAtPath(d,["templateLoader","templates"],t);a.prefs.addAtPath(d,["messageLoader","templates"],n);a.prefs.addAtPath(d,"rootModel",p);b.extend(true,d,{panelsToIgnore:e})});return d};a.prefs.expandSchema=function(d,f,g,c,i){var e=a.prefs.expandSchemaImpl(d);e.namespace=e.namespace||"fluid.prefs.created_"+a.allocateGuid();var h=a.get(e,"groups");if(h){a.prefs.expandCompositePanels(e,h,a.get(f,"panel"),a.get(c,"panel"),a.get(c,"subPanel"),a.get(c,"compositePanelBasedOnSub"),i)}a.each(e,function(l,j){var k="panel";if(l[k]&&b.inArray(j,e.panelsToIgnore)===-1){a.prefs.expandSchemaComponents(e,"panels",l.type,l[k],a.get(f,k),a.get(c,k),i)
}k="enactor";if(l[k]){a.prefs.expandSchemaComponents(e,"enactors",l.type,l[k],a.get(f,k),a.get(c,k),i)}k="template";if(j===k){a.set(e,["templateLoader","templates","prefsEditor"],e[k]);delete e[k]}k="templatePrefix";if(j===k){a.prefs.expandSchemaDirectOption(e,k,"templatePrefix.templatePrefix")}k="message";if(j===k){a.set(e,["messageLoader","templates","prefsEditor"],e[k]);delete e[k]}k="messagePrefix";if(j===k){a.prefs.expandSchemaDirectOption(e,k,"messagePrefix.messagePrefix")}});if(e.panelsToIgnore){delete e.panelsToIgnore}a.each(g,function(j,k){a.prefs.addCommonOptions(e,k,j)});return e};a.defaults("fluid.prefs.auxBuilder",{gradeNames:["fluid.prefs.auxSchema","autoInit"],mergePolicy:{elementCommonOptions:"noexpand"},topCommonOptions:{panels:{gradeNames:["fluid.prefs.prefsEditor","autoInit"]},enactors:{gradeNames:["fluid.uiEnhancer","autoInit"]},templateLoader:{gradeNames:["fluid.prefs.resourceLoader","autoInit"]},messageLoader:{gradeNames:["fluid.prefs.resourceLoader","autoInit"]},rootModel:{gradeNames:["fluid.prefs.rootModel","autoInit"]},templatePrefix:{gradeNames:["fluid.littleComponent","autoInit"]},messagePrefix:{gradeNames:["fluid.littleComponent","autoInit"]}},elementCommonOptions:{panel:{createOnEvent:"onPrefsEditorMarkupReady",container:"{prefsEditor}.dom.%prefKey","options.gradeNames":"fluid.prefs.prefsEditorConnections","options.resources.template":"{templateLoader}.resources.%prefKey"},compositePanelBasedOnSub:{"%subPrefKey":"{templateLoader}.resources.%subPrefKey"},subPanel:{container:"{%compositePanel}.dom.%prefKey"},enactor:{"options.gradeNames":"fluid.prefs.uiEnhancerConnections",container:"{uiEnhancer}.container"}},indexes:{panel:{expander:{func:"fluid.indexDefaults",args:["panelsIndex",{gradeNames:"fluid.prefs.panel",indexFunc:"fluid.prefs.auxBuilder.prefMapIndexer"}]}},enactor:{expander:{func:"fluid.indexDefaults",args:["enactorsIndex",{gradeNames:"fluid.prefs.enactor",indexFunc:"fluid.prefs.auxBuilder.prefMapIndexer"}]}}},mappedDefaults:{},expandedAuxSchema:{expander:{func:"fluid.prefs.expandSchema",args:["{that}.options.auxiliarySchema","{that}.options.indexes","{that}.options.topCommonOptions","{that}.options.elementCommonOptions","{that}.options.mappedDefaults"]}}});a.prefs.auxBuilder.prefMapIndexer=function(c){return a.keys(c.preferenceMap)}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(a){a.defaults("fluid.prefs.auxSchema.starter",{gradeNames:["fluid.prefs.auxSchema","autoInit"],auxiliarySchema:{namespace:"fluid.prefs.constructed",templatePrefix:"../../framework/preferences/html/",template:"%prefix/SeparatedPanelPrefsEditor.html",messagePrefix:"../../framework/preferences/messages/",message:"%prefix/prefsEditor.json",textSize:{type:"fluid.prefs.textSize",enactor:{type:"fluid.prefs.enactor.textSize"},panel:{type:"fluid.prefs.panel.textSize",container:".flc-prefsEditor-text-size",template:"%prefix/PrefsEditorTemplate-textSize.html",message:"%prefix/textSize.json"}},lineSpace:{type:"fluid.prefs.lineSpace",enactor:{type:"fluid.prefs.enactor.lineSpace",fontSizeMap:{"xx-small":"9px","x-small":"11px",small:"13px",medium:"15px",large:"18px","x-large":"23px","xx-large":"30px"}},panel:{type:"fluid.prefs.panel.lineSpace",container:".flc-prefsEditor-line-space",template:"%prefix/PrefsEditorTemplate-lineSpace.html",message:"%prefix/lineSpace.json"}},textFont:{type:"fluid.prefs.textFont",classes:{"default":"",times:"fl-font-prefsEditor-times",comic:"fl-font-prefsEditor-comic-sans",arial:"fl-font-prefsEditor-arial",verdana:"fl-font-prefsEditor-verdana"},enactor:{type:"fluid.prefs.enactor.textFont",classes:"@textFont.classes"},panel:{type:"fluid.prefs.panel.textFont",container:".flc-prefsEditor-text-font",classnameMap:{textFont:"@textFont.classes"},template:"%prefix/PrefsEditorTemplate-textFont.html",message:"%prefix/textFont.json"}},contrast:{type:"fluid.prefs.contrast",classes:{"default":"fl-theme-prefsEditor-default",bw:"fl-theme-prefsEditor-bw fl-theme-bw",wb:"fl-theme-prefsEditor-wb fl-theme-wb",by:"fl-theme-prefsEditor-by fl-theme-by",yb:"fl-theme-prefsEditor-yb fl-theme-yb",lgdg:"fl-theme-prefsEditor-lgdg fl-theme-lgdg"},enactor:{type:"fluid.prefs.enactor.contrast",classes:"@contrast.classes"},panel:{type:"fluid.prefs.panel.contrast",container:".flc-prefsEditor-contrast",classnameMap:{theme:"@contrast.classes"},template:"%prefix/PrefsEditorTemplate-contrast.html",message:"%prefix/contrast.json"}},tableOfContents:{type:"fluid.prefs.tableOfContents",enactor:{type:"fluid.prefs.enactor.tableOfContents",tocTemplate:"../../components/tableOfContents/html/TableOfContents.html"},panel:{type:"fluid.prefs.panel.layoutControls",container:".flc-prefsEditor-layout-controls",template:"%prefix/PrefsEditorTemplate-layout.html",message:"%prefix/tableOfContents.json"}},emphasizeLinks:{type:"fluid.prefs.emphasizeLinks",enactor:{type:"fluid.prefs.enactor.emphasizeLinks",cssClass:"fl-link-enhanced"},panel:{type:"fluid.prefs.panel.emphasizeLinks",container:".flc-prefsEditor-emphasizeLinks",template:"%prefix/PrefsEditorTemplate-emphasizeLinks.html",message:"%prefix/emphasizeLinks.json"}},inputsLarger:{type:"fluid.prefs.inputsLarger",enactor:{type:"fluid.prefs.enactor.inputsLarger",cssClass:"fl-text-larger"},panel:{type:"fluid.prefs.panel.inputsLarger",container:".flc-prefsEditor-inputsLarger",template:"%prefix/PrefsEditorTemplate-inputsLarger.html",message:"%prefix/inputsLarger.json"}},groups:{linksControls:{container:".flc-prefsEditor-links-controls",template:"%prefix/PrefsEditorTemplate-linksControls.html",message:"%prefix/linksControls.json",type:"fluid.prefs.panel.linksControls",panels:["emphasizeLinks","inputsLarger"]}}}});a.defaults("fluid.prefs.schemas.textSize",{gradeNames:["autoInit","fluid.prefs.schemas"],schema:{"fluid.prefs.textSize":{type:"number","default":1,minimum:1,maximum:2,divisibleBy:0.1}}});a.defaults("fluid.prefs.schemas.lineSpace",{gradeNames:["autoInit","fluid.prefs.schemas"],schema:{"fluid.prefs.lineSpace":{type:"number","default":1,minimum:1,maximum:2,divisibleBy:0.1}}});a.defaults("fluid.prefs.schemas.textFont",{gradeNames:["autoInit","fluid.prefs.schemas"],schema:{"fluid.prefs.textFont":{type:"string","default":"default","enum":["default","times","comic","arial","verdana"]}}});a.defaults("fluid.prefs.schemas.contrast",{gradeNames:["autoInit","fluid.prefs.schemas"],schema:{"fluid.prefs.contrast":{type:"string","default":"default","enum":["default","bw","wb","by","yb","lgdg"]}}});a.defaults("fluid.prefs.schemas.tableOfContents",{gradeNames:["autoInit","fluid.prefs.schemas"],schema:{"fluid.prefs.tableOfContents":{type:"boolean","default":false}}});a.defaults("fluid.prefs.schemas.emphasizeLinks",{gradeNames:["autoInit","fluid.prefs.schemas"],schema:{"fluid.prefs.emphasizeLinks":{type:"boolean","default":false}}});a.defaults("fluid.prefs.schemas.inputsLarger",{gradeNames:["autoInit","fluid.prefs.schemas"],schema:{"fluid.prefs.inputsLarger":{type:"boolean","default":false}}})})(fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.prefs");a.defaults("fluid.prefs.builder",{gradeNames:["fluid.eventedComponent","fluid.prefs.auxBuilder","autoInit"],mergePolicy:{auxSchema:"expandedAuxSchema"},assembledPrefsEditorGrade:{expander:{func:"fluid.prefs.builder.generateGrade",args:["prefsEditor","{that}.options.auxSchema.namespace",{gradeNames:["fluid.viewComponent","autoInit","fluid.prefs.assembler.prefsEd"],componentGrades:"{that}.options.constructedGrades"}]}},assembledUIEGrade:{expander:{func:"fluid.prefs.builder.generateGrade",args:["uie","{that}.options.auxSchema.namespace",{gradeNames:["fluid.viewComponent","autoInit","fluid.prefs.assembler.uie"],componentGrades:"{that}.options.constructedGrades"}]}},constructedGrades:{expander:{func:"fluid.prefs.builder.constructGrades",args:["{that}.options.auxSchema",["enactors","messages","panels","rootModel","templateLoader","messageLoader","templatePrefix","messagePrefix"]]}},mappedDefaults:"{primaryBuilder}.options.schema.properties",components:{primaryBuilder:{type:"fluid.prefs.primaryBuilder",options:{typeFilter:{expander:{func:"fluid.prefs.builder.parseAuxSchema",args:"{builder}.options.auxiliarySchema"}}}}},distributeOptions:[{source:"{that}.options.primarySchema",removeSource:true,target:"{that > primaryBuilder}.options.primarySchema"}]});a.defaults("fluid.prefs.assembler.uie",{gradeNames:["autoInit","fluid.viewComponent"],components:{store:{type:"fluid.littleComponent",options:{gradeNames:["{that}.options.storeType"],storeType:"fluid.globalSettingsStore"}},enhancer:{type:"fluid.littleComponent",options:{gradeNames:"{that}.options.enhancerType",enhancerType:"fluid.pageEnhancer",components:{uiEnhancer:{options:{gradeNames:["{fluid.prefs.assembler.uie}.options.componentGrades.enactors"]}}}}}},distributeOptions:[{source:"{that}.options.enhancer",removeSource:true,target:"{that uiEnhancer}.options"},{source:"{that}.options.store",removeSource:true,target:"{that settingsStore}.options"},{source:"{that}.options.storeType",removeSource:true,target:"{that > store}.options.storeType"},{source:"{that}.options.enhancerType",removeSource:true,target:"{that > enhancer}.options.enhancerType"}]});a.defaults("fluid.prefs.assembler.prefsEd",{gradeNames:["autoInit","fluid.viewComponent","fluid.prefs.assembler.uie"],components:{prefsEditorLoader:{type:"fluid.viewComponent",container:"{fluid.prefs.assembler.prefsEd}.container",priority:"last",options:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.templatePrefix","{fluid.prefs.assembler.prefsEd}.options.componentGrades.messagePrefix","{fluid.prefs.assembler.prefsEd}.options.componentGrades.messages","{that}.options.prefsEditorType"],prefsEditorType:"fluid.prefs.separatedPanel",templateLoader:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.templateLoader"]},messageLoader:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.messageLoader"]},prefsEditor:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.panels","{fluid.prefs.assembler.prefsEd}.options.componentGrades.rootModel","fluid.prefs.uiEnhancerRelay"]},events:{onReady:"{fluid.prefs.assembler.prefsEd}.events.onPrefsEditorReady"}}}},events:{onPrefsEditorReady:null,onReady:{events:{onPrefsEditorReady:"onPrefsEditorReady",onCreate:"onCreate"},args:["{that}"]}},distributeOptions:[{source:"{that}.options.prefsEditorType",removeSource:true,target:"{that > prefsEditorLoader}.options.prefsEditorType"},{source:"{that}.options.prefsEditor",removeSource:true,target:"{that prefsEditor}.options"},{source:"{that}.options.templatePrefix",removeSource:true,target:"{that prefsEditorLoader}.options.templatePrefix"},{source:"{that}.options.messagePrefix",removeSource:true,target:"{that prefsEditorLoader}.options.messagePrefix"}]});
a.prefs.builder.generateGrade=function(e,f,d){var c="%namespace.%name";var g=a.stringTemplate(c,{name:e,namespace:f});a.defaults(g,d);return g};a.prefs.builder.constructGrades=function(c,d){var e={};a.each(d,function(g){var f=c[g];if(a.get(f,"gradeNames")){e[g]=a.prefs.builder.generateGrade(g,c.namespace,f)}});return e};a.prefs.builder.parseAuxSchema=function(c){var e=[];a.each(c,function d(g){var f=g.type;if(f){e.push(f)}});return e};a.prefs.create=function(c,e){e=e||{};var d=a.prefs.builder(e.build);return a.invokeGlobalFunction(d.options.assembledPrefsEditorGrade,[c,e.prefsEditor])}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.prefs.builder({gradeNames:["fluid.prefs.auxSchema.starter"]});a.defaults("fluid.uiOptions.prefsEditor",{gradeNames:["fluid.prefs.constructed.prefsEditor","autoInit"],distributeOptions:{source:"{that}.options.tocTemplate",removeSource:true,target:"{that uiEnhancer}.options.tocTemplate"},enhancer:{distributeOptions:{source:"{that}.options.tocTemplate",removeSource:true,target:"{that > fluid.prefs.enactor.tableOfContents}.options.tocTemplate"}}})})(jQuery,fluid_1_5);(function(c){var a=c.scrollTo=function(f,e,d){c(window).scrollTo(f,e,d)};a.defaults={axis:"xy",duration:parseFloat(c.fn.jquery)>=1.3?0:1};a.window=function(d){return c(window)._scrollable()};c.fn._scrollable=function(){return this.map(function(){var e=this,d=!e.nodeName||c.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!d){return e}var f=(e.contentWindow||e).document||e.ownerDocument||e;return c.browser.safari||f.compatMode=="BackCompat"?f.body:f.documentElement})};c.fn.scrollTo=function(f,e,d){if(typeof e=="object"){d=e;e=0}if(typeof d=="function"){d={onAfter:d}}if(f=="max"){f=9000000000}d=c.extend({},a.defaults,d);e=e||d.speed||d.duration;d.queue=d.queue&&d.axis.length>1;if(d.queue){e/=2}d.offset=b(d.offset);d.over=b(d.over);return this._scrollable().each(function(){var l=this,j=c(l),k=f,i,g={},m=j.is("html,body");switch(typeof k){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(k)){k=b(k);break}k=c(k,this);case"object":if(k.is||k.style){i=(k=c(k)).offset()}}c.each(d.axis.split(""),function(q,r){var s=r=="x"?"Left":"Top",u=s.toLowerCase(),p="scroll"+s,o=l[p],n=a.max(l,r);if(i){g[p]=i[u]+(m?0:o-j.offset()[u]);if(d.margin){g[p]-=parseInt(k.css("margin"+s))||0;g[p]-=parseInt(k.css("border"+s+"Width"))||0}g[p]+=d.offset[u]||0;if(d.over[u]){g[p]+=k[r=="x"?"width":"height"]()*d.over[u]}}else{var t=k[u];g[p]=t.slice&&t.slice(-1)=="%"?parseFloat(t)/100*n:t}if(/^\d+$/.test(g[p])){g[p]=g[p]<=0?0:Math.min(g[p],n)}if(!q&&d.queue){if(o!=g[p]){h(d.onAfterFirst)}delete g[p]}});h(d.onAfter);function h(n){j.animate(g,e,d.easing,n&&function(){n.call(this,f,d)})}}).end()};a.max=function(j,i){var h=i=="x"?"Width":"Height",e="scroll"+h;if(!c(j).is("html,body")){return j[e]-c(j)[h.toLowerCase()]()}var g="client"+h,f=j.ownerDocument.documentElement,d=j.ownerDocument.body;return Math.max(f[e],d[e])-Math.min(f[g],d[g])};function b(d){return typeof d=="object"?d:{top:d,left:d}}})(jQuery);var fluid_1_5=fluid_1_5||{};(function(c,b){b.registerNamespace("fluid.uploader");b.uploader.fileOrFiles=function(d,e){return(e===1)?d.options.strings.progress.singleFile:d.options.strings.progress.pluralFiles};b.uploader.enableElement=function(d,e){e.prop("disabled",false);e.removeClass(d.options.styles.dim)};b.uploader.disableElement=function(d,e){e.prop("disabled",true);e.addClass(d.options.styles.dim)};b.uploader.showElement=function(d,e){e.removeClass(d.options.styles.hidden)};b.uploader.hideElement=function(d,e){e.addClass(d.options.styles.hidden)};b.uploader.maxFilesUploaded=function(e){var d=e.queue.getUploadedFiles().length+e.queue.getReadyFiles().length+e.queue.getErroredFiles().length;return(d===e.options.queueSettings.fileUploadLimit)};b.uploader.setTotalProgressStyle=function(f,e){e=e||false;var d=f.totalProgress.indicator;d.toggleClass(f.options.styles.totalProgress,!e);d.toggleClass(f.options.styles.totalProgressError,e)};b.uploader.setStateEmpty=function(d){b.uploader.disableElement(d,d.locate("uploadButton"));if(d.queue.files.length===0){d.locate("browseButtonText").text(d.options.strings.buttons.browse);d.locate("browseButton").removeClass(d.options.styles.browseButton);b.uploader.showElement(d,d.locate("instructions"))}};b.uploader.enableBrowseButton=function(d){if(!b.uploader.maxFilesUploaded(d)){b.uploader.enableElement(d,d.locate("browseButton"));d.strategy.local.enableBrowseButton()}};b.uploader.setStateDone=function(d){b.uploader.disableElement(d,d.locate("uploadButton"));b.uploader.hideElement(d,d.locate("pauseButton"));b.uploader.showElement(d,d.locate("uploadButton"));b.uploader.enableBrowseButton(d)};b.uploader.setStateLoaded=function(d){d.locate("browseButtonText").text(d.options.strings.buttons.addMore);d.locate("browseButton").addClass(d.options.styles.browseButton);b.uploader.hideElement(d,d.locate("pauseButton"));b.uploader.showElement(d,d.locate("uploadButton"));b.uploader.enableElement(d,d.locate("uploadButton"));b.uploader.hideElement(d,d.locate("instructions"));d.totalProgress.hide();b.uploader.enableBrowseButton(d)};b.uploader.setStateUploading=function(d){d.totalProgress.hide(false,false);b.uploader.setTotalProgressStyle(d);b.uploader.hideElement(d,d.locate("uploadButton"));b.uploader.disableElement(d,d.locate("browseButton"));d.strategy.local.disableBrowseButton();b.uploader.enableElement(d,d.locate("pauseButton"));b.uploader.showElement(d,d.locate("pauseButton"))};b.uploader.setStateFull=function(d){d.locate("browseButtonText").text(d.options.strings.buttons.addMore);d.locate("browseButton").addClass(d.options.styles.browseButton);b.uploader.hideElement(d,d.locate("pauseButton"));b.uploader.showElement(d,d.locate("uploadButton"));b.uploader.enableElement(d,d.locate("uploadButton"));b.uploader.disableElement(d,d.locate("browseButton"));d.strategy.local.disableBrowseButton();b.uploader.hideElement(d,d.locate("instructions"));d.totalProgress.hide()};b.uploader.renderUploadTotalMessage=function(i){var g=i.queue.getReadyFiles().length;var j=i.queue.sizeOfReadyFiles();var e=b.uploader.fileOrFiles(i,g);var d=i.queue.files.length;var f=i.options.strings.progress.noFiles;var h=b.stringTemplate(i.options.strings.progress.toUploadLabel,{fileCount:g,fileLabel:e,totalBytes:b.uploader.formatFileSize(j),uploadedCount:i.queue.getUploadedFiles().length,uploadedSize:b.uploader.formatFileSize(i.queue.sizeOfUploadedFiles()),totalCount:d,totalSize:b.uploader.formatFileSize(i.queue.totalBytes())});if(!d&&f){h=f}i.locate("totalFileStatusText").html(h)};b.uploader.renderFileUploadLimit=function(e){if(e.options.queueSettings.fileUploadLimit>0){var d=b.stringTemplate(e.options.strings.progress.fileUploadLimitLabel,{fileUploadLimit:e.options.queueSettings.fileUploadLimit,fileLabel:b.uploader.fileOrFiles(e,e.options.queueSettings.fileUploadLimit)});e.locate("fileUploadLimitText").html(d)}};b.uploader.formatFileSize=function(d){if(typeof(d)==="number"){if(d===0){return"0.0 KB"}else{if(d>0){if(d<1048576){return(Math.ceil(d/1024*10)/10).toFixed(1)+" KB"}else{return(Math.ceil(d/1048576*10)/10).toFixed(1)+" MB"}}}}return""};b.uploader.derivePercent=function(d,e){return Math.round((d*100)/e)};b.uploader.updateTotalProgress=function(j){var g=j.queue.currentBatch;var d=b.uploader.derivePercent(g.totalBytesUploaded,g.totalBytes);var f=g.files.length;var i=b.uploader.fileOrFiles(j,f);var h=g.totalBytesUploaded+j.queue.sizeOfUploadedFiles();var e=b.stringTemplate(j.options.strings.progress.totalProgressLabel,{curFileN:g.fileIdx,totalFilesN:f,fileLabel:i,currBytes:b.uploader.formatFileSize(g.totalBytesUploaded),totalBytes:b.uploader.formatFileSize(g.totalBytes),uploadedCount:j.queue.getUploadedFiles().length,uploadedSize:b.uploader.formatFileSize(h),totalCount:j.queue.files.length,totalSize:b.uploader.formatFileSize(j.queue.totalBytes())});j.totalProgress.update(d,e)};b.uploader.updateTotalAtCompletion=function(h){var j=h.queue.getErroredFiles().length;var i=h.queue.files.length;var f=b.uploader.fileOrFiles(h,i);var g="";if(j>0){var e=(j===1)?h.options.strings.progress.singleError:h.options.strings.progress.pluralErrors;b.uploader.setTotalProgressStyle(h,true);g=b.stringTemplate(h.options.strings.progress.numberOfErrors,{errorsN:j,errorLabel:e})}var d=b.stringTemplate(h.options.strings.progress.completedLabel,{curFileN:h.queue.getUploadedFiles().length,totalFilesN:i,errorString:g,fileLabel:f,totalCurrBytes:b.uploader.formatFileSize(h.queue.sizeOfUploadedFiles()),uploadedCount:h.queue.getUploadedFiles().length,uploadedSize:b.uploader.formatFileSize(h.queue.sizeOfUploadedFiles()),totalCount:h.queue.files.length,totalSize:b.uploader.formatFileSize(h.queue.totalBytes())});h.totalProgress.update(100,d)};b.uploader.updateStateAfterFileDialog=function(d){var e=d.queue.getReadyFiles().length;if(e>0){b.uploader[e===d.options.queueSettings.fileUploadLimit?"setStateFull":"setStateLoaded"](d);b.uploader.renderUploadTotalMessage(d);d.locate(d.options.focusWithEvent.afterFileDialog).focus()}};b.uploader.updateStateAfterFileRemoval=function(d){b.uploader[d.queue.getReadyFiles().length===0?"setStateEmpty":"setStateLoaded"](d);b.uploader.renderUploadTotalMessage(d)};b.uploader.updateStateAfterCompletion=function(d){b.uploader[d.queue.getReadyFiles().length===0?"setStateDone":"setStateLoaded"](d);b.uploader.updateTotalAtCompletion(d)};b.uploader.uploadNextOrFinish=function(d){if(d.queue.shouldUploadNextFile()){d.strategy.remote.uploadNextFile()}else{d.events.afterUploadComplete.fire(d.queue.currentBatch.files);d.queue.clearCurrentBatch()}};b.uploader.onFileStart=function(e,d){e.filestatus=b.uploader.fileStatusConstants.IN_PROGRESS;d.startFile()};b.uploader.onFileProgress=function(d,e){d.queue.updateBatchStatus(e);b.uploader.updateTotalProgress(d)};b.uploader.onFileComplete=function(d,e){e.queue.finishFile(d);e.events.afterFileComplete.fire(d);b.uploader.uploadNextOrFinish(e)};b.uploader.onFileSuccess=function(d,e){d.filestatus=b.uploader.fileStatusConstants.COMPLETE;
if(e.queue.currentBatch.bytesUploadedForFile===0){e.queue.currentBatch.totalBytesUploaded+=d.size}b.uploader.updateTotalProgress(e)};b.uploader.onFileError=function(e,d,f){if(d===b.uploader.errorConstants.UPLOAD_STOPPED){e.filestatus=b.uploader.fileStatusConstants.CANCELLED}else{e.filestatus=b.uploader.fileStatusConstants.ERROR;if(f.queue.isUploading){f.queue.currentBatch.totalBytesUploaded+=e.size;f.queue.currentBatch.numFilesErrored++;b.uploader.uploadNextOrFinish(f)}}};b.uploader.afterUploadComplete=function(d){d.queue.isUploading=false;b.uploader.updateStateAfterCompletion(d)};b.uploaderImpl=function(){b.fail('Error creating uploader component - please make sure that a progressiveCheckerForComponent for "fluid.uploader" is registered either in the static environment or else is visible in the current component tree')};b.enhance.check({"fluid.browser.supportsBinaryXHR":"fluid.enhance.supportsBinaryXHR","fluid.browser.supportsFormData":"fluid.enhance.supportsFormData"});b.defaults("fluid.uploader",{gradeNames:["fluid.viewComponent","autoInit"],components:{uploaderContext:{type:"fluid.progressiveCheckerForComponent",options:{componentName:"fluid.uploader"}},uploaderImpl:{type:"fluid.uploaderImpl",container:"{uploader}.container"}},returnedPath:"uploaderImpl",distributeOptions:{source:"{that}.options",removeSource:true,exclusions:["components.uploaderContext","components.uploaderImpl"],target:"{that > uploaderImpl}.options"},progressiveCheckerOptions:{checks:[{feature:"{fluid.browser.supportsBinaryXHR}",contextName:"fluid.uploader.html5"}],defaultContextName:"fluid.uploader.singleFile"}});b.uploader.demoTypeTag=function(d){return d?"fluid.uploader.demo":"fluid.uploader.live"};b.uploader.browse=function(d,e){if(!d.isUploading){e.browse()}};b.uploader.removeFile=function(d,e,g,f){d.removeFile(f);e.removeFile(f);g.fire(f)};b.uploader.start=function(e,f,d){e.start();d.fire(e.currentBatch.files);f.uploadNextFile()};b.uploader.stop=function(e,d){d.fire();e.stop()};b.uploader.defaultQueueSettings={uploadURL:"",postParams:{},fileSizeLimit:"20480",fileTypes:null,fileTypesDescription:null,fileUploadLimit:0,fileQueueLimit:0};b.uploader.bindFocus=function(e,d,f,g){b.each(e,function(h,i){if(!d[i]){f[i].addListener(function(){g.locate(h).focus()})}})};b.defaults("fluid.uploader.multiFileUploader",{gradeNames:["fluid.viewComponent","autoInit"],nickName:"uploader",members:{totalFileStatusTextId:{expander:{funcName:"fluid.allocateSimpleId",args:"{that}.dom.totalFileStatusText"}}},invokers:{browse:{funcName:"fluid.uploader.browse",args:["{that}.queue","{that}.strategy.local"]},removeFile:{funcName:"fluid.uploader.removeFile",args:["{that}.queue","{that}.strategy.local","{that}.events.afterFileRemoved","{arguments}.0"]},start:{funcName:"fluid.uploader.start",args:["{that}.queue","{that}.strategy.remote","{that}.events.onUploadStart"]},stop:{funcName:"fluid.uploader.stop",args:["{that}.strategy.remote","{that}.events.onUploadStop"]}},components:{demoTag:{type:"fluid.typeFount",options:{targetTypeName:{expander:{funcName:"fluid.uploader.demoTypeTag",args:"{uploader}.options.demo"}}}},queue:{type:"fluid.uploader.fileQueue"},strategy:{type:"fluid.uploader.strategy"},errorPanel:{type:"fluid.uploader.errorPanel"},fileQueueView:{type:"fluid.uploader.fileQueueView",options:{model:"{uploader}.queue.files",uploaderContainer:"{uploader}.container",strings:{buttons:{remove:"{uploader}.options.strings.buttons.remove"}}}},totalProgress:{type:"fluid.progress",container:"{uploader}.container",options:{selectors:{progressBar:".flc-uploader-queue-footer",displayElement:".flc-uploader-total-progress",label:".flc-uploader-total-progress-text",indicator:".flc-uploader-total-progress",ariaElement:".flc-uploader-total-progress"}}}},queueSettings:b.uploader.defaultQueueSettings,demo:false,selectors:{fileQueue:".flc-uploader-queue",browseButton:".flc-uploader-button-browse",browseButtonText:".flc-uploader-button-browse-text",uploadButton:".flc-uploader-button-upload",pauseButton:".flc-uploader-button-pause",totalFileStatusText:".flc-uploader-total-progress-text",fileUploadLimitText:".flc-uploader-upload-limit-text",instructions:".flc-uploader-browse-instructions",errorsPanel:".flc-uploader-errorsPanel"},noAutoFocus:{afterFileDialog:true},focusWithEvent:{afterFileDialog:"uploadButton",onUploadStart:"pauseButton",onUploadStop:"uploadButton"},styles:{disabled:"fl-uploader-disabled",hidden:"fl-uploader-hidden",dim:"fl-uploader-dim",totalProgress:"fl-uploader-total-progress-okay",totalProgressError:"fl-uploader-total-progress-errored",browseButton:"fl-uploader-browseMore"},events:{afterReady:null,onFileDialog:null,onFilesSelected:null,onFileQueued:null,afterFileQueued:null,onFileRemoved:null,afterFileRemoved:null,afterFileDialog:null,onUploadStart:null,onUploadStop:null,onFileStart:null,onFileProgress:null,onFileError:null,onQueueError:null,onFileSuccess:null,onFileComplete:null,afterFileComplete:null,afterUploadComplete:null},listeners:{onCreate:[{listener:"fluid.uploader.bindFocus",args:["{that}.options.focusWithEvent","{that}.options.noAutoFocus","{that}.events","{that}.dom"]},{"this":"{that}.dom.uploadButton",method:"click",args:"{that}.start"},{"this":"{that}.dom.pauseButton",method:"click",args:"{that}.stop"},{"this":"{that}.dom.totalFileStatusText",method:"attr",args:[{role:"log","aria-live":"assertive","aria-relevant":"text","aria-atomic":"true"}]},{"this":"{that}.dom.fileQueue",method:"attr",args:[{"aria-controls":"{that}.totalFileStatusTextId","aria-labelledby":"{that}.totalFileStatusTextId"}]}],"afterFileDialog.uploader":{listener:"fluid.uploader.updateStateAfterFileDialog",args:"{that}"},"afterFileQueued.uploader":{listener:"{that}.queue.addFile",args:"{arguments}.0"},"onFileRemoved.uploader":{listener:"{that}.removeFile",args:"{arguments}.0"},"afterFileRemoved.uploader":{listener:"fluid.uploader.updateStateAfterFileRemoval",args:"{that}"},"onUploadStart.uploader":{listener:"fluid.uploader.setStateUploading",args:"{that}"},"onFileStart.uploader":{listener:"fluid.uploader.onFileStart",args:["{arguments}.0","{that}.queue"]},"onFileProgress.uploader":{listener:"fluid.uploader.onFileProgress",args:["{that}","{arguments}.1"]},"onFileComplete.uploader":{listener:"fluid.uploader.onFileComplete",args:["{arguments}.0","{that}"]},"onFileSuccess.uploader":{listener:"fluid.uploader.onFileSuccess",args:["{arguments}.0","{that}"]},"onFileError.uploader":{listener:"fluid.uploader.onFileError",args:["{arguments}.0","{arguments}.1","{that}"]},"afterUploadComplete.uploader":{listener:"fluid.uploader.afterUploadComplete",args:"{that}"}},strings:{progress:{fileUploadLimitLabel:"%fileUploadLimit %fileLabel maximum",noFiles:"0 files",toUploadLabel:"%uploadedCount out of %totalCount files uploaded (%uploadedSize of %totalSize)",totalProgressLabel:"%uploadedCount out of %totalCount files uploaded (%uploadedSize of %totalSize)",completedLabel:"%uploadedCount out of %totalCount files uploaded (%uploadedSize of %totalSize)%errorString",numberOfErrors:", %errorsN %errorLabel",singleFile:"file",pluralFiles:"files",singleError:"error",pluralErrors:"errors"},buttons:{browse:"Browse Files",addMore:"Add More",stopUpload:"Stop Upload",cancelRemaning:"Cancel remaining Uploads",resumeUpload:"Resume Upload",remove:"Remove"}}});b.uploader.multiFileUploader.finalInit=function(e){b.uploader.disableElement(e,e.locate("uploadButton"));b.uploader.renderFileUploadLimit(e);var d=e.options.strings.progress.noFiles;if(d){e.locate("totalFileStatusText").text(d)}e.container.attr("role","application")};b.defaults("fluid.uploader.strategy",{gradeNames:["fluid.littleComponent"],components:{local:{type:"fluid.uploader.local"},remote:{type:"fluid.uploader.remote"}}});b.defaults("fluid.uploader.local",{gradeNames:["fluid.eventedComponent"],queueSettings:"{uploader}.options.queueSettings",members:{queue:"{uploader}.queue"},events:{onFileDialog:"{uploader}.events.onFileDialog",onFilesSelected:"{uploader}.events.onFilesSelected",afterFileDialog:"{uploader}.events.afterFileDialog",afterFileQueued:"{uploader}.events.afterFileQueued",onQueueError:"{uploader}.events.onQueueError"},invokers:{enableBrowseButton:"fluid.uploader.local.enableBrowseButton",disableBrowseButton:"fluid.uploader.local.disableBrowseButton"}});b.defaults("fluid.uploader.remote",{gradeNames:["fluid.eventedComponent"],members:{queue:"{uploader}.queue",queueSettings:"{uploader}.options.queueSettings"},events:{onFileStart:"{uploader}.events.onFileStart",onFileProgress:"{uploader}.events.onFileProgress",onFileSuccess:"{uploader}.events.onFileSuccess",onFileError:"{uploader}.events.onFileError",onFileComplete:"{uploader}.events.onFileComplete",onUploadStop:"{uploader}.events.onUploadStop",afterFileComplete:"{uploader}.events.afterFileComplete",afterUploadComplete:"{uploader}.events.afterUploadComplete"},invokers:{uploadNextFile:"fluid.uploader.uploadNextFile",stop:"fluid.uploader.stop"}});b.demands("fluid.uploader.fileQueueView","fluid.uploader.multiFileUploader",{container:"{uploader}.dom.fileQueue",options:{events:{onFileRemoved:"{uploader}.events.onFileRemoved"}}});b.demands("fluid.uploader.fileQueueView.eventBinder",["fluid.uploader.multiFileUploader","fluid.uploader.fileQueueView"],{options:{listeners:{"{uploader}.events.afterFileQueued":"{fileQueueView}.addFile","{uploader}.events.onUploadStart":"{fileQueueView}.prepareForUpload","{uploader}.events.onFileStart":"{fileQueueView}.showFileProgress","{uploader}.events.onFileProgress":"{fileQueueView}.updateFileProgress","{uploader}.events.onFileSuccess":"{fileQueueView}.markFileComplete","{uploader}.events.onFileError":"{fileQueueView}.showErrorForFile","{uploader}.events.afterFileComplete":"{fileQueueView}.hideFileProgress","{uploader}.events.afterUploadComplete":"{fileQueueView}.refreshAfterUpload"}}});b.uploader.queueErrorConstants={QUEUE_LIMIT_EXCEEDED:"queue limit exceeded",FILE_EXCEEDS_SIZE_LIMIT:"file exceeds size limit",ZERO_BYTE_FILE:"zero byte file",INVALID_FILETYPE:"invalid filetype"};
b.uploader.errorConstants={HTTP_ERROR:"HTTP error",MISSING_UPLOAD_URL:"Missing upload URL",IO_ERROR:"I/O error",SECURITY_ERROR:"Security error",UPLOAD_LIMIT_EXCEEDED:"Upload limit exceeded",UPLOAD_FAILED:"Uploader failed",SPECIFIED_FILE_ID_NOT_FOUND:"Specified file ID not found",FILE_VALIDATION_FAILED:"File validation failed",FILE_CANCELLED:"File cancelled",UPLOAD_STOPPED:"Upload stopped"};b.uploader.fileStatusConstants={QUEUED:"queued",IN_PROGRESS:"in progress",ERROR:"error",COMPLETE:"complete",CANCELLED:"cancelled"};var a=function(d,e){if(window.opera){d.show().removeClass("hideUploaderForOpera");e.show().addClass("hideUploaderForOpera")}else{d.show();e.hide()}};b.defaults("fluid.uploader.singleFileUploader",{gradeNames:["fluid.viewComponent","autoInit"],selectors:{basicUpload:".fl-progEnhance-basic"}});b.uploader.singleFileUploader.finalInit=function(d){a(c(d.options.selectors.basicUpload),d.container)};b.demands("fluid.uploaderImpl","fluid.uploader.singleFile",{funcName:"fluid.uploader.singleFileUploader"})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.uploader");a.defaults("fluid.uploader.fileQueue",{gradeNames:["fluid.littleComponent","autoInit"],members:{files:[],isUploading:false},invokers:{start:{funcName:"fluid.uploader.fileQueue.start",args:"{that}"},startFile:{funcName:"fluid.uploader.fileQueue.startFile",args:"{that}.currentBatch",dynamic:true},finishFile:{funcName:"fluid.uploader.fileQueue.finishFile",args:"{that}.currentBatch",dynamic:true},shouldUploadNextFile:{funcName:"fluid.uploader.fileQueue.shouldUploadNextFile",args:"{that}"},addFile:{funcName:"fluid.uploader.fileQueue.addFile",args:["{that}.files","{arguments}.0"]},removeFile:{funcName:"fluid.uploader.fileQueue.removeFile",args:["{that}.files","{arguments}.0"]},totalBytes:{funcName:"fluid.uploader.fileQueue.sizeOfFiles",args:"{that}.files"},getReadyFiles:{funcName:"fluid.uploader.fileQueue.filesByStatus",args:["{that}.files",["QUEUED","CANCELLED"]]},getErroredFiles:{funcName:"fluid.uploader.fileQueue.filesByStatus",args:["{that}.files","ERROR"]},getUploadedFiles:{funcName:"fluid.uploader.fileQueue.filesByStatus",args:["{that}.files","COMPLETE"]},sizeOfReadyFiles:{funcName:"fluid.uploader.fileQueue.sizeOfFilesByStatus",args:["{that}.files",["QUEUED","CANCELLED"]]},sizeOfUploadedFiles:{funcName:"fluid.uploader.fileQueue.sizeOfFilesByStatus",args:["{that}.files","COMPLETE"]},setupCurrentBatch:{funcName:"fluid.uploader.fileQueue.setupCurrentBatch",args:"{that}"},clearCurrentBatch:{funcName:"fluid.uploader.fileQueue.clearCurrentBatch",args:"{that}"},updateCurrentBatch:{funcName:"fluid.uploader.fileQueue.updateCurrentBatch",args:[{expander:{func:"{that}.getReadyFiles"}},"{that}.currentBatch"],dynamic:true},updateBatchStatus:{funcName:"fluid.uploader.fileQueue.updateBatchStatus",args:["{arguments}.0","{that}.currentBatch"],dynamic:true}}});a.uploader.fileQueue.start=function(c){c.setupCurrentBatch();c.isUploading=true;c.shouldStop=false};a.uploader.fileQueue.startFile=function(c){c.fileIdx++;c.bytesUploadedForFile=0;c.previousBytesUploadedForFile=0};a.uploader.fileQueue.finishFile=function(c){c.numFilesCompleted++};a.uploader.fileQueue.shouldUploadNextFile=function(c){return !c.shouldStop&&c.isUploading&&(c.currentBatch.numFilesCompleted+c.currentBatch.numFilesErrored)<c.currentBatch.files.length};a.uploader.fileQueue.addFile=function(d,c){d.push(c)};a.uploader.fileQueue.removeFile=function(d,c){a.remove_if(d,function(e){return c===e})};a.uploader.fileQueue.sizeOfFiles=function(c){return a.accumulate(c,function(d,e){return e+d.size},0)};a.uploader.fileQueue.filterFiles=function(d,e){var c=[];return a.remove_if(a.makeArray(d),e,c)};a.uploader.fileQueue.filesByStatus=function(d,c){c=a.makeArray(c);return a.uploader.fileQueue.filterFiles(d,function(e){return a.find_if(c,function(f){return e.filestatus===a.uploader.fileStatusConstants[f]})})};a.uploader.fileQueue.sizeOfFilesByStatus=function(d,c){d=a.uploader.fileQueue.filesByStatus(d,c);return a.uploader.fileQueue.sizeOfFiles(d)};a.uploader.fileQueue.setupCurrentBatch=function(c){c.clearCurrentBatch();c.updateCurrentBatch()};a.uploader.fileQueue.clearCurrentBatch=function(c){c.currentBatch={fileIdx:0,files:[],totalBytes:0,numFilesCompleted:0,numFilesErrored:0,bytesUploadedForFile:0,previousBytesUploadedForFile:0,totalBytesUploaded:0}};a.uploader.fileQueue.updateCurrentBatch=function(d,c){c.files=d;c.totalBytes=a.uploader.fileQueue.sizeOfFiles(d)};a.uploader.fileQueue.updateBatchStatus=function(e,c){var d=e-c.previousBytesUploadedForFile;c.totalBytesUploaded+=d;c.bytesUploadedForFile+=d;c.previousBytesUploadedForFile=e}})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.uploader.fileQueueView");a.uploader.fileQueueView.rowForFile=function(d,c){return d.locate("fileQueue").find("#"+c.id)};a.uploader.fileQueueView.errorRowForFile=function(d,c){return b("#"+c.id+"_error",d.container)};a.uploader.fileQueueView.fileForRow=function(c,d){return a.find_if(c.model,function(e){return e.id.toString()===d.prop("id")})};a.uploader.fileQueueView.progressorForFile=function(d,c){var e=c.id+"_progress";return d.fileProgressors[e]};a.uploader.fileQueueView.startFileProgress=function(e,c){var d=a.uploader.fileQueueView.rowForFile(e,c);e.scroller.scrollTo(d);var f=a.uploader.fileQueueView.progressorForFile(e,c);f.refreshView();f.show()};a.uploader.fileQueueView.updateFileProgress=function(f,d,e,c){var g=a.uploader.derivePercent(e,c);var h=g+"%";a.uploader.fileQueueView.progressorForFile(f,d).update(g,h)};a.uploader.fileQueueView.hideFileProgress=function(e,c){var d=a.uploader.fileQueueView.rowForFile(e,c);a.uploader.fileQueueView.progressorForFile(e,c).hide();if(c.filestatus===a.uploader.fileStatusConstants.COMPLETE){e.locate("fileIconBtn",d).removeClass(e.options.styles.dim)}};a.uploader.fileQueueView.removeFileProgress=function(e,d){var f=a.uploader.fileQueueView.progressorForFile(e,d);if(!f){return}var c=f.displayElement;c.remove()};a.uploader.fileQueueView.animateRowRemoval=function(c,d){d.fadeOut("fast",function(){d.remove();c.refreshView()})};a.uploader.fileQueueView.removeFileErrorRow=function(d,c){if(c.filestatus===a.uploader.fileStatusConstants.ERROR){a.uploader.fileQueueView.animateRowRemoval(d,a.uploader.fileQueueView.errorRowForFile(d,c))}};a.uploader.fileQueueView.removeFileAndRow=function(d,c,e){a.uploader.fileQueueView.removeFileProgress(d,c);a.uploader.fileQueueView.removeFileErrorRow(d,c);d.events.onFileRemoved.fire(c);a.uploader.fileQueueView.animateRowRemoval(d,e)};a.uploader.fileQueueView.removeFileForRow=function(d,e){var c=a.uploader.fileQueueView.fileForRow(d,e);if(!c||c.filestatus===a.uploader.fileStatusConstants.COMPLETE){return}a.uploader.fileQueueView.removeFileAndRow(d,c,e)};a.uploader.fileQueueView.removeRowForFile=function(d,c){var e=a.uploader.fileQueueView.rowForFile(d,c);a.uploader.fileQueueView.removeFileAndRow(d,c,e)};a.uploader.fileQueueView.bindHover=function(f,d){var e=function(){if(f.hasClass(d.ready)&&!f.hasClass(d.uploading)){f.addClass(d.hover)}};var c=function(){if(f.hasClass(d.ready)&&!f.hasClass(d.uploading)){f.removeClass(d.hover)}};f.hover(e,c)};a.uploader.fileQueueView.bindDeleteKey=function(c,e){var d=function(){a.uploader.fileQueueView.removeFileForRow(c,e)};a.activatable(e,null,{additionalBindings:[{key:b.ui.keyCode.DELETE,activateHandler:d}]})};a.uploader.fileQueueView.bindRowHandlers=function(c,d){if(b.browser.msie&&b.browser.version<7){a.uploader.fileQueueView.bindHover(d,c.options.styles)}c.locate("fileIconBtn",d).click(function(){a.uploader.fileQueueView.removeFileForRow(c,d)});a.uploader.fileQueueView.bindDeleteKey(c,d)};a.uploader.fileQueueView.renderRowFromTemplate=function(e,d){var f=e.rowTemplate.clone(),h=d.name,c=a.uploader.formatFileSize(d.size);f.removeClass(e.options.styles.hiddenTemplate);e.locate("fileName",f).text(h);e.locate("fileSize",f).text(c);var g=e.locate("fileIconBtn",f);g.addClass(e.options.styles.remove);a.updateAriaLabel(g,e.options.strings.buttons.remove);f.prop("id",d.id);f.addClass(e.options.styles.ready);a.uploader.fileQueueView.bindRowHandlers(e,f);a.updateAriaLabel(f,h+" "+c+" "+e.options.strings.status.remove);return f};a.uploader.fileQueueView.createProgressorFromTemplate=function(d,g){var c=d.rowProgressorTemplate.clone();var e=g.prop("id");var f=e+"_progress";c.prop("id",f);c.css("top",g.position().top);c.height(g.height()).width(5);d.container.after(c);d.fileProgressors[f]=a.progress(d.options.uploaderContainer,{selectors:{progressBar:"#"+e,displayElement:"#"+f,label:"#"+f+" .fl-uploader-file-progress-text",indicator:"#"+f}})};a.uploader.fileQueueView.addFile=function(d,c){var e=a.uploader.fileQueueView.renderRowFromTemplate(d,c);if(!(b.browser.msie&&(b.browser.version>=8))){e.hide()}d.container.append(e);e.attr("title",d.options.strings.status.remove);e.fadeIn("slow");a.uploader.fileQueueView.createProgressorFromTemplate(d,e);d.refreshView();d.scroller.scrollTo("100%")};a.uploader.fileQueueView.enableRows=function(e,d){for(var c=0;c<e.length;c++){a.enabled(e[c],d)}};a.uploader.fileQueueView.prepareForUpload=function(c){var d=c.locate("fileIconBtn",c.locate("fileRows"));d.prop("disabled",true);d.addClass(c.options.styles.dim);a.uploader.fileQueueView.enableRows(c.locate("fileRows"),false)};a.uploader.fileQueueView.refreshAfterUpload=function(c){var d=c.locate("fileIconBtn",c.locate("fileRows"));d.prop("disabled",false);d.removeClass(c.options.styles.dim);a.uploader.fileQueueView.enableRows(c.locate("fileRows"),true)};a.uploader.fileQueueView.changeRowState=function(c,e,d){e.removeClass(c.options.styles.ready).removeClass(c.options.styles.error).addClass(d)};a.uploader.fileQueueView.markRowAsComplete=function(e,d){var f=a.uploader.fileQueueView.rowForFile(e,d);a.uploader.fileQueueView.changeRowState(e,f,e.options.styles.uploaded);f.attr("title",e.options.strings.status.success);a.enabled(f,false);var c=e.locate("fileIconBtn",f);c.unbind("click");c.removeClass(e.options.styles.remove);
c.attr("title",e.options.strings.status.success)};a.uploader.fileQueueView.renderErrorInfoFromTemplate=function(f,h,c){var e=f.errorInfoTemplate.clone();e.prop("id",h.prop("id")+"_error");var g=a.keyForValue(a.uploader.errorConstants,c);var d=f.options.strings.errors[g];f.locate("errorText",e).text(d);f.locate("fileName",h).after(e);f.scroller.scrollTo(e)};a.uploader.fileQueueView.showErrorForFile=function(f,d,c){a.uploader.fileQueueView.hideFileProgress(f,d);if(d.filestatus===a.uploader.fileStatusConstants.ERROR){var e=a.uploader.fileQueueView.rowForFile(f,d);a.uploader.fileQueueView.changeRowState(f,e,f.options.styles.error);a.uploader.fileQueueView.renderErrorInfoFromTemplate(f,e,c)}};a.uploader.fileQueueView.addKeyboardNavigation=function(c){a.tabbable(c.container);c.selectableContext=a.selectable(c.container,{selectableSelector:c.options.selectors.fileRows,onSelect:function(d){b(d).addClass(c.options.styles.selected)},onUnselect:function(d){b(d).removeClass(c.options.styles.selected)}})};a.uploader.fileQueueView.prepareTemplateElements=function(c){c.errorInfoTemplate=c.locate("errorInfoTemplate").remove();c.errorInfoTemplate.removeClass(c.options.styles.hiddenTemplate);c.rowTemplate=c.locate("rowTemplate").remove();c.rowProgressorTemplate=c.locate("rowProgressorTemplate",c.options.uploaderContainer).remove()};a.uploader.fileQueueView.markFileComplete=function(d,c){a.uploader.fileQueueView.progressorForFile(d,c).update(100,"100%");a.uploader.fileQueueView.markRowAsComplete(d,c)};a.uploader.fileQueueView.refreshView=function(c){c.selectableContext.refresh();c.scroller.refreshView()};a.defaults("fluid.uploader.fileQueueView",{gradeNames:["fluid.viewComponent","autoInit"],members:{fileProgressors:{}},invokers:{addFile:{funcName:"fluid.uploader.fileQueueView.addFile",args:["{that}","{arguments}.0"]},removeFile:{funcName:"fluid.uploader.fileQueueView.removeRowForFile",args:["{that}","{arguments}.0"]},prepareForUpload:{funcName:"fluid.uploader.fileQueueView.prepareForUpload",args:"{that}"},refreshAfterUpload:{funcName:"fluid.uploader.fileQueueView.refreshAfterUpload",args:"{that}"},showFileProgress:{funcName:"fluid.uploader.fileQueueView.startFileProgress",args:["{that}","{arguments}.0"]},updateFileProgress:{funcName:"fluid.uploader.fileQueueView.updateFileProgress",args:["{that}","{arguments}.0","{arguments}.1","{arguments}.2"]},markFileComplete:{funcName:"fluid.uploader.fileQueueView.markFileComplete",args:["{that}","{arguments}.0"]},showErrorForFile:{funcName:"fluid.uploader.fileQueueView.showErrorForFile",args:["{that}","{arguments}.0","{arguments}.1"]},hideFileProgress:{funcName:"fluid.uploader.fileQueueView.hideFileProgress",args:["{that}","{arguments}.0"]},refreshView:{funcName:"fluid.uploader.fileQueueView.refreshView",args:"{that}"}},components:{scroller:{type:"fluid.scrollableTable"},eventBinder:{type:"fluid.uploader.fileQueueView.eventBinder"}},selectors:{fileRows:".flc-uploader-file",fileName:".flc-uploader-file-name",fileSize:".flc-uploader-file-size",fileIconBtn:".flc-uploader-file-action",errorText:".flc-uploader-file-error",rowTemplate:".flc-uploader-file-tmplt",errorInfoTemplate:".flc-uploader-file-error-tmplt",rowProgressorTemplate:".flc-uploader-file-progressor-tmplt"},styles:{hover:"fl-uploader-file-hover",selected:"fl-uploader-file-focus",ready:"fl-uploader-file-state-ready",uploading:"fl-uploader-file-state-uploading",uploaded:"fl-uploader-file-state-uploaded",error:"fl-uploader-file-state-error",remove:"fl-uploader-file-action-remove",dim:"fl-uploader-dim",hiddenTemplate:"fl-uploader-hidden-templates"},strings:{progress:{toUploadLabel:"To upload: %fileCount %fileLabel (%totalBytes)",singleFile:"file",pluralFiles:"files"},status:{success:"File Uploaded",error:"File Upload Error",remove:"Press Delete key to remove file"},errors:{HTTP_ERROR:"File upload error: a network error occured or the file was rejected (reason unknown).",IO_ERROR:"File upload error: a network error occured.",UPLOAD_LIMIT_EXCEEDED:"File upload error: you have uploaded as many files as you are allowed during this session",UPLOAD_FAILED:"File upload error: the upload failed for an unknown reason.",QUEUE_LIMIT_EXCEEDED:"You have as many files in the queue as can be added at one time. Removing files from the queue may allow you to add different files.",FILE_EXCEEDS_SIZE_LIMIT:"One or more of the files that you attempted to add to the queue exceeded the limit of %fileSizeLimit.",ZERO_BYTE_FILE:"One or more of the files that you attempted to add contained no data.",INVALID_FILETYPE:"One or more files were not added to the queue because they were of the wrong type."},buttons:{remove:"Remove"}},events:{onFileRemoved:null},listeners:{onCreate:[{listener:"fluid.uploader.fileQueueView.prepareTemplateElements",args:"{that}"},{listener:"fluid.uploader.fileQueueView.addKeyboardNavigation",args:"{that}"}]}});a.defaults("fluid.uploader.fileQueueView.eventBinder",{gradeNames:["fluid.eventedComponent","autoInit"]});a.registerNamespace("fluid.scrollable");a.scrollable.makeSimple=function(c){return a.container(c)};a.scrollable.makeTable=function(d,c){d.wrap(c.wrapperMarkup);return d.closest(".fl-scrollable-scroller")};a.defaults("fluid.scrollable",{gradeNames:["fluid.viewComponent","autoInit"],makeScrollableFn:a.scrollable.makeSimple,members:{scrollable:{expander:{func:"{that}.options.makeScrollableFn",args:["{that}.container","{that}.options"]}},maxHeight:{expander:{"this":"{that}.scrollable",method:"css",args:"max-height"}}},invokers:{scrollTo:{"this":"{that}.scrollable",method:"scrollTo",args:"{arguments}.0"},refreshView:{funcName:"fluid.scrollable.refreshView",args:"{that}"}},listeners:{onCreate:"{that}.refreshView"}});a.scrollable.refreshView=function(c){if(b.browser.msie&&b.browser.version==="6.0"){c.scrollable.css("height","");if(c.scrollable.height()>=parseInt(c.maxHeight,10)){c.scrollable.css("height",c.maxHeight)}}};a.defaults("fluid.scrollableTable",{gradeNames:["fluid.scrollable","autoInit"],makeScrollableFn:a.scrollable.makeTable,wrapperMarkup:"<div class='fl-scrollable-scroller'><div class='fl-scrollable-inner'></div></div>"});a.demands("fluid.scrollableTable","fluid.uploader.fileQueueView",{container:"{fileQueueView}.container"})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.uploader=a.uploader||{};a.defaults("fluid.uploader.errorPanel",{gradeNames:["fluid.viewComponent","autoInit"],preInitFunction:"fluid.uploader.errorPanel.preInit",postInitFunction:"fluid.uploader.errorPanel.renderSectionTemplates",finalInitFunction:"fluid.uploader.errorPanel.finalInit",components:{fileSizeErrorSection:{type:"fluid.uploader.errorPanel.section",container:"{errorPanel}.dom.fileSizeErrorSection",options:{model:{errorCode:a.uploader.queueErrorConstants.FILE_EXCEEDS_SIZE_LIMIT},strings:{header:"{errorPanel}.options.strings.exceedsFileSize"}}},numFilesErrorSection:{type:"fluid.uploader.errorPanel.section",container:"{errorPanel}.dom.numFilesErrorSection",options:{model:{errorCode:a.uploader.queueErrorConstants.QUEUE_LIMIT_EXCEEDED},strings:{header:"{errorPanel}.options.strings.exceedsNumFilesLimit"}}}},selectors:{header:".flc-uploader-errorPanel-header",sectionTemplate:".flc-uploader-errorPanel-section-tmplt",fileSizeErrorSection:".flc-uploader-errorPanel-section-fileSize",numFilesErrorSection:".flc-uploader-errorPanel-section-numFiles"},strings:{headerText:"Warning(s)",exceedsNumFilesLimit:"Too many files were selected. %numFiles were not added to the queue.",exceedsFileSize:"%numFiles files were too large and were not added to the queue."},styles:{hiddenTemplate:"fl-hidden-templates"}});a.uploader.errorPanel.preInit=function(c){c.refreshView=function(){for(var d=0;d<c.sections.length;d++){if(c.sections[d].model.files.length>0){c.container.show();return}}c.container.hide()}};a.uploader.errorPanel.renderSectionTemplates=function(d){var c=d.locate("sectionTemplate").remove().removeClass(d.options.styles.hiddenTemplate);d.locate("fileSizeErrorSection").append(c.clone());d.locate("numFilesErrorSection").append(c.clone())};a.uploader.errorPanel.finalInit=function(c){c.sections=[c.fileSizeErrorSection,c.numFilesErrorSection];c.locate("header").text(c.options.strings.headerText);c.container.hide()};a.demands("fluid.uploader.errorPanel","fluid.uploader.multiFileUploader",{container:"{multiFileUploader}.dom.errorsPanel",options:{listeners:{"{multiFileUploader}.events.afterFileDialog":"{errorPanel}.refreshView"}}});a.defaults("fluid.uploader.errorPanel.section",{gradeNames:["fluid.viewComponent","autoInit"],preInitFunction:"fluid.uploader.errorPanel.section.preInit",finalInitFunction:"fluid.uploader.errorPanel.section.finalInit",model:{errorCode:undefined,files:[],showingDetails:false},events:{afterErrorsCleared:null},selectors:{errorTitle:".fl-uploader-errorPanel-section-title",deleteErrorButton:".flc-uploader-errorPanel-section-removeButton",errorDetails:".flc-uploader-errorPanel-section-details",erroredFiles:".flc-uploader-errorPanel-section-files",showHideFilesToggle:".flc-uploader-errorPanel-section-toggleDetails"},strings:{hideFiles:"Hide files",showFiles:"Show files",fileListDelimiter:", "}});a.uploader.errorPanel.section.preInit=function(c){c.toggleDetails=function(){var d=c.model.showingDetails?c.hideDetails:c.showDetails;d()};c.showDetails=function(){c.locate("errorDetails").show();c.locate("showHideFilesToggle").text(c.options.strings.hideFiles);c.model.showingDetails=true};c.hideDetails=function(){c.locate("errorDetails").hide();c.locate("showHideFilesToggle").text(c.options.strings.showFiles);c.model.showingDetails=false};c.addFile=function(d,e){if(e===c.model.errorCode){c.model.files.push(d.name);c.refreshView()}};c.clear=function(){c.model.files=[];c.refreshView();c.events.afterErrorsCleared.fire()};c.refreshView=function(){a.uploader.errorPanel.section.renderHeader(c);a.uploader.errorPanel.section.renderErrorDetails(c);c.hideDetails();if(c.model.files.length<=0){c.container.hide()}else{c.container.show()}}};a.uploader.errorPanel.section.finalInit=function(c){c.locate("deleteErrorButton").click(c.clear);
c.locate("showHideFilesToggle").click(c.toggleDetails);c.refreshView()};a.uploader.errorPanel.section.renderHeader=function(d){var c=a.stringTemplate(d.options.strings.header,{numFiles:d.model.files.length});d.locate("errorTitle").text(c)};a.uploader.errorPanel.section.renderErrorDetails=function(d){var c=d.model.files;var e=c.length>0?c.join(d.options.strings.fileListDelimiter):"";d.locate("erroredFiles").text(e)};a.demands("fluid.uploader.errorPanel.section",["fluid.uploader.errorPanel","fluid.uploader.multiFileUploader"],{options:{listeners:{"{multiFileUploader}.events.onQueueError":"{section}.addFile","{multiFileUploader}.events.onFilesSelected":"{section}.clear","{multiFileUploader}.events.onUploadStart":"{section}.clear","{section}.events.afterErrorsCleared":"{errorPanel}.refreshView"}}})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.demands("fluid.uploaderImpl","fluid.uploader.html5",{horizon:"fluid.uploader.progressiveCheck",funcName:"fluid.uploader.multiFileUploader"});a.demands("fluid.uploader.strategy","fluid.uploader.html5",{horizon:"fluid.uploader.progressiveCheck",funcName:"fluid.uploader.html5Strategy"});a.defaults("fluid.uploader.html5Strategy",{gradeNames:["fluid.uploader.strategy","autoInit"],components:{local:{type:"fluid.uploader.html5Strategy.local"}}});a.uploader.html5Strategy.fileSuccessHandler=function(d,c,e){c.onFileSuccess.fire(d,e.responseText,e);c.onFileComplete.fire(d)};a.uploader.html5Strategy.fileErrorHandler=function(d,c,e){c.onFileError.fire(d,a.uploader.errorConstants.UPLOAD_FAILED,e.status,e);c.onFileComplete.fire(d)};a.uploader.html5Strategy.fileStopHandler=function(d,c,e){c.onFileError.fire(d,a.uploader.errorConstants.UPLOAD_STOPPED,e.status,e);c.onFileComplete.fire(d)};a.uploader.html5Strategy.monitorFileUploadXHR=function(d,c,e){e.onreadystatechange=function(){if(e.readyState===4){var f=e.status;if(f>=200&&f<=204){a.uploader.html5Strategy.fileSuccessHandler(d,c,e)}else{if(f===0){a.uploader.html5Strategy.fileStopHandler(d,c,e)}else{a.uploader.html5Strategy.fileErrorHandler(d,c,e)}}}};e.upload.onprogress=function(f){c.onFileProgress.fire(d,f.loaded,f.total)}};a.uploader.html5Strategy.uploadNextFile=function(c,f){var d=c.currentBatch;var e=d.files[d.fileIdx];f(e)};a.uploader.html5Strategy.uploadFile=function(d,c){d.events.onFileStart.fire(c);d.currentXHR=d.createXHR();a.uploader.html5Strategy.monitorFileUploadXHR(c,d.events,d.currentXHR);d.fileSender.send(c,d.queueSettings,d.currentXHR)};a.uploader.html5Strategy.stop=function(c){c.queue.isUploading=false;c.currentXHR.abort();c.events.onUploadStop.fire()};a.defaults("fluid.uploader.html5Strategy.remote",{gradeNames:["fluid.uploader.remote","autoInit"],components:{fileSender:{type:"fluid.uploader.html5Strategy.fileSender"}},invokers:{createXHR:"fluid.uploader.html5Strategy.createXHR",uploadNextFile:{funcName:"fluid.uploader.html5Strategy.uploadNextFile",args:["{that}.queue","{that}.uploadFile"]},uploadFile:{funcName:"fluid.uploader.html5Strategy.uploadFile",args:["{that}","{arguments}.0"]},stop:{funcName:"fluid.uploader.html5Strategy.stop",args:["{that}"]}}});a.demands("fluid.uploader.remote",["fluid.uploader.html5Strategy","fluid.uploader.live"],{funcName:"fluid.uploader.html5Strategy.remote"});a.uploader.html5Strategy.createXHR=function(){return new XMLHttpRequest()};a.uploader.html5Strategy.createFormData=function(){return new FormData()};a.uploader.html5Strategy.setPostParams=function(c,d){b.each(d,function(e,f){c.append(e,f)})};a.uploader.html5Strategy.fileSender=function(){a.fail("Error instantiating HTML5 Uploader - browser does not support FormData feature. Please try version 1.4 or earlier of Uploader which has Firefox 3.x support")};a.defaults("fluid.uploader.html5Strategy.formDataSender",{gradeNames:["fluid.littleComponent","autoInit"],invokers:{createFormData:"fluid.uploader.html5Strategy.createFormData",send:{funcName:"fluid.uploader.html5Strategy.sendFormData",args:["{that}.createFormData","{arguments}.0","{arguments}.1","{arguments}.2"]}}});a.uploader.html5Strategy.sendFormData=function(e,c,d,g){var f=e();f.append("file",c);a.uploader.html5Strategy.setPostParams(f,d.postParams);g.open("POST",d.uploadURL,true);g.send(f);return f};a.demands("fluid.uploader.html5Strategy.fileSender",["fluid.uploader.html5Strategy.remote","fluid.browser.supportsFormData"],{funcName:"fluid.uploader.html5Strategy.formDataSender"});a.defaults("fluid.uploader.html5Strategy.local",{gradeNames:["fluid.uploader.local","autoInit"],invokers:{addFiles:{funcName:"fluid.uploader.html5Strategy.local.addFiles",args:["{that}","{arguments}.0"]},removeFile:"fluid.identity",enableBrowseButton:"{that}.browseButtonView.enable",disableBrowseButton:"{that}.browseButtonView.disable"},components:{browseButtonView:{type:"fluid.uploader.html5Strategy.browseButtonView",options:{strings:"{uploader}.options.strings.buttons",queueSettings:"{uploader}.options.queueSettings",selectors:{browseButton:"{uploader}.options.selectors.browseButton"},listeners:{onFilesQueued:"{local}.addFiles"}}}}});a.uploader.html5Strategy.local.addFiles=function(k,d){var e=k.options.queueSettings;var h=e.fileSizeLimit*1024;var n=e.fileUploadLimit;var f=k.queue.getUploadedFiles().length;var c=k.queue.getReadyFiles().length;var l=n-f-c;k.events.onFilesSelected.fire(d.length);var m=0;for(var j=0;j<d.length;j++){var g=d[j];if(n&&l===0){k.events.onQueueError.fire(g,a.uploader.queueErrorConstants.QUEUE_LIMIT_EXCEEDED)}else{if(g.size>=h){g.filestatus=a.uploader.fileStatusConstants.ERROR;k.events.onQueueError.fire(g,a.uploader.queueErrorConstants.FILE_EXCEEDS_SIZE_LIMIT)}else{if(!n||l>0){g.id="file-"+a.allocateGuid();g.filestatus=a.uploader.fileStatusConstants.QUEUED;k.events.afterFileQueued.fire(g);l--;m++}}}}k.events.afterFileDialog.fire(m)};a.uploader.bindEventsToFileInput=function(d,c){c.click(function(){d.events.onBrowse.fire()});c.change(function(){var e=c[0].files;d.renderFreshMultiFileInput();d.events.onFilesQueued.fire(e)});c.focus(function(){d.browseButton.addClass("focus");d.events.onFocusFileInput.fire(d,c,true)});c.blur(function(){d.browseButton.removeClass("focus");d.events.onFocusFileInput.fire(d,c,false)})};a.uploader.renderMultiFileInput=function(c){var e=b(c.options.multiFileInputMarkup);var d=c.options.queueSettings.fileTypes;if(a.isArrayable(d)){d=d.join();e.attr("accept",d)}return e};a.uploader.renderFreshMultiFileInput=function(d){var e=d.locate("fileInputs").last();e.hide();e.prop("tabindex",-1);var c=a.uploader.renderMultiFileInput(d);c.attr("aria-label",d.options.strings.addMore);e.after(c);a.uploader.bindEventsToFileInput(d,c)};a.uploader.setupBrowseButtonView=function(c){var d=a.uploader.renderMultiFileInput(c);d.attr("aria-label",c.options.strings.browse);c.browseButton.append(d);a.uploader.bindEventsToFileInput(c,d);c.browseButton.prop("tabindex",-1)};a.uploader.isEnabled=function(c){return !c.prop("disabled")};a.defaults("fluid.uploader.html5Strategy.browseButtonView",{gradeNames:["fluid.viewComponent","autoInit"],strings:{browse:"Browse files",addMore:"Add more"},multiFileInputMarkup:"<input type='file' multiple='' class='flc-uploader-html5-input' />",queueSettings:{},members:{browseButton:"{that}.dom.browseButton"},invokers:{enable:{"this":"{that}.dom.fileInputs",method:"prop",args:["disabled",false]},disable:{"this":"{that}.dom.fileInputs",method:"prop",args:["disabled",true]},isEnabled:{funcName:"fluid.uploader.isEnabled",args:"{that}.dom.fileInputs"},renderFreshMultiFileInput:{funcName:"fluid.uploader.renderFreshMultiFileInput",args:"{that}"}},selectors:{browseButton:".flc-uploader-button-browse",fileInputs:".flc-uploader-html5-input"},events:{onFocusFileInput:null,onBrowse:null,onFilesQueued:null},listeners:{onCreate:{funcName:"fluid.uploader.setupBrowseButtonView",args:"{that}"}}});a.demands("fluid.uploader.html5Strategy.browseButtonView","fluid.uploader.html5Strategy.local",{container:"{multiFileUploader}.container",mergeOptions:{events:{onBrowse:"{local}.events.onFileDialog"}}})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(b,a){a.registerNamespace("fluid.uploader.demo");a.uploader.demo.uploadNextFile=function(c){c.demoState.currentFile=c.queue.files[c.demoState.fileIdx];c.demoState.chunksForCurrentFile=Math.ceil(c.demoState.currentFile/c.demoState.chunkSize);c.demoState.bytesUploaded=0;c.queue.isUploading=true;c.events.onFileStart.fire(c.demoState.currentFile);a.uploader.demo.simulateUpload(c)};a.uploader.demo.updateProgress=function(f,e,g,c){if(!c){return}var d=Math.min(g.chunkSize,f.size);g.bytesUploaded=Math.min(g.bytesUploaded+d,f.size);e.onFileProgress.fire(f,g.bytesUploaded,f.size)};a.uploader.demo.finishAndContinueOrCleanup=function(d,c){d.queue.finishFile(c);d.events.afterFileComplete.fire(c);if(d.queue.shouldUploadNextFile()){a.uploader.demo.uploadNextFile(d)}else{d.events.afterUploadComplete.fire(d.queue.currentBatch.files);if(c.status!==a.uploader.fileStatusConstants.CANCELLED){d.queue.clearCurrentBatch()}}};a.uploader.demo.finishUploading=function(d){if(!d.queue.isUploading){return}var c=d.demoState.currentFile;d.events.onFileSuccess.fire(c);d.demoState.fileIdx++;a.uploader.demo.finishAndContinueOrCleanup(d,c)};a.uploader.demo.simulateUpload=function(d){if(!d.queue.isUploading){return}var c=d.demoState.currentFile;if(d.demoState.bytesUploaded<c.size){a.invokeAfterRandomDelay(function(){a.uploader.demo.updateProgress(c,d.events,d.demoState,d.queue.isUploading);a.uploader.demo.simulateUpload(d)})}else{a.uploader.demo.finishUploading(d)}};a.uploader.demo.stop=function(d){var c=d.demoState.currentFile;c.filestatus=a.uploader.fileStatusConstants.CANCELLED;d.queue.shouldStop=true;d.events.onFileError.fire(c,a.uploader.errorConstants.UPLOAD_STOPPED,"The demo upload was paused by the user.");a.uploader.demo.finishAndContinueOrCleanup(d,c);d.events.onUploadStop.fire()};a.demands("fluid.uploader.uploadNextFile","fluid.uploader.demo.remote",{funcName:"fluid.uploader.demo.uploadNextFile",args:"{that}"});a.demands("fluid.uploader.stop","fluid.uploader.demo.remote",{funcName:"fluid.uploader.demo.stop",args:"{that}"});
a.invokeAfterRandomDelay=function(d){var c=Math.floor(Math.random()*200+100);setTimeout(d,c)};a.defaults("fluid.uploader.demo.remote",{gradeNames:["fluid.uploader.remote","autoInit"],members:{demoState:{fileIdx:0,chunkSize:200000}}});a.demands("fluid.uploader.remote",["fluid.uploader.multiFileUploader","fluid.uploader.demo"],{funcName:"fluid.uploader.demo.remote"})})(jQuery,fluid_1_5);var fluid_1_5=fluid_1_5||{};(function(a){a.registerNamespace("fluid.uploader");a.uploader.mimeTypeRegistry={jpg:"image/jpeg",jpeg:"image/jpeg",bmp:"image/bmp",png:"image/png",tif:"image/tiff",tiff:"image/tiff",mp3:"audio/mpeg",m4a:"audio/mp4a-latm",ogg:"audio/ogg",wav:"audio/x-wav",aiff:"audio/x-aiff",mpg:"video/mpeg",mpeg:"video/mpeg",m4v:"video/x-m4v",ogv:"video/ogg",mov:"video/quicktime",avi:"video/x-msvideo",html:"text/html",htm:"text/html",text:"text/plain",doc:"application/msword",docx:"application/msword",xls:"application/vnd.ms-excel",xlsx:"application/vnd.ms-excel",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.ms-powerpoint"}})(fluid_1_5);